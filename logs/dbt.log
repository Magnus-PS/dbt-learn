2021-06-24 17:28:55.467969 (MainThread): Running with dbt=0.19.1
2021-06-24 17:28:55.736713 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-06-24 17:28:55.750647 (MainThread): Tracking: tracking
2021-06-24 17:28:55.750911 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654effc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6655031ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66550458b0>]}
2021-06-24 17:28:55.751372 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-06-24 17:28:55.751610 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-06-24 17:28:55.751845 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-06-24 17:28:55.756971 (Thread-1): Parsing macros/adapters.sql
2021-06-24 17:28:55.777053 (Thread-1): Parsing macros/etc.sql
2021-06-24 17:28:55.779157 (Thread-1): Parsing macros/catalog.sql
2021-06-24 17:28:55.785082 (Thread-1): Parsing macros/materializations/copy.sql
2021-06-24 17:28:55.789441 (Thread-1): Parsing macros/materializations/table.sql
2021-06-24 17:28:55.799037 (Thread-1): Parsing macros/materializations/incremental.sql
2021-06-24 17:28:55.811417 (Thread-1): Parsing macros/materializations/seed.sql
2021-06-24 17:28:55.814292 (Thread-1): Parsing macros/materializations/snapshot.sql
2021-06-24 17:28:55.816108 (Thread-1): Parsing macros/materializations/view.sql
2021-06-24 17:28:55.819598 (Thread-1): Parsing macros/core.sql
2021-06-24 17:28:55.823407 (Thread-1): Parsing macros/materializations/helpers.sql
2021-06-24 17:28:55.832533 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-06-24 17:28:55.846520 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-24 17:28:55.848370 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-06-24 17:28:55.866575 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-24 17:28:55.897807 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-24 17:28:55.902973 (Thread-1): Parsing macros/materializations/view/view.sql
2021-06-24 17:28:55.909659 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-06-24 17:28:55.931312 (Thread-1): Parsing macros/materializations/table/table.sql
2021-06-24 17:28:55.938033 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-06-24 17:28:55.940136 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-06-24 17:28:55.946321 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-06-24 17:28:55.947988 (Thread-1): Parsing macros/etc/query.sql
2021-06-24 17:28:55.949337 (Thread-1): Parsing macros/etc/datetime.sql
2021-06-24 17:28:55.958538 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-06-24 17:28:55.959551 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-06-24 17:28:55.961228 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-06-24 17:28:55.963464 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-06-24 17:28:55.965033 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-06-24 17:28:55.967743 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-06-24 17:28:55.969726 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-06-24 17:28:55.971520 (Thread-1): Parsing macros/adapters/common.sql
2021-06-24 17:28:56.050115 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.test".
2021-06-24 17:28:56.160214 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665317a130>]}
2021-06-24 17:28:56.226089 (Thread-2): handling status request
2021-06-24 17:28:56.226373 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653184b20>]}
2021-06-24 17:28:56.227266 (Thread-2): sending response (<Response 9610 bytes [200 OK]>) to 10.0.3.5
2021-06-24 17:28:56.255202 (Thread-3): handling status request
2021-06-24 17:28:56.255480 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653184a00>]}
2021-06-24 17:28:56.256207 (Thread-3): sending response (<Response 9610 bytes [200 OK]>) to 10.0.40.72
2021-06-24 17:28:56.258139 (Thread-4): handling status request
2021-06-24 17:28:56.258332 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653184dc0>]}
2021-06-24 17:28:56.258960 (Thread-4): sending response (<Response 9610 bytes [200 OK]>) to 10.0.26.142
2021-06-24 17:29:44.133872 (MainThread): Connection 'model.jaffle_shop.test' was properly closed.
2021-06-24 17:29:44.172058 (Thread-5): Got an acceptable cached parse result
2021-06-24 17:29:44.290762 (Thread-5): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665329bbb0>]}
2021-06-24 17:29:44.503142 (Thread-6): handling status request
2021-06-24 17:29:44.503422 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665329bac0>]}
2021-06-24 17:29:44.503917 (Thread-6): sending response (<Response 883 bytes [200 OK]>) to 10.0.24.126
2021-06-24 17:29:44.533312 (Thread-7): handling status request
2021-06-24 17:29:44.533570 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665329bc40>]}
2021-06-24 17:29:44.534078 (Thread-7): sending response (<Response 883 bytes [200 OK]>) to 10.0.40.2
2021-06-24 17:29:44.594027 (Thread-8): handling status request
2021-06-24 17:29:44.594316 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66532aaca0>]}
2021-06-24 17:29:44.594803 (Thread-8): sending response (<Response 883 bytes [200 OK]>) to 10.0.36.19
2021-06-24 17:29:58.191765 (Thread-9): project hash mismatch: values missing, cache invalidated: {'my_new_project'}
2021-06-24 17:29:58.195426 (Thread-9): Parsing macros/adapters.sql
2021-06-24 17:29:58.214922 (Thread-9): Parsing macros/etc.sql
2021-06-24 17:29:58.216986 (Thread-9): Parsing macros/catalog.sql
2021-06-24 17:29:58.222996 (Thread-9): Parsing macros/materializations/copy.sql
2021-06-24 17:29:58.227300 (Thread-9): Parsing macros/materializations/table.sql
2021-06-24 17:29:58.236917 (Thread-9): Parsing macros/materializations/incremental.sql
2021-06-24 17:29:58.249335 (Thread-9): Parsing macros/materializations/seed.sql
2021-06-24 17:29:58.252008 (Thread-9): Parsing macros/materializations/snapshot.sql
2021-06-24 17:29:58.253824 (Thread-9): Parsing macros/materializations/view.sql
2021-06-24 17:29:58.257294 (Thread-9): Parsing macros/core.sql
2021-06-24 17:29:58.261139 (Thread-9): Parsing macros/materializations/helpers.sql
2021-06-24 17:29:58.270040 (Thread-9): Parsing macros/materializations/common/merge.sql
2021-06-24 17:29:58.283983 (Thread-9): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-24 17:29:58.285800 (Thread-9): Parsing macros/materializations/snapshot/strategies.sql
2021-06-24 17:29:58.303105 (Thread-9): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-24 17:29:58.334270 (Thread-9): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-24 17:29:58.339299 (Thread-9): Parsing macros/materializations/view/view.sql
2021-06-24 17:29:58.345488 (Thread-9): Parsing macros/materializations/seed/seed.sql
2021-06-24 17:29:58.366397 (Thread-9): Parsing macros/materializations/table/table.sql
2021-06-24 17:29:58.373085 (Thread-9): Parsing macros/materializations/incremental/helpers.sql
2021-06-24 17:29:58.375133 (Thread-9): Parsing macros/materializations/incremental/incremental.sql
2021-06-24 17:29:58.381192 (Thread-9): Parsing macros/etc/is_incremental.sql
2021-06-24 17:29:58.382811 (Thread-9): Parsing macros/etc/query.sql
2021-06-24 17:29:58.383890 (Thread-9): Parsing macros/etc/datetime.sql
2021-06-24 17:29:58.392684 (Thread-9): Parsing macros/etc/get_custom_alias.sql
2021-06-24 17:29:58.393685 (Thread-9): Parsing macros/etc/get_custom_database.sql
2021-06-24 17:29:58.395341 (Thread-9): Parsing macros/etc/get_custom_schema.sql
2021-06-24 17:29:58.397326 (Thread-9): Parsing macros/schema_tests/not_null.sql
2021-06-24 17:29:58.398911 (Thread-9): Parsing macros/schema_tests/accepted_values.sql
2021-06-24 17:29:58.401582 (Thread-9): Parsing macros/schema_tests/relationships.sql
2021-06-24 17:29:58.403621 (Thread-9): Parsing macros/schema_tests/unique.sql
2021-06-24 17:29:58.405362 (Thread-9): Parsing macros/adapters/common.sql
2021-06-24 17:29:58.458979 (Thread-9): project hash mismatch: values missing, cache invalidated: {'my_new_project'}
2021-06-24 17:29:58.478762 (Thread-9): Acquiring new bigquery connection "model.my_new_project.test".
2021-06-24 17:29:58.643974 (Thread-10): handling status request
2021-06-24 17:29:58.644478 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e6b6d0>]}
2021-06-24 17:29:58.645042 (Thread-10): sending response (<Response 185 bytes [200 OK]>) to 10.0.40.2
2021-06-24 17:29:58.654527 (Thread-11): handling status request
2021-06-24 17:29:58.655365 (Thread-12): handling status request
2021-06-24 17:29:58.656022 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e7d760>]}
2021-06-24 17:29:58.656350 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ecbd60>]}
2021-06-24 17:29:58.657370 (Thread-11): sending response (<Response 185 bytes [200 OK]>) to 10.0.21.203
2021-06-24 17:29:58.657845 (Thread-12): sending response (<Response 185 bytes [200 OK]>) to 10.0.40.2
2021-06-24 17:29:58.705220 (Thread-9): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652df3670>]}
2021-06-24 17:29:59.860239 (Thread-13): handling status request
2021-06-24 17:29:59.860520 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ecb130>]}
2021-06-24 17:29:59.861281 (Thread-13): sending response (<Response 10225 bytes [200 OK]>) to 10.0.21.135
2021-06-24 17:29:59.892632 (Thread-14): handling status request
2021-06-24 17:29:59.892858 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ecb190>]}
2021-06-24 17:29:59.893544 (Thread-14): sending response (<Response 10225 bytes [200 OK]>) to 10.0.47.156
2021-06-24 17:29:59.913481 (Thread-15): handling status request
2021-06-24 17:29:59.913687 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ecb610>]}
2021-06-24 17:29:59.914312 (Thread-15): sending response (<Response 10225 bytes [200 OK]>) to 10.0.45.5
2021-06-24 17:30:47.316154 (MainThread): Connection 'model.my_new_project.test' was properly closed.
2021-06-24 17:30:47.359222 (Thread-16): Got an acceptable cached parse result
2021-06-24 17:30:47.383928 (Thread-16): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-06-24 17:30:47.481199 (Thread-16): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653258520>]}
2021-06-24 17:30:47.771275 (Thread-17): handling status request
2021-06-24 17:30:47.772022 (Thread-18): handling status request
2021-06-24 17:30:47.772226 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653258520>]}
2021-06-24 17:30:47.772482 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653258220>]}
2021-06-24 17:30:47.773019 (Thread-17): sending response (<Response 1189 bytes [200 OK]>) to 10.0.42.69
2021-06-24 17:30:47.773507 (Thread-18): sending response (<Response 1189 bytes [200 OK]>) to 10.0.36.22
2021-06-24 17:30:47.861834 (Thread-19): handling status request
2021-06-24 17:30:47.862116 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652f245b0>]}
2021-06-24 17:30:47.862602 (Thread-19): sending response (<Response 1189 bytes [200 OK]>) to 10.0.3.5
2021-06-24 17:31:17.811040 (Thread-20): handling status request
2021-06-24 17:31:17.812591 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652f246d0>]}
2021-06-24 17:31:17.813089 (Thread-20): sending response (<Response 1189 bytes [200 OK]>) to 10.0.6.80
2021-06-24 17:31:18.219507 (Thread-21): handling run_sql request
2021-06-24 17:31:18.219797 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66532581c0>]}
2021-06-24 17:31:18.222038 (Thread-21): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-06-24 17:31:20.072420 (Thread-21): sending response (<Response 138 bytes [200 OK]>) to 10.0.47.156
2021-06-24 17:31:20.082568 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 17:31:20.097982 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72efe8de-d0ce-45cf-b4b6-d44daa6f2ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63e380fa0>]}
2021-06-24 17:31:20.098253 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 17:31:20.098658 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 17:31:20.098764 (Thread-1): Compiling rpc.my_new_project.request
2021-06-24 17:31:20.099970 (Thread-1): finished collecting timing info
2021-06-24 17:31:20.100095 (Thread-1): Opening a new connection, currently in state init
2021-06-24 17:31:20.104659 (Thread-1): On rpc.my_new_project.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-24 17:31:20.338780 (Thread-22): handling poll request
2021-06-24 17:31:20.339105 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e3af40>]}
2021-06-24 17:31:20.340100 (Thread-22): sending response (<Response 4115 bytes [200 OK]>) to 10.0.31.198
2021-06-24 17:31:20.651221 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/139b8023-8ba9-4b39-8f53-ca88c840336c?maxResults=0&location=US&prettyPrint=false: The project raw has not enabled BigQuery.')
2021-06-24 17:31:21.662763 (Thread-23): handling poll request
2021-06-24 17:31:21.663036 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e3ac70>]}
2021-06-24 17:31:21.663537 (Thread-23): sending response (<Response 878 bytes [200 OK]>) to 10.0.12.250
2021-06-24 17:31:21.987538 (Thread-1): finished collecting timing info
2021-06-24 17:31:21.987732 (Thread-1): Got an exception: Database Error
  The project raw has not enabled BigQuery.
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/91b56770-aa94-4862-8689-2a8a210e6b01?maxResults=0&location=US&prettyPrint=false: The project raw has not enabled BigQuery.

(job ID: 91b56770-aa94-4862-8689-2a8a210e6b01)

                       -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:with customers as (
   2:
   3:    select
   4:        id as customer_id,
   5:        first_name,
   6:        last_name
   7:
   8:    from raw.jaffle_shop.customers
   9:
  10:),
  11:
  12:orders as (
  13:
  14:    select
  15:        id as order_id,
  16:        user_id as customer_id,
  17:        order_date,
  18:        status
  19:
  20:    from raw.jaffle_shop.orders
  21:
  22:),
  23:
  24:customer_orders as (
  25:
  26:    select
  27:        customer_id,
  28:
  29:        min(order_date) as first_order_date,
  30:        max(order_date) as most_recent_order_date,
  31:        count(order_id) as number_of_orders
  32:
  33:    from orders
  34:
  35:    group by 1
  36:
  37:),
  38:
  39:
  40:final as (
  41:
  42:    select
  43:        customers.customer_id,
  44:        customers.first_name,
  45:        customers.last_name,
  46:        customer_orders.first_order_date,
  47:        customer_orders.most_recent_order_date,
  48:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  49:
  50:    from customers
  51:
  52:    left join customer_orders using (customer_id)
  53:
  54:)
  55:
  56:select * from final
  57:limit 500
  58:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  The project raw has not enabled BigQuery.
2021-06-24 17:31:21.990222 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  The project raw has not enabled BigQuery.', 'raw_sql': 'with customers as (\r\n\r\n    select\r\n        id as customer_id,\r\n        first_name,\r\n        last_name\r\n\r\n    from raw.jaffle_shop.customers\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select\r\n        id as order_id,\r\n        user_id as customer_id,\r\n        order_date,\r\n        status\r\n\r\n    from raw.jaffle_shop.orders\r\n\r\n),\r\n\r\ncustomer_orders as (\r\n\r\n    select\r\n        customer_id,\r\n\r\n        min(order_date) as first_order_date,\r\n        max(order_date) as most_recent_order_date,\r\n        count(order_id) as number_of_orders\r\n\r\n    from orders\r\n\r\n    group by 1\r\n\r\n),\r\n\r\n\r\nfinal as (\r\n\r\n    select\r\n        customers.customer_id,\r\n        customers.first_name,\r\n        customers.last_name,\r\n        customer_orders.first_order_date,\r\n        customer_orders.most_recent_order_date,\r\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\r\n\r\n    from customers\r\n\r\n    left join customer_orders using (customer_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with customers as (\r\n\r\n    select\r\n        id as customer_id,\r\n        first_name,\r\n        last_name\r\n\r\n    from raw.jaffle_shop.customers\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select\r\n        id as order_id,\r\n        user_id as customer_id,\r\n        order_date,\r\n        status\r\n\r\n    from raw.jaffle_shop.orders\r\n\r\n),\r\n\r\ncustomer_orders as (\r\n\r\n    select\r\n        customer_id,\r\n\r\n        min(order_date) as first_order_date,\r\n        max(order_date) as most_recent_order_date,\r\n        count(order_id) as number_of_orders\r\n\r\n    from orders\r\n\r\n    group by 1\r\n\r\n),\r\n\r\n\r\nfinal as (\r\n\r\n    select\r\n        customers.customer_id,\r\n        customers.first_name,\r\n        customers.last_name,\r\n        customer_orders.first_order_date,\r\n        customer_orders.most_recent_order_date,\r\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\r\n\r\n    from customers\r\n\r\n    left join customer_orders using (customer_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  The project raw has not enabled BigQuery.', 'raw_sql': 'with customers as (\r\n\r\n    select\r\n        id as customer_id,\r\n        first_name,\r\n        last_name\r\n\r\n    from raw.jaffle_shop.customers\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select\r\n        id as order_id,\r\n        user_id as customer_id,\r\n        order_date,\r\n        status\r\n\r\n    from raw.jaffle_shop.orders\r\n\r\n),\r\n\r\ncustomer_orders as (\r\n\r\n    select\r\n        customer_id,\r\n\r\n        min(order_date) as first_order_date,\r\n        max(order_date) as most_recent_order_date,\r\n        count(order_id) as number_of_orders\r\n\r\n    from orders\r\n\r\n    group by 1\r\n\r\n),\r\n\r\n\r\nfinal as (\r\n\r\n    select\r\n        customers.customer_id,\r\n        customers.first_name,\r\n        customers.last_name,\r\n        customer_orders.first_order_date,\r\n        customer_orders.most_recent_order_date,\r\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\r\n\r\n    from customers\r\n\r\n    left join customer_orders using (customer_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with customers as (\r\n\r\n    select\r\n        id as customer_id,\r\n        first_name,\r\n        last_name\r\n\r\n    from raw.jaffle_shop.customers\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select\r\n        id as order_id,\r\n        user_id as customer_id,\r\n        order_date,\r\n        status\r\n\r\n    from raw.jaffle_shop.orders\r\n\r\n),\r\n\r\ncustomer_orders as (\r\n\r\n    select\r\n        customer_id,\r\n\r\n        min(order_date) as first_order_date,\r\n        max(order_date) as most_recent_order_date,\r\n        count(order_id) as number_of_orders\r\n\r\n    from orders\r\n\r\n    group by 1\r\n\r\n),\r\n\r\n\r\nfinal as (\r\n\r\n    select\r\n        customers.customer_id,\r\n        customers.first_name,\r\n        customers.last_name,\r\n        customer_orders.first_order_date,\r\n        customer_orders.most_recent_order_date,\r\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders\r\n\r\n    from customers\r\n\r\n    left join customer_orders using (customer_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-06-24 17:31:22.877037 (Thread-24): handling poll request
2021-06-24 17:31:22.877306 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e9be20>]}
2021-06-24 17:31:22.878762 (Thread-24): sending response (<Response 20211 bytes [200 OK]>) to 10.0.12.250
2021-06-24 17:32:55.905368 (Thread-25): handling status request
2021-06-24 17:32:55.907372 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e3a190>]}
2021-06-24 17:32:55.907955 (Thread-25): sending response (<Response 1189 bytes [200 OK]>) to 10.0.45.5
2021-06-24 17:32:56.138233 (Thread-26): handling compile_sql request
2021-06-24 17:32:56.138522 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665462f070>]}
2021-06-24 17:32:57.964244 (Thread-26): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.45
2021-06-24 17:32:57.975087 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 17:32:57.985993 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cd52811-0d8e-4fd8-af4c-0bf850422ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef87bd0c70>]}
2021-06-24 17:32:57.986259 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 17:32:57.986679 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 17:32:57.986778 (Thread-1): Compiling rpc.my_new_project.request
2021-06-24 17:32:57.987843 (Thread-1): finished collecting timing info
2021-06-24 17:32:57.987954 (Thread-1): finished collecting timing info
2021-06-24 17:32:58.196531 (Thread-27): handling poll request
2021-06-24 17:32:58.196857 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e9b2b0>]}
2021-06-24 17:32:58.198125 (Thread-27): sending response (<Response 8840 bytes [200 OK]>) to 10.0.26.142
2021-06-24 19:34:59.780430 (Thread-28): handling status request
2021-06-24 19:34:59.780725 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e9bd00>]}
2021-06-24 19:34:59.781268 (Thread-28): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.2
2021-06-24 19:34:59.784427 (Thread-29): handling status request
2021-06-24 19:34:59.784633 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e9bf70>]}
2021-06-24 19:34:59.785029 (Thread-29): sending response (<Response 1189 bytes [200 OK]>) to 10.0.21.135
2021-06-24 19:34:59.787484 (Thread-30): handling ps request
2021-06-24 19:34:59.787679 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e9bca0>]}
2021-06-24 19:34:59.788216 (Thread-30): sending response (<Response 1124 bytes [200 OK]>) to 10.0.26.142
2021-06-24 19:34:59.810989 (Thread-31): handling status request
2021-06-24 19:34:59.811280 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e9bd30>]}
2021-06-24 19:34:59.811792 (Thread-31): sending response (<Response 1189 bytes [200 OK]>) to 10.0.3.5
2021-06-24 19:34:59.906293 (Thread-32): handling status request
2021-06-24 19:34:59.906578 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e9b940>]}
2021-06-24 19:34:59.907110 (Thread-32): sending response (<Response 1189 bytes [200 OK]>) to 10.0.21.135
2021-06-24 19:53:04.927757 (Thread-33): handling status request
2021-06-24 19:53:04.929497 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e9bee0>]}
2021-06-24 19:53:04.930052 (Thread-33): sending response (<Response 1189 bytes [200 OK]>) to 10.0.26.7
2021-06-24 19:53:05.144456 (Thread-34): handling run_sql request
2021-06-24 19:53:05.144754 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e87220>]}
2021-06-24 19:53:06.944533 (Thread-34): sending response (<Response 138 bytes [200 OK]>) to 10.0.10.110
2021-06-24 19:53:06.955078 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 19:53:06.968691 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '162a0165-c38c-4ed5-b336-058ec0db3057', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2576524c70>]}
2021-06-24 19:53:06.968921 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 19:53:06.969308 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 19:53:06.969412 (Thread-1): Compiling rpc.my_new_project.request
2021-06-24 19:53:06.970546 (Thread-1): finished collecting timing info
2021-06-24 19:53:06.970666 (Thread-1): Opening a new connection, currently in state init
2021-06-24 19:53:06.974959 (Thread-1): On rpc.my_new_project.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-24 19:53:07.293821 (Thread-35): handling poll request
2021-06-24 19:53:07.294150 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e3ad60>]}
2021-06-24 19:53:07.295114 (Thread-35): sending response (<Response 4137 bytes [200 OK]>) to 10.0.36.22
2021-06-24 19:53:08.580469 (Thread-36): handling poll request
2021-06-24 19:53:08.580751 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e64340>]}
2021-06-24 19:53:08.581254 (Thread-36): sending response (<Response 393 bytes [200 OK]>) to 10.0.40.72
2021-06-24 19:53:08.703408 (Thread-1): finished collecting timing info
2021-06-24 19:53:09.865195 (Thread-37): handling poll request
2021-06-24 19:53:09.865485 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e87760>]}
2021-06-24 19:53:09.866899 (Thread-37): sending response (<Response 12079 bytes [200 OK]>) to 10.0.40.2
2021-06-24 19:53:13.621902 (Thread-38): handling status request
2021-06-24 19:53:13.622198 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e87fa0>]}
2021-06-24 19:53:13.622746 (Thread-38): sending response (<Response 1189 bytes [200 OK]>) to 10.0.42.69
2021-06-24 19:53:13.897615 (Thread-39): handling compile_sql request
2021-06-24 19:53:13.897924 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66530643d0>]}
2021-06-24 19:53:15.701907 (Thread-39): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.22
2021-06-24 19:53:15.712601 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 19:53:15.723229 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '101526c1-de4c-4219-b02f-c02c5618b0c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944d178040>]}
2021-06-24 19:53:15.723460 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 19:53:15.723855 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 19:53:15.723960 (Thread-1): Compiling rpc.my_new_project.request
2021-06-24 19:53:15.725021 (Thread-1): finished collecting timing info
2021-06-24 19:53:15.725137 (Thread-1): finished collecting timing info
2021-06-24 19:53:15.907656 (Thread-40): handling poll request
2021-06-24 19:53:15.908012 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653013af0>]}
2021-06-24 19:53:15.909289 (Thread-40): sending response (<Response 8927 bytes [200 OK]>) to 10.0.3.5
2021-06-24 19:57:16.658695 (Thread-41): handling status request
2021-06-24 19:57:16.660437 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e643d0>]}
2021-06-24 19:57:16.660966 (Thread-41): sending response (<Response 1189 bytes [200 OK]>) to 10.0.26.142
2021-06-24 19:57:16.901555 (Thread-42): handling run_sql request
2021-06-24 19:57:16.901867 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e64190>]}
2021-06-24 19:57:18.677708 (Thread-42): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.5
2021-06-24 19:57:18.688152 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 19:57:18.702633 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c98dfbd0-b8e1-4177-aa6e-db498336e7de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ebbc95190>]}
2021-06-24 19:57:18.702874 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 19:57:18.703310 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 19:57:18.703415 (Thread-1): Compiling rpc.my_new_project.request
2021-06-24 19:57:18.705404 (Thread-1): finished collecting timing info
2021-06-24 19:57:18.705530 (Thread-1): Opening a new connection, currently in state init
2021-06-24 19:57:18.710038 (Thread-1): On rpc.my_new_project.request: --build this as a table



with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-24 19:57:18.919875 (Thread-43): handling poll request
2021-06-24 19:57:18.920207 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ee2d00>]}
2021-06-24 19:57:18.921242 (Thread-43): sending response (<Response 4058 bytes [200 OK]>) to 10.0.40.2
2021-06-24 19:57:20.187335 (Thread-44): handling poll request
2021-06-24 19:57:20.187611 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ee2490>]}
2021-06-24 19:57:20.188162 (Thread-44): sending response (<Response 393 bytes [200 OK]>) to 10.0.40.2
2021-06-24 19:57:20.684534 (Thread-1): finished collecting timing info
2021-06-24 19:57:21.413903 (Thread-45): handling poll request
2021-06-24 19:57:21.414203 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ed6190>]}
2021-06-24 19:57:21.415580 (Thread-45): sending response (<Response 12119 bytes [200 OK]>) to 10.0.26.142
2021-06-24 19:57:23.147060 (Thread-46): handling status request
2021-06-24 19:57:23.147343 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ed61f0>]}
2021-06-24 19:57:23.147867 (Thread-46): sending response (<Response 1189 bytes [200 OK]>) to 10.0.42.69
2021-06-24 19:57:23.373700 (Thread-47): handling compile_sql request
2021-06-24 19:57:23.373992 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ed6340>]}
2021-06-24 19:57:25.240305 (Thread-47): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.69
2021-06-24 19:57:25.254601 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 19:57:25.267128 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1d90284-adf7-45f5-92f2-f886008e8f9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc061bad6a0>]}
2021-06-24 19:57:25.267439 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 19:57:25.267899 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 19:57:25.268017 (Thread-1): Compiling rpc.my_new_project.request
2021-06-24 19:57:25.270213 (Thread-1): finished collecting timing info
2021-06-24 19:57:25.270333 (Thread-1): finished collecting timing info
2021-06-24 19:57:25.512936 (Thread-48): handling poll request
2021-06-24 19:57:25.513239 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652d81760>]}
2021-06-24 19:57:25.514767 (Thread-48): sending response (<Response 8968 bytes [200 OK]>) to 10.0.40.45
2021-06-24 19:57:59.210099 (Thread-49): handling status request
2021-06-24 19:57:59.210386 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ed6a30>]}
2021-06-24 19:57:59.210915 (Thread-49): sending response (<Response 1189 bytes [200 OK]>) to 10.0.6.80
2021-06-24 19:57:59.314161 (Thread-50): handling status request
2021-06-24 19:57:59.314487 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ee0f10>]}
2021-06-24 19:57:59.314977 (Thread-50): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.45
2021-06-24 19:57:59.466181 (Thread-51): handling cli_args request
2021-06-24 19:57:59.466480 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ee2640>]}
2021-06-24 19:58:01.282923 (Thread-51): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.22
2021-06-24 19:58:01.318326 (MainThread): Partial parsing not enabled
2021-06-24 19:58:01.320648 (MainThread): Parsing macros/adapters.sql
2021-06-24 19:58:01.340152 (MainThread): Parsing macros/etc.sql
2021-06-24 19:58:01.342265 (MainThread): Parsing macros/catalog.sql
2021-06-24 19:58:01.349160 (MainThread): Parsing macros/materializations/copy.sql
2021-06-24 19:58:01.353513 (MainThread): Parsing macros/materializations/table.sql
2021-06-24 19:58:01.363130 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-24 19:58:01.375380 (MainThread): Parsing macros/materializations/seed.sql
2021-06-24 19:58:01.378098 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-24 19:58:01.379926 (MainThread): Parsing macros/materializations/view.sql
2021-06-24 19:58:01.383396 (MainThread): Parsing macros/core.sql
2021-06-24 19:58:01.387226 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-24 19:58:01.396122 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-24 19:58:01.410109 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-24 19:58:01.411988 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-24 19:58:01.429464 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-24 19:58:01.460269 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-24 19:58:01.465208 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-24 19:58:01.471345 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-24 19:58:01.489361 (Thread-52): handling poll request
2021-06-24 19:58:01.489643 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665305f850>]}
2021-06-24 19:58:01.490692 (Thread-52): sending response (<Response 5544 bytes [200 OK]>) to 10.0.24.126
2021-06-24 19:58:01.491617 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-24 19:58:01.498118 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-24 19:58:01.499956 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-24 19:58:01.505947 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-24 19:58:01.507558 (MainThread): Parsing macros/etc/query.sql
2021-06-24 19:58:01.508651 (MainThread): Parsing macros/etc/datetime.sql
2021-06-24 19:58:01.517467 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-24 19:58:01.518493 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-24 19:58:01.520172 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-24 19:58:01.522245 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-24 19:58:01.523794 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-24 19:58:01.526725 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-24 19:58:01.528756 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-24 19:58:01.530597 (MainThread): Parsing macros/adapters/common.sql
2021-06-24 19:58:01.580458 (MainThread): Partial parsing not enabled
2021-06-24 19:58:01.608692 (MainThread): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-06-24 19:58:01.711799 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '372d077d-7340-4466-bfd7-cc3ccfb72326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb086c460>]}
2021-06-24 19:58:01.723218 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '372d077d-7340-4466-bfd7-cc3ccfb72326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb09c09a0>]}
2021-06-24 19:58:01.723624 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 19:58:01.723894 (MainThread): The selector 'dim_customers.sql' does not match any nodes and will be ignored
2021-06-24 19:58:01.724070 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-06-24 19:58:02.717871 (Thread-53): handling poll request
2021-06-24 19:58:02.718209 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665304d7f0>]}
2021-06-24 19:58:02.719176 (Thread-53): sending response (<Response 6720 bytes [200 OK]>) to 10.0.40.45
2021-06-24 19:58:03.146475 (Thread-54): handling status request
2021-06-24 19:58:03.146792 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665304d880>]}
2021-06-24 19:58:03.147333 (Thread-54): sending response (<Response 1189 bytes [200 OK]>) to 10.0.6.80
2021-06-24 19:58:03.148247 (Thread-55): handling status request
2021-06-24 19:58:03.148587 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652fb3160>]}
2021-06-24 19:58:03.149043 (Thread-55): sending response (<Response 1189 bytes [200 OK]>) to 10.0.12.250
2021-06-24 19:58:03.210637 (Thread-56): handling status request
2021-06-24 19:58:03.210922 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665304df40>]}
2021-06-24 19:58:03.236767 (Thread-56): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.2
2021-06-24 19:58:44.658628 (Thread-57): handling status request
2021-06-24 19:58:44.658935 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ec2070>]}
2021-06-24 19:58:44.659469 (Thread-57): sending response (<Response 1189 bytes [200 OK]>) to 10.0.12.250
2021-06-24 19:58:44.823047 (Thread-58): handling status request
2021-06-24 19:58:44.823354 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665304d160>]}
2021-06-24 19:58:44.823847 (Thread-58): sending response (<Response 1189 bytes [200 OK]>) to 10.0.3.5
2021-06-24 19:58:44.902265 (Thread-59): handling cli_args request
2021-06-24 19:58:44.902541 (Thread-59): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665304df40>]}
2021-06-24 19:58:44.914333 (Thread-59): sending response (<Response 591 bytes [200 OK]>) to 10.0.21.203
2021-06-24 19:58:53.539790 (Thread-60): handling status request
2021-06-24 19:58:53.540071 (Thread-60): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665458c250>]}
2021-06-24 19:58:53.540587 (Thread-60): sending response (<Response 1189 bytes [200 OK]>) to 10.0.31.198
2021-06-24 19:58:53.550594 (Thread-61): handling status request
2021-06-24 19:58:53.550834 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665458cf10>]}
2021-06-24 19:58:53.551349 (Thread-61): sending response (<Response 1189 bytes [200 OK]>) to 10.0.24.126
2021-06-24 19:58:53.617091 (Thread-62): handling status request
2021-06-24 19:58:53.617385 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665458c2b0>]}
2021-06-24 19:58:53.617930 (Thread-62): sending response (<Response 1189 bytes [200 OK]>) to 10.0.26.142
2021-06-24 19:58:59.204056 (Thread-63): handling status request
2021-06-24 19:58:59.204347 (Thread-63): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653210910>]}
2021-06-24 19:58:59.204836 (Thread-63): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.72
2021-06-24 19:58:59.235417 (Thread-64): handling status request
2021-06-24 19:58:59.235697 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653210cd0>]}
2021-06-24 19:58:59.236203 (Thread-64): sending response (<Response 1189 bytes [200 OK]>) to 10.0.26.142
2021-06-24 19:58:59.432418 (Thread-65): handling cli_args request
2021-06-24 19:58:59.432708 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66532105e0>]}
2021-06-24 19:58:59.442453 (Thread-65): sending response (<Response 569 bytes [200 OK]>) to 10.0.12.250
2021-06-24 19:59:02.294530 (Thread-66): handling status request
2021-06-24 19:59:02.294819 (Thread-66): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652fee610>]}
2021-06-24 19:59:02.295307 (Thread-66): sending response (<Response 1189 bytes [200 OK]>) to 10.0.24.126
2021-06-24 19:59:02.380882 (Thread-67): handling status request
2021-06-24 19:59:02.381273 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652fee520>]}
2021-06-24 19:59:02.382011 (Thread-67): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.72
2021-06-24 19:59:02.394359 (Thread-68): handling status request
2021-06-24 19:59:02.394598 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665328cbe0>]}
2021-06-24 19:59:02.395095 (Thread-68): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.72
2021-06-24 19:59:05.421454 (Thread-69): handling status request
2021-06-24 19:59:05.421779 (Thread-69): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665328c730>]}
2021-06-24 19:59:05.422271 (Thread-69): sending response (<Response 1189 bytes [200 OK]>) to 10.0.45.5
2021-06-24 19:59:05.519869 (Thread-70): handling status request
2021-06-24 19:59:05.520152 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665458c640>]}
2021-06-24 19:59:05.520643 (Thread-70): sending response (<Response 1189 bytes [200 OK]>) to 10.0.21.135
2021-06-24 19:59:05.652164 (Thread-71): handling cli_args request
2021-06-24 19:59:05.652447 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665458cd30>]}
2021-06-24 19:59:07.554714 (Thread-71): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.80
2021-06-24 19:59:07.592105 (MainThread): Partial parsing not enabled
2021-06-24 19:59:07.594565 (MainThread): Parsing macros/adapters.sql
2021-06-24 19:59:07.614445 (MainThread): Parsing macros/etc.sql
2021-06-24 19:59:07.616567 (MainThread): Parsing macros/catalog.sql
2021-06-24 19:59:07.623676 (MainThread): Parsing macros/materializations/copy.sql
2021-06-24 19:59:07.628062 (MainThread): Parsing macros/materializations/table.sql
2021-06-24 19:59:07.637869 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-24 19:59:07.654313 (MainThread): Parsing macros/materializations/seed.sql
2021-06-24 19:59:07.657093 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-24 19:59:07.659015 (MainThread): Parsing macros/materializations/view.sql
2021-06-24 19:59:07.662518 (MainThread): Parsing macros/core.sql
2021-06-24 19:59:07.666441 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-24 19:59:07.675767 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-24 19:59:07.694229 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-24 19:59:07.696085 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-24 19:59:07.713299 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-24 19:59:07.747263 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-24 19:59:07.753184 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-24 19:59:07.759735 (Thread-72): handling poll request
2021-06-24 19:59:07.760031 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66545abcd0>]}
2021-06-24 19:59:07.761046 (Thread-72): sending response (<Response 5238 bytes [200 OK]>) to 10.0.26.7
2021-06-24 19:59:07.759495 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-24 19:59:07.780097 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-24 19:59:07.786788 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-24 19:59:07.788725 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-24 19:59:07.794751 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-24 19:59:07.796520 (MainThread): Parsing macros/etc/query.sql
2021-06-24 19:59:07.798220 (MainThread): Parsing macros/etc/datetime.sql
2021-06-24 19:59:07.807807 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-24 19:59:07.808830 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-24 19:59:07.810533 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-24 19:59:07.812496 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-24 19:59:07.814101 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-24 19:59:07.816768 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-24 19:59:07.818702 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-24 19:59:07.820486 (MainThread): Parsing macros/adapters/common.sql
2021-06-24 19:59:07.872042 (MainThread): Partial parsing not enabled
2021-06-24 19:59:07.901457 (MainThread): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-06-24 19:59:08.016440 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbc83b0f-af71-4fb3-a3a5-ed4a01eae4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5e47d2e0>]}
2021-06-24 19:59:08.040783 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbc83b0f-af71-4fb3-a3a5-ed4a01eae4d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5e64f8e0>]}
2021-06-24 19:59:08.041246 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 19:59:08.041853 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-06-24 19:59:08.999375 (Thread-73): handling poll request
2021-06-24 19:59:08.999657 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665304df40>]}
2021-06-24 19:59:09.000476 (Thread-73): sending response (<Response 6660 bytes [200 OK]>) to 10.0.40.45
2021-06-24 19:59:09.400305 (Thread-74): handling status request
2021-06-24 19:59:09.400605 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665328ce20>]}
2021-06-24 19:59:09.401150 (Thread-74): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.2
2021-06-24 19:59:09.406692 (Thread-75): handling status request
2021-06-24 19:59:09.406914 (Thread-75): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ee04c0>]}
2021-06-24 19:59:09.407386 (Thread-75): sending response (<Response 1189 bytes [200 OK]>) to 10.0.26.7
2021-06-24 19:59:09.459529 (Thread-76): handling status request
2021-06-24 19:59:09.459865 (Thread-76): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6653075310>]}
2021-06-24 19:59:09.460374 (Thread-76): sending response (<Response 1189 bytes [200 OK]>) to 10.0.21.135
2021-06-24 20:00:04.225608 (Thread-77): Got an acceptable cached parse result
2021-06-24 20:00:04.246913 (Thread-77): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-06-24 20:00:04.355448 (Thread-77): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ebc760>]}
2021-06-24 20:00:04.547665 (Thread-78): handling status request
2021-06-24 20:00:04.547946 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ebcc10>]}
2021-06-24 20:00:04.548478 (Thread-78): sending response (<Response 1189 bytes [200 OK]>) to 10.0.21.203
2021-06-24 20:00:04.626104 (Thread-79): handling status request
2021-06-24 20:00:04.626391 (Thread-79): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ebc2b0>]}
2021-06-24 20:00:04.626881 (Thread-79): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.72
2021-06-24 20:00:04.653620 (Thread-80): handling status request
2021-06-24 20:00:04.653944 (Thread-80): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652f95a30>]}
2021-06-24 20:00:04.654457 (Thread-80): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.72
2021-06-24 20:00:07.618783 (Thread-81): handling status request
2021-06-24 20:00:07.619067 (Thread-81): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652ebc2b0>]}
2021-06-24 20:00:07.619556 (Thread-81): sending response (<Response 1189 bytes [200 OK]>) to 10.0.26.7
2021-06-24 20:00:07.717866 (Thread-82): handling status request
2021-06-24 20:00:07.718169 (Thread-82): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652fea550>]}
2021-06-24 20:00:07.718647 (Thread-82): sending response (<Response 1189 bytes [200 OK]>) to 10.0.21.135
2021-06-24 20:00:07.832130 (Thread-83): handling cli_args request
2021-06-24 20:00:07.832424 (Thread-83): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652feac70>]}
2021-06-24 20:00:07.850891 (Thread-83): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-06-24 20:00:09.682583 (Thread-83): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.69
2021-06-24 20:00:09.718929 (MainThread): Partial parsing not enabled
2021-06-24 20:00:09.752627 (MainThread): Parsing macros/adapters.sql
2021-06-24 20:00:09.775656 (MainThread): Parsing macros/etc.sql
2021-06-24 20:00:09.777886 (MainThread): Parsing macros/catalog.sql
2021-06-24 20:00:09.785021 (MainThread): Parsing macros/materializations/copy.sql
2021-06-24 20:00:09.789486 (MainThread): Parsing macros/materializations/table.sql
2021-06-24 20:00:09.799999 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-24 20:00:09.815361 (MainThread): Parsing macros/materializations/seed.sql
2021-06-24 20:00:09.818174 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-24 20:00:09.820049 (MainThread): Parsing macros/materializations/view.sql
2021-06-24 20:00:09.823634 (MainThread): Parsing macros/core.sql
2021-06-24 20:00:09.827547 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-24 20:00:09.836742 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-24 20:00:09.852483 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-24 20:00:09.854546 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-24 20:00:09.872643 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-24 20:00:09.903557 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-24 20:00:09.908531 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-24 20:00:09.914808 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-24 20:00:09.935239 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-24 20:00:09.942158 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-24 20:00:09.944374 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-24 20:00:09.950869 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-24 20:00:09.952848 (MainThread): Parsing macros/etc/query.sql
2021-06-24 20:00:09.954196 (MainThread): Parsing macros/etc/datetime.sql
2021-06-24 20:00:09.963163 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-24 20:00:09.964226 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-24 20:00:09.967969 (Thread-84): handling poll request
2021-06-24 20:00:09.968280 (Thread-84): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652fea6d0>]}
2021-06-24 20:00:09.966030 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-24 20:00:09.969603 (Thread-84): sending response (<Response 8001 bytes [200 OK]>) to 10.0.40.2
2021-06-24 20:00:09.968046 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-24 20:00:09.969684 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-24 20:00:09.972427 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-24 20:00:09.974416 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-24 20:00:09.976250 (MainThread): Parsing macros/adapters/common.sql
2021-06-24 20:00:10.026495 (MainThread): Partial parsing not enabled
2021-06-24 20:00:10.055407 (MainThread): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-06-24 20:00:10.182319 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5d1fa39-498c-4a38-867c-abeaa1752fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834b027460>]}
2021-06-24 20:00:10.199671 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5d1fa39-498c-4a38-867c-abeaa1752fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834b004fd0>]}
2021-06-24 20:00:10.199927 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 20:00:10.200385 (MainThread): 
2021-06-24 20:00:10.200632 (MainThread): Acquiring new bigquery connection "master".
2021-06-24 20:00:10.201403 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-24 20:00:10.201533 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-24 20:00:10.370472 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_neat-episode-288515_dbt_mskonberg".
2021-06-24 20:00:10.370690 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_neat-episode-288515_dbt_mskonberg".
2021-06-24 20:00:10.370742 (ThreadPoolExecutor-0_0): Creating schema "neat-episode-288515.dbt_mskonberg".
2021-06-24 20:00:10.370806 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-06-24 20:00:10.841034 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-24 20:00:10.841175 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-24 20:00:11.061786 (MainThread): 20:00:11 | Concurrency: 1 threads (target='default')
2021-06-24 20:00:11.061918 (MainThread): 20:00:11 | 
2021-06-24 20:00:11.063887 (Thread-1): Began running node model.my_new_project.dim_customers
2021-06-24 20:00:11.064344 (Thread-1): 20:00:11 | 1 of 1 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-24 20:00:11.064584 (Thread-1): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-06-24 20:00:11.064662 (Thread-1): Compiling model.my_new_project.dim_customers
2021-06-24 20:00:11.067004 (Thread-1): Writing injected SQL for node "model.my_new_project.dim_customers"
2021-06-24 20:00:11.103861 (Thread-1): finished collecting timing info
2021-06-24 20:00:11.142608 (Thread-1): Writing runtime SQL for node "model.my_new_project.dim_customers"
2021-06-24 20:00:11.160035 (Thread-85): handling poll request
2021-06-24 20:00:11.160293 (Thread-85): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652fa0f10>]}
2021-06-24 20:00:11.161128 (Thread-85): sending response (<Response 9906 bytes [200 OK]>) to 10.0.26.142
2021-06-24 20:00:11.182072 (Thread-1): Opening a new connection, currently in state closed
2021-06-24 20:00:11.186382 (Thread-1): On model.my_new_project.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.my_new_project.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-24 20:00:12.396652 (Thread-86): handling poll request
2021-06-24 20:00:12.396952 (Thread-86): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652fa0e20>]}
2021-06-24 20:00:12.490359 (Thread-86): sending response (<Response 2239 bytes [200 OK]>) to 10.0.10.110
2021-06-24 20:00:13.728948 (Thread-87): handling poll request
2021-06-24 20:00:13.729239 (Thread-87): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652fa07f0>]}
2021-06-24 20:00:13.729796 (Thread-87): sending response (<Response 284 bytes [200 OK]>) to 10.0.40.72
2021-06-24 20:00:14.185011 (Thread-1): finished collecting timing info
2021-06-24 20:00:14.185403 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5d1fa39-498c-4a38-867c-abeaa1752fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834a122e80>]}
2021-06-24 20:00:14.185726 (Thread-1): 20:00:14 | 1 of 1 OK created table model dbt_mskonberg.dim_customers............ [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.12s]
2021-06-24 20:00:14.185809 (Thread-1): Finished running node model.my_new_project.dim_customers
2021-06-24 20:00:14.187199 (MainThread): Acquiring new bigquery connection "master".
2021-06-24 20:00:14.187450 (MainThread): 20:00:14 | 
2021-06-24 20:00:14.187515 (MainThread): 20:00:14 | Finished running 1 table model in 3.99s.
2021-06-24 20:00:14.187562 (MainThread): Connection 'master' was properly closed.
2021-06-24 20:00:14.187602 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-06-24 20:00:14.229620 (MainThread): 
2021-06-24 20:00:14.229776 (MainThread): Completed successfully
2021-06-24 20:00:14.229841 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-24 20:00:14.929919 (Thread-88): handling poll request
2021-06-24 20:00:14.930194 (Thread-88): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652f7a190>]}
2021-06-24 20:00:14.931122 (Thread-88): sending response (<Response 8940 bytes [200 OK]>) to 10.0.10.110
2021-06-24 20:00:15.286289 (Thread-89): handling status request
2021-06-24 20:00:15.286568 (Thread-89): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652f95f10>]}
2021-06-24 20:00:15.287104 (Thread-89): sending response (<Response 1189 bytes [200 OK]>) to 10.0.31.198
2021-06-24 20:00:15.335787 (Thread-90): handling status request
2021-06-24 20:00:15.336029 (Thread-90): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652f95ee0>]}
2021-06-24 20:00:15.336485 (Thread-90): sending response (<Response 1189 bytes [200 OK]>) to 10.0.36.19
2021-06-24 20:00:15.349959 (Thread-91): handling status request
2021-06-24 20:00:15.350164 (Thread-91): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652f95cd0>]}
2021-06-24 20:00:15.350575 (Thread-91): sending response (<Response 1189 bytes [200 OK]>) to 10.0.42.69
2021-06-24 20:05:26.586531 (Thread-92): Got an acceptable cached parse result
2021-06-24 20:05:26.611549 (Thread-92): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-06-24 20:05:26.860518 (Thread-92): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665141b880>]}
2021-06-24 20:05:26.999582 (Thread-93): handling status request
2021-06-24 20:05:26.999870 (Thread-93): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6651492670>]}
2021-06-24 20:05:27.000388 (Thread-93): sending response (<Response 1189 bytes [200 OK]>) to 10.0.45.5
2021-06-24 20:05:27.030716 (Thread-94): handling status request
2021-06-24 20:05:27.031197 (Thread-94): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6651492130>]}
2021-06-24 20:05:27.031754 (Thread-95): handling status request
2021-06-24 20:05:27.032533 (Thread-94): sending response (<Response 1189 bytes [200 OK]>) to 10.0.42.69
2021-06-24 20:05:27.032858 (Thread-95): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6651472fd0>]}
2021-06-24 20:05:27.033471 (Thread-95): sending response (<Response 1189 bytes [200 OK]>) to 10.0.24.126
2021-06-24 20:06:04.877000 (Thread-96): handling status request
2021-06-24 20:06:04.877293 (Thread-96): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6651492190>]}
2021-06-24 20:06:04.877834 (Thread-96): sending response (<Response 1189 bytes [200 OK]>) to 10.0.21.135
2021-06-24 20:06:05.169226 (Thread-97): handling run_sql request
2021-06-24 20:06:05.169504 (Thread-97): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6651492b50>]}
2021-06-24 20:06:05.170700 (Thread-97): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-06-24 20:06:07.078205 (Thread-97): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.45
2021-06-24 20:06:07.089433 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 20:06:07.100125 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2218c6d6-c82b-4ead-86d7-c373d3d4de3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee90194730>]}
2021-06-24 20:06:07.100380 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 20:06:07.100815 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 20:06:07.100925 (Thread-1): Compiling rpc.my_new_project.request
2021-06-24 20:06:07.102129 (Thread-1): finished collecting timing info
2021-06-24 20:06:07.102257 (Thread-1): Opening a new connection, currently in state init
2021-06-24 20:06:07.109239 (Thread-1): On rpc.my_new_project.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers
limit 500
/* limit added automatically by dbt cloud */
2021-06-24 20:06:07.346866 (Thread-98): handling poll request
2021-06-24 20:06:07.347934 (Thread-98): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6651472b20>]}
2021-06-24 20:06:07.349161 (Thread-98): sending response (<Response 3266 bytes [200 OK]>) to 10.0.45.5
2021-06-24 20:06:08.348512 (Thread-1): finished collecting timing info
2021-06-24 20:06:08.597327 (Thread-99): handling poll request
2021-06-24 20:06:08.597614 (Thread-99): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66513a6d30>]}
2021-06-24 20:06:08.598746 (Thread-99): sending response (<Response 5806 bytes [200 OK]>) to 10.0.47.156
2021-06-24 20:06:12.310314 (Thread-100): handling status request
2021-06-24 20:06:12.310596 (Thread-100): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665139dcd0>]}
2021-06-24 20:06:12.311202 (Thread-100): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.2
2021-06-24 20:06:12.546427 (Thread-101): handling compile_sql request
2021-06-24 20:06:12.546752 (Thread-101): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66513938e0>]}
2021-06-24 20:06:14.358606 (Thread-101): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.22
2021-06-24 20:06:14.369583 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 20:06:14.380215 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbc71258-6e90-4276-9185-2fb741d38461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcadef40760>]}
2021-06-24 20:06:14.380467 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 20:06:14.380911 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 20:06:14.381018 (Thread-1): Compiling rpc.my_new_project.request
2021-06-24 20:06:14.382143 (Thread-1): finished collecting timing info
2021-06-24 20:06:14.382257 (Thread-1): finished collecting timing info
2021-06-24 20:06:14.603201 (Thread-102): handling poll request
2021-06-24 20:06:14.603508 (Thread-102): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665145bee0>]}
2021-06-24 20:06:14.604642 (Thread-102): sending response (<Response 5420 bytes [200 OK]>) to 10.0.26.7
2021-06-24 20:06:18.578424 (Thread-103): Got an acceptable cached parse result
2021-06-24 20:06:18.600275 (Thread-103): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-06-24 20:06:18.703317 (Thread-103): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665150da90>]}
2021-06-24 20:06:18.997366 (Thread-104): handling status request
2021-06-24 20:06:18.997700 (Thread-104): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665150d310>]}
2021-06-24 20:06:18.998308 (Thread-104): sending response (<Response 1192 bytes [200 OK]>) to 10.0.6.80
2021-06-24 20:06:19.014565 (Thread-105): handling status request
2021-06-24 20:06:19.014820 (Thread-105): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665150db20>]}
2021-06-24 20:06:19.015334 (Thread-105): sending response (<Response 1192 bytes [200 OK]>) to 10.0.6.80
2021-06-24 20:06:19.047606 (Thread-106): handling status request
2021-06-24 20:06:19.047965 (Thread-106): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66513ccc10>]}
2021-06-24 20:06:19.048494 (Thread-106): sending response (<Response 1192 bytes [200 OK]>) to 10.0.6.80
2021-06-24 20:06:38.338107 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-06-24 20:06:38.377893 (Thread-107): Got an acceptable cached parse result
2021-06-24 20:06:38.412333 (Thread-107): Acquiring new bigquery connection "model.my_new_project.stg_orders".
2021-06-24 20:06:38.519295 (Thread-107): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66545909a0>]}
2021-06-24 20:06:42.708443 (Thread-108): handling status request
2021-06-24 20:06:42.708779 (Thread-108): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665141b850>]}
2021-06-24 20:06:42.709332 (Thread-108): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.45
2021-06-24 20:06:42.771073 (Thread-109): handling status request
2021-06-24 20:06:42.771347 (Thread-109): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654590c10>]}
2021-06-24 20:06:42.771964 (Thread-109): sending response (<Response 1189 bytes [200 OK]>) to 10.0.26.7
2021-06-24 20:07:26.417211 (Thread-110): handling status request
2021-06-24 20:07:26.417490 (Thread-110): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654590dc0>]}
2021-06-24 20:07:26.418020 (Thread-110): sending response (<Response 1189 bytes [200 OK]>) to 10.0.3.5
2021-06-24 20:07:26.624717 (Thread-111): handling run_sql request
2021-06-24 20:07:26.624997 (Thread-111): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654590b50>]}
2021-06-24 20:07:26.626150 (Thread-111): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-06-24 20:07:28.464710 (Thread-111): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.142
2021-06-24 20:07:28.475644 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 20:07:28.486440 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8070c7cf-8c20-4b92-a40a-d660d109c96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc1901c70>]}
2021-06-24 20:07:28.486682 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 20:07:28.487108 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 20:07:28.487215 (Thread-1): Compiling rpc.my_new_project.request
2021-06-24 20:07:28.488328 (Thread-1): finished collecting timing info
2021-06-24 20:07:28.488453 (Thread-1): Opening a new connection, currently in state init
2021-06-24 20:07:28.492945 (Thread-1): On rpc.my_new_project.request: with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders
limit 500
/* limit added automatically by dbt cloud */
2021-06-24 20:07:28.740642 (Thread-112): handling poll request
2021-06-24 20:07:28.740971 (Thread-112): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e26910>]}
2021-06-24 20:07:28.742004 (Thread-112): sending response (<Response 3284 bytes [200 OK]>) to 10.0.26.7
2021-06-24 20:07:29.915946 (Thread-1): finished collecting timing info
2021-06-24 20:07:29.994246 (Thread-113): handling poll request
2021-06-24 20:07:29.994577 (Thread-113): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f665317ad60>]}
2021-06-24 20:07:29.995129 (Thread-113): sending response (<Response 799 bytes [200 OK]>) to 10.0.40.45
2021-06-24 20:07:31.204968 (Thread-114): handling poll request
2021-06-24 20:07:31.205321 (Thread-114): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66513c44c0>]}
2021-06-24 20:07:31.206740 (Thread-114): sending response (<Response 7085 bytes [200 OK]>) to 10.0.21.203
2021-06-24 20:07:32.705746 (Thread-115): handling status request
2021-06-24 20:07:32.706053 (Thread-115): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654590cd0>]}
2021-06-24 20:07:32.706613 (Thread-115): sending response (<Response 1189 bytes [200 OK]>) to 10.0.36.22
2021-06-24 20:07:32.951523 (Thread-116): handling compile_sql request
2021-06-24 20:07:32.951791 (Thread-116): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6654590fa0>]}
2021-06-24 20:07:34.835308 (Thread-116): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.19
2021-06-24 20:07:34.846539 (MainThread): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 20:07:34.857068 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '102cbc6d-acb9-4ef1-90b8-4d2c086730b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a769edcd0>]}
2021-06-24 20:07:34.857339 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-24 20:07:34.857784 (Thread-1): Acquiring new bigquery connection "rpc.my_new_project.request".
2021-06-24 20:07:34.857887 (Thread-1): Compiling rpc.my_new_project.request
2021-06-24 20:07:34.858969 (Thread-1): finished collecting timing info
2021-06-24 20:07:34.859082 (Thread-1): finished collecting timing info
2021-06-24 20:07:35.097632 (Thread-117): handling poll request
2021-06-24 20:07:35.098003 (Thread-117): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652e8eca0>]}
2021-06-24 20:07:35.099366 (Thread-117): sending response (<Response 5496 bytes [200 OK]>) to 10.0.40.72
2021-06-24 20:07:37.277543 (Thread-118): Got an acceptable cached parse result
2021-06-24 20:07:37.303094 (Thread-118): Acquiring new bigquery connection "model.my_new_project.stg_orders".
2021-06-24 20:07:37.398258 (Thread-118): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652de10a0>]}
2021-06-24 20:07:37.602411 (Thread-119): handling status request
2021-06-24 20:07:37.602716 (Thread-119): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652de1b20>]}
2021-06-24 20:07:37.603269 (Thread-119): sending response (<Response 1189 bytes [200 OK]>) to 10.0.21.135
2021-06-24 20:07:37.675591 (Thread-120): handling status request
2021-06-24 20:07:37.675887 (Thread-120): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652de1790>]}
2021-06-24 20:07:37.676415 (Thread-120): sending response (<Response 1189 bytes [200 OK]>) to 10.0.31.198
2021-06-24 20:07:37.720137 (Thread-121): handling status request
2021-06-24 20:07:37.720405 (Thread-121): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'e8c0279d-fdc1-4f00-b0e3-98e5611e510a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6652de1c10>]}
2021-06-24 20:07:37.720934 (Thread-121): sending response (<Response 1189 bytes [200 OK]>) to 10.0.40.2
2021-06-25 08:53:27.207363 (MainThread): Running with dbt=0.19.1
2021-06-25 08:53:27.352547 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-06-25 08:53:27.360254 (MainThread): Tracking: tracking
2021-06-25 08:53:27.375490 (Thread-1): Parsing macros/adapters.sql
2021-06-25 08:53:27.396725 (Thread-1): Parsing macros/etc.sql
2021-06-25 08:53:27.399092 (Thread-1): Parsing macros/catalog.sql
2021-06-25 08:53:27.405288 (Thread-1): Parsing macros/materializations/copy.sql
2021-06-25 08:53:27.410973 (Thread-1): Parsing macros/materializations/table.sql
2021-06-25 08:53:27.420980 (Thread-1): Parsing macros/materializations/incremental.sql
2021-06-25 08:53:27.433359 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc0e50c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c74250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c747f0>]}
2021-06-25 08:53:27.433783 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-06-25 08:53:27.434008 (Thread-1): Parsing macros/materializations/seed.sql
2021-06-25 08:53:27.434325 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-06-25 08:53:27.437225 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-06-25 08:53:27.437654 (Thread-1): Parsing macros/materializations/snapshot.sql
2021-06-25 08:53:27.439595 (Thread-1): Parsing macros/materializations/view.sql
2021-06-25 08:53:27.443338 (Thread-1): Parsing macros/core.sql
2021-06-25 08:53:27.447355 (Thread-1): Parsing macros/materializations/helpers.sql
2021-06-25 08:53:27.456293 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-06-25 08:53:27.470026 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 08:53:27.471788 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 08:53:27.489424 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 08:53:27.520095 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 08:53:27.524989 (Thread-1): Parsing macros/materializations/view/view.sql
2021-06-25 08:53:27.531012 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-06-25 08:53:27.551203 (Thread-1): Parsing macros/materializations/table/table.sql
2021-06-25 08:53:27.557701 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 08:53:27.559615 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 08:53:27.565689 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-06-25 08:53:27.567280 (Thread-1): Parsing macros/etc/query.sql
2021-06-25 08:53:27.568332 (Thread-1): Parsing macros/etc/datetime.sql
2021-06-25 08:53:27.576891 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-06-25 08:53:27.577860 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-06-25 08:53:27.579494 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-06-25 08:53:27.581425 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-06-25 08:53:27.582987 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 08:53:27.585612 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-06-25 08:53:27.587496 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-06-25 08:53:27.589237 (Thread-1): Parsing macros/adapters/common.sql
2021-06-25 08:53:27.766183 (Thread-1): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-06-25 08:53:27.778257 (Thread-1): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-06-25 08:53:27.784763 (Thread-1): Acquiring new bigquery connection "model.my_new_project.stg_orders".
2021-06-25 08:53:27.865830 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a2fe50>]}
2021-06-25 08:53:28.903917 (Thread-3): handling status request
2021-06-25 08:53:28.904596 (Thread-2): handling status request
2021-06-25 08:53:28.905226 (Thread-4): handling status request
2021-06-25 08:53:28.905414 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a9b640>]}
2021-06-25 08:53:28.905649 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8aac700>]}
2021-06-25 08:53:28.905887 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a58670>]}
2021-06-25 08:53:28.906775 (Thread-3): sending response (<Response 10099 bytes [200 OK]>) to 10.0.12.250
2021-06-25 08:53:28.907570 (Thread-2): sending response (<Response 10099 bytes [200 OK]>) to 10.0.12.250
2021-06-25 08:53:28.908339 (Thread-4): sending response (<Response 10099 bytes [200 OK]>) to 10.0.31.198
2021-06-25 08:53:28.944457 (Thread-5): handling status request
2021-06-25 08:53:28.944692 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b85b50>]}
2021-06-25 08:53:28.945376 (Thread-5): sending response (<Response 10099 bytes [200 OK]>) to 10.0.3.5
2021-06-25 08:53:29.030056 (Thread-6): handling ps request
2021-06-25 08:53:29.030347 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b85040>]}
2021-06-25 08:53:29.030824 (Thread-6): sending response (<Response 105 bytes [200 OK]>) to 10.0.10.110
2021-06-25 08:54:56.095599 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-06-25 08:54:56.135536 (Thread-7): Got an acceptable cached parse result
2021-06-25 08:54:56.259733 (Thread-7): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a1b340>]}
2021-06-25 08:54:56.615344 (Thread-8): handling status request
2021-06-25 08:54:56.615693 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f0da60>]}
2021-06-25 08:54:56.616211 (Thread-8): sending response (<Response 883 bytes [200 OK]>) to 10.0.36.19
2021-06-25 08:54:56.674440 (Thread-9): handling status request
2021-06-25 08:54:56.675268 (Thread-10): handling status request
2021-06-25 08:54:56.675467 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80faee0>]}
2021-06-25 08:54:56.675686 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b7a5b0>]}
2021-06-25 08:54:56.676214 (Thread-9): sending response (<Response 883 bytes [200 OK]>) to 10.0.40.72
2021-06-25 08:54:56.676686 (Thread-10): sending response (<Response 883 bytes [200 OK]>) to 10.0.40.2
2021-06-25 08:55:03.427512 (Thread-11): Got an acceptable cached parse result
2021-06-25 08:55:03.560903 (Thread-11): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7bffa0>]}
2021-06-25 08:55:03.876617 (Thread-12): handling status request
2021-06-25 08:55:03.876914 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab782370>]}
2021-06-25 08:55:03.877428 (Thread-12): sending response (<Response 885 bytes [200 OK]>) to 10.0.45.5
2021-06-25 08:55:03.890702 (Thread-13): handling status request
2021-06-25 08:55:03.890937 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab77fee0>]}
2021-06-25 08:55:03.891323 (Thread-13): sending response (<Response 885 bytes [200 OK]>) to 10.0.42.69
2021-06-25 08:55:03.981071 (Thread-14): handling status request
2021-06-25 08:55:03.981332 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7bfc10>]}
2021-06-25 08:55:03.981815 (Thread-14): sending response (<Response 885 bytes [200 OK]>) to 10.0.3.5
2021-06-25 08:55:17.322607 (Thread-15): Got an acceptable cached parse result
2021-06-25 08:55:17.356182 (Thread-15): Acquiring new bigquery connection "model.my_new_project.stg_orders".
2021-06-25 08:55:17.580468 (Thread-15): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81990a0>]}
2021-06-25 08:55:17.803303 (Thread-16): handling status request
2021-06-25 08:55:17.803595 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb819b820>]}
2021-06-25 08:55:17.804169 (Thread-16): sending response (<Response 1186 bytes [200 OK]>) to 10.0.47.156
2021-06-25 08:55:17.824740 (Thread-17): handling status request
2021-06-25 08:55:17.824980 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb819beb0>]}
2021-06-25 08:55:17.825450 (Thread-17): sending response (<Response 1186 bytes [200 OK]>) to 10.0.47.156
2021-06-25 08:55:17.835857 (Thread-18): handling status request
2021-06-25 08:55:17.836060 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb819bee0>]}
2021-06-25 08:55:17.836478 (Thread-18): sending response (<Response 1186 bytes [200 OK]>) to 10.0.26.142
2021-06-25 08:55:28.046717 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-06-25 08:55:28.089406 (Thread-19): Got an acceptable cached parse result
2021-06-25 08:55:28.126199 (Thread-19): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-06-25 08:55:28.238809 (Thread-19): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9ec7fd0>]}
2021-06-25 08:55:28.508397 (Thread-20): handling status request
2021-06-25 08:55:28.508754 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6d2130>]}
2021-06-25 08:55:28.509270 (Thread-20): sending response (<Response 1189 bytes [200 OK]>) to 10.0.3.5
2021-06-25 08:55:28.526650 (Thread-21): handling status request
2021-06-25 08:55:28.526859 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7bae80>]}
2021-06-25 08:55:28.527292 (Thread-21): sending response (<Response 1189 bytes [200 OK]>) to 10.0.6.80
2021-06-25 08:55:28.534499 (Thread-22): handling status request
2021-06-25 08:55:28.534681 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7ba130>]}
2021-06-25 08:55:28.535052 (Thread-22): sending response (<Response 1189 bytes [200 OK]>) to 10.0.6.80
2021-06-25 08:55:38.877559 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-06-25 08:55:38.922052 (Thread-23): Got an acceptable cached parse result
2021-06-25 08:55:38.957447 (Thread-23): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-06-25 08:55:39.083605 (Thread-23): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-25 08:55:39.084019 (Thread-23): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8ae1370>]}
2021-06-25 08:55:39.376285 (Thread-24): handling status request
2021-06-25 08:55:39.376633 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6bf760>]}
2021-06-25 08:55:39.377179 (Thread-24): sending response (<Response 1619 bytes [200 OK]>) to 10.0.40.2
2021-06-25 08:55:39.377810 (Thread-25): handling status request
2021-06-25 08:55:39.378413 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b14e20>]}
2021-06-25 08:55:39.378860 (Thread-25): sending response (<Response 1619 bytes [200 OK]>) to 10.0.26.142
2021-06-25 08:55:39.448927 (Thread-26): handling status request
2021-06-25 08:55:39.449269 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c3c2e0>]}
2021-06-25 08:55:39.449819 (Thread-26): sending response (<Response 1619 bytes [200 OK]>) to 10.0.3.5
2021-06-25 08:55:44.129855 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-06-25 08:55:44.168350 (Thread-27): Got an acceptable cached parse result
2021-06-25 08:55:44.316025 (Thread-27): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-25 08:55:44.324157 (Thread-27): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81e5550>]}
2021-06-25 08:55:44.585721 (Thread-28): handling status request
2021-06-25 08:55:44.586001 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6c5790>]}
2021-06-25 08:55:44.586509 (Thread-28): sending response (<Response 1315 bytes [200 OK]>) to 10.0.36.19
2021-06-25 08:55:44.635940 (Thread-29): handling status request
2021-06-25 08:55:44.636204 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6c5730>]}
2021-06-25 08:55:44.657394 (Thread-30): handling status request
2021-06-25 08:55:44.658470 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8bea550>]}
2021-06-25 08:55:44.665314 (Thread-29): sending response (<Response 1315 bytes [200 OK]>) to 10.0.6.80
2021-06-25 08:55:44.665769 (Thread-30): sending response (<Response 1315 bytes [200 OK]>) to 10.0.40.72
2021-06-25 08:56:55.029425 (Thread-31): Got an acceptable cached parse result
2021-06-25 08:56:55.280136 (Thread-31): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-25 08:56:55.280528 (Thread-31): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6dbfa0>]}
2021-06-25 08:56:55.466788 (Thread-32): handling status request
2021-06-25 08:56:55.467074 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6dbb80>]}
2021-06-25 08:56:55.467613 (Thread-32): sending response (<Response 1315 bytes [200 OK]>) to 10.0.12.250
2021-06-25 08:56:55.532235 (Thread-33): handling status request
2021-06-25 08:56:55.532509 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6dbd00>]}
2021-06-25 08:56:55.533028 (Thread-33): sending response (<Response 1315 bytes [200 OK]>) to 10.0.12.250
2021-06-25 08:56:55.595106 (Thread-34): handling status request
2021-06-25 08:56:55.595378 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6db490>]}
2021-06-25 08:56:55.595878 (Thread-34): sending response (<Response 1315 bytes [200 OK]>) to 10.0.42.69
2021-06-25 08:57:02.986012 (Thread-35): Got an acceptable cached parse result
2021-06-25 08:57:03.019422 (Thread-35): Acquiring new bigquery connection "model.my_new_project.dim_customers".
2021-06-25 08:57:03.134716 (Thread-35): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-25 08:57:03.135138 (Thread-35): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81d7e20>]}
2021-06-25 08:57:03.327017 (Thread-36): handling status request
2021-06-25 08:57:03.327310 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81d7f10>]}
2021-06-25 08:57:03.327951 (Thread-36): sending response (<Response 1619 bytes [200 OK]>) to 10.0.40.45
2021-06-25 08:57:03.367912 (Thread-37): handling status request
2021-06-25 08:57:03.368192 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81d7880>]}
2021-06-25 08:57:03.368724 (Thread-37): sending response (<Response 1619 bytes [200 OK]>) to 10.0.26.7
2021-06-25 08:57:03.375385 (Thread-38): handling status request
2021-06-25 08:57:03.375611 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a350d0>]}
2021-06-25 08:57:03.376092 (Thread-38): sending response (<Response 1619 bytes [200 OK]>) to 10.0.21.203
2021-06-25 08:57:11.266168 (MainThread): Connection 'model.my_new_project.dim_customers' was properly closed.
2021-06-25 08:57:11.301593 (Thread-39): Got an acceptable cached parse result
2021-06-25 08:57:11.435297 (Thread-39): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-25 08:57:11.435710 (Thread-39): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a999a0>]}
2021-06-25 08:57:11.691624 (Thread-40): handling status request
2021-06-25 08:57:11.691992 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81e2490>]}
2021-06-25 08:57:11.692760 (Thread-40): sending response (<Response 1315 bytes [200 OK]>) to 10.0.3.5
2021-06-25 08:57:11.693255 (Thread-41): handling status request
2021-06-25 08:57:11.693988 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a993a0>]}
2021-06-25 08:57:11.694539 (Thread-41): sending response (<Response 1315 bytes [200 OK]>) to 10.0.47.156
2021-06-25 08:57:11.799256 (Thread-42): handling status request
2021-06-25 08:57:11.799553 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a99c70>]}
2021-06-25 08:57:11.800053 (Thread-42): sending response (<Response 1315 bytes [200 OK]>) to 10.0.36.19
2021-06-25 08:57:22.994818 (Thread-43): Got an acceptable cached parse result
2021-06-25 08:57:23.146626 (Thread-43): Acquiring new bigquery connection "model.my_new_project.stg_customers".
2021-06-25 08:57:23.267304 (Thread-43): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-25 08:57:23.267702 (Thread-43): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5b35e0>]}
2021-06-25 08:57:23.373419 (Thread-44): handling status request
2021-06-25 08:57:23.373734 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8ace610>]}
2021-06-25 08:57:23.374354 (Thread-44): sending response (<Response 1619 bytes [200 OK]>) to 10.0.21.135
2021-06-25 08:57:23.408540 (Thread-45): handling status request
2021-06-25 08:57:23.408832 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8ace0a0>]}
2021-06-25 08:57:23.409327 (Thread-45): sending response (<Response 1619 bytes [200 OK]>) to 10.0.40.72
2021-06-25 08:57:23.474032 (Thread-46): handling status request
2021-06-25 08:57:23.474317 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f22580>]}
2021-06-25 08:57:23.474829 (Thread-46): sending response (<Response 1619 bytes [200 OK]>) to 10.0.40.2
2021-06-25 08:57:33.477160 (MainThread): Connection 'model.my_new_project.stg_customers' was properly closed.
2021-06-25 08:57:33.519811 (Thread-47): Got an acceptable cached parse result
2021-06-25 08:57:33.550801 (Thread-47): Acquiring new bigquery connection "model.my_new_project.stg_orders".
2021-06-25 08:57:33.671552 (Thread-47): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-06-25 08:57:33.671970 (Thread-47): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6f32e0>]}
2021-06-25 08:57:33.858708 (Thread-48): handling status request
2021-06-25 08:57:33.858983 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8041f70>]}
2021-06-25 08:57:33.859496 (Thread-48): sending response (<Response 1616 bytes [200 OK]>) to 10.0.21.203
2021-06-25 08:57:33.956545 (Thread-49): handling status request
2021-06-25 08:57:33.956836 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8041a30>]}
2021-06-25 08:57:33.957423 (Thread-49): sending response (<Response 1616 bytes [200 OK]>) to 10.0.36.19
2021-06-25 08:57:33.973894 (Thread-50): handling status request
2021-06-25 08:57:33.974106 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8041b20>]}
2021-06-25 08:57:33.974554 (Thread-50): sending response (<Response 1616 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:05:23.593302 (MainThread): Connection 'model.my_new_project.stg_orders' was properly closed.
2021-06-25 09:05:23.627311 (Thread-51): project hash mismatch: values missing, cache invalidated: {'jaffle_shop'}
2021-06-25 09:05:23.630029 (Thread-51): Parsing macros/adapters.sql
2021-06-25 09:05:23.648953 (Thread-51): Parsing macros/etc.sql
2021-06-25 09:05:23.650997 (Thread-51): Parsing macros/catalog.sql
2021-06-25 09:05:23.656969 (Thread-51): Parsing macros/materializations/copy.sql
2021-06-25 09:05:23.661316 (Thread-51): Parsing macros/materializations/table.sql
2021-06-25 09:05:23.670906 (Thread-51): Parsing macros/materializations/incremental.sql
2021-06-25 09:05:23.683160 (Thread-51): Parsing macros/materializations/seed.sql
2021-06-25 09:05:23.685984 (Thread-51): Parsing macros/materializations/snapshot.sql
2021-06-25 09:05:23.687835 (Thread-51): Parsing macros/materializations/view.sql
2021-06-25 09:05:23.692200 (Thread-51): Parsing macros/core.sql
2021-06-25 09:05:23.696123 (Thread-51): Parsing macros/materializations/helpers.sql
2021-06-25 09:05:23.705328 (Thread-51): Parsing macros/materializations/common/merge.sql
2021-06-25 09:05:23.719423 (Thread-51): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 09:05:23.721191 (Thread-51): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 09:05:23.739109 (Thread-51): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 09:05:23.771709 (Thread-51): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 09:05:23.777213 (Thread-51): Parsing macros/materializations/view/view.sql
2021-06-25 09:05:23.783685 (Thread-51): Parsing macros/materializations/seed/seed.sql
2021-06-25 09:05:23.811087 (Thread-51): Parsing macros/materializations/table/table.sql
2021-06-25 09:05:23.817682 (Thread-51): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 09:05:23.819652 (Thread-51): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 09:05:23.825614 (Thread-51): Parsing macros/etc/is_incremental.sql
2021-06-25 09:05:23.827373 (Thread-51): Parsing macros/etc/query.sql
2021-06-25 09:05:23.828439 (Thread-51): Parsing macros/etc/datetime.sql
2021-06-25 09:05:23.837226 (Thread-51): Parsing macros/etc/get_custom_alias.sql
2021-06-25 09:05:23.838221 (Thread-51): Parsing macros/etc/get_custom_database.sql
2021-06-25 09:05:23.839843 (Thread-51): Parsing macros/etc/get_custom_schema.sql
2021-06-25 09:05:23.841832 (Thread-51): Parsing macros/schema_tests/not_null.sql
2021-06-25 09:05:23.843464 (Thread-51): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 09:05:23.846192 (Thread-51): Parsing macros/schema_tests/relationships.sql
2021-06-25 09:05:23.848037 (Thread-51): Parsing macros/schema_tests/unique.sql
2021-06-25 09:05:23.849997 (Thread-51): Parsing macros/adapters/common.sql
2021-06-25 09:05:23.903635 (Thread-51): project hash mismatch: values missing, cache invalidated: {'jaffle_shop'}
2021-06-25 09:05:23.923588 (Thread-51): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 09:05:23.928353 (Thread-51): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 09:05:23.932947 (Thread-51): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 09:05:24.037653 (Thread-51): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:05:24.038120 (Thread-51): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8af4760>]}
2021-06-25 09:05:24.110477 (Thread-52): handling status request
2021-06-25 09:05:24.110774 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8af4af0>]}
2021-06-25 09:05:24.111593 (Thread-52): sending response (<Response 11275 bytes [200 OK]>) to 10.0.12.250
2021-06-25 09:05:24.248582 (Thread-53): handling status request
2021-06-25 09:05:24.248863 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8accd90>]}
2021-06-25 09:05:24.249640 (Thread-53): sending response (<Response 11275 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:05:24.250684 (Thread-54): handling status request
2021-06-25 09:05:24.251050 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab78c3d0>]}
2021-06-25 09:05:24.251837 (Thread-54): sending response (<Response 11275 bytes [200 OK]>) to 10.0.21.135
2021-06-25 09:05:33.106590 (Thread-55): handling status request
2021-06-25 09:05:33.106888 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81e0340>]}
2021-06-25 09:05:33.107673 (Thread-55): sending response (<Response 11275 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:05:33.389479 (Thread-56): handling cli_args request
2021-06-25 09:05:33.389783 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab78c730>]}
2021-06-25 09:05:33.400970 (Thread-56): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 09:05:33.436548 (Thread-57): handling status request
2021-06-25 09:05:33.437135 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab77dca0>]}
2021-06-25 09:05:33.438501 (Thread-57): sending response (<Response 11275 bytes [200 OK]>) to 10.0.42.69
2021-06-25 09:05:35.193215 (Thread-56): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.80
2021-06-25 09:05:35.230428 (MainThread): Partial parsing not enabled
2021-06-25 09:05:35.233076 (MainThread): Parsing macros/adapters.sql
2021-06-25 09:05:35.253809 (MainThread): Parsing macros/etc.sql
2021-06-25 09:05:35.256274 (MainThread): Parsing macros/catalog.sql
2021-06-25 09:05:35.262334 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 09:05:35.266877 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 09:05:35.276755 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 09:05:35.288942 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 09:05:35.291769 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 09:05:35.293711 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 09:05:35.297199 (MainThread): Parsing macros/core.sql
2021-06-25 09:05:35.301035 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 09:05:35.310116 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 09:05:35.324262 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 09:05:35.326288 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 09:05:35.343808 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 09:05:35.376186 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 09:05:35.381229 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 09:05:35.387434 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 09:05:35.408158 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 09:05:35.414782 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 09:05:35.416741 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 09:05:35.422740 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 09:05:35.424406 (MainThread): Parsing macros/etc/query.sql
2021-06-25 09:05:35.425527 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 09:05:35.434434 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 09:05:35.435473 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 09:05:35.437202 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 09:05:35.439282 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 09:05:35.440933 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 09:05:35.443675 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 09:05:35.445621 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 09:05:35.447539 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 09:05:35.471765 (Thread-58): handling poll request
2021-06-25 09:05:35.472009 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80f1730>]}
2021-06-25 09:05:35.472933 (Thread-58): sending response (<Response 9342 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:05:35.497829 (MainThread): Partial parsing not enabled
2021-06-25 09:05:35.530333 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 09:05:35.541612 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 09:05:35.546826 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 09:05:35.657949 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:05:35.658200 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '325ad7f4-e1db-49c0-9a1d-c37bca45c687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5dbdb070>]}
2021-06-25 09:05:35.678325 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '325ad7f4-e1db-49c0-9a1d-c37bca45c687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5dca0880>]}
2021-06-25 09:05:35.678723 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:05:35.679386 (MainThread): 
2021-06-25 09:05:35.679639 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 09:05:35.680530 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 09:05:35.680654 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 09:05:36.887245 (Thread-59): handling poll request
2021-06-25 09:05:36.887575 (Thread-59): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5b89d0>]}
2021-06-25 09:05:36.917058 (Thread-59): sending response (<Response 4229 bytes [200 OK]>) to 10.0.40.45
2021-06-25 09:05:36.945739 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 09:05:36.945887 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 09:05:37.142509 (MainThread): 09:05:37 | Concurrency: 1 threads (target='default')
2021-06-25 09:05:37.142642 (MainThread): 09:05:37 | 
2021-06-25 09:05:37.144795 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 09:05:37.145071 (Thread-1): 09:05:37 | 1 of 3 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-25 09:05:37.145291 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 09:05:37.145373 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 09:05:37.149848 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 09:05:37.185905 (Thread-1): finished collecting timing info
2021-06-25 09:05:37.204406 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 09:05:37.428519 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 09:05:37.467308 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 09:05:38.210507 (Thread-60): handling poll request
2021-06-25 09:05:38.210807 (Thread-60): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab76e6a0>]}
2021-06-25 09:05:38.211480 (Thread-60): sending response (<Response 6241 bytes [200 OK]>) to 10.0.10.110
2021-06-25 09:05:39.517863 (Thread-61): handling poll request
2021-06-25 09:05:39.518142 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8bc82e0>]}
2021-06-25 09:05:39.518679 (Thread-61): sending response (<Response 285 bytes [200 OK]>) to 10.0.24.126
2021-06-25 09:05:40.493056 (Thread-1): finished collecting timing info
2021-06-25 09:05:40.493497 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '325ad7f4-e1db-49c0-9a1d-c37bca45c687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5cce3ac0>]}
2021-06-25 09:05:40.493831 (Thread-1): 09:05:40 | 1 of 3 OK created table model dbt_mskonberg.dim_customers............ [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.35s]
2021-06-25 09:05:40.493909 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 09:05:40.494011 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 09:05:40.494155 (Thread-1): 09:05:40 | 2 of 3 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 09:05:40.494337 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 09:05:40.494406 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 09:05:40.495801 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 09:05:40.523126 (Thread-1): finished collecting timing info
2021-06-25 09:05:40.540620 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 09:05:40.568092 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 09:05:40.572561 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 09:05:40.855037 (Thread-62): handling poll request
2021-06-25 09:05:40.855325 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8bc89a0>]}
2021-06-25 09:05:40.855995 (Thread-62): sending response (<Response 6020 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:05:41.637895 (Thread-1): finished collecting timing info
2021-06-25 09:05:41.638283 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '325ad7f4-e1db-49c0-9a1d-c37bca45c687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5ccb69a0>]}
2021-06-25 09:05:41.638580 (Thread-1): 09:05:41 | 2 of 3 OK created view model dbt_mskonberg.stg_customers............. [OK in 1.14s]
2021-06-25 09:05:41.638654 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 09:05:41.638756 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 09:05:41.638888 (Thread-1): 09:05:41 | 3 of 3 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 09:05:41.639088 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 09:05:41.639162 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 09:05:41.640624 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 09:05:41.653822 (Thread-1): finished collecting timing info
2021-06-25 09:05:41.655420 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 09:05:41.666928 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 09:05:41.671270 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 09:05:42.183727 (Thread-63): handling poll request
2021-06-25 09:05:42.184028 (Thread-63): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8bb03a0>]}
2021-06-25 09:05:42.184785 (Thread-63): sending response (<Response 5939 bytes [200 OK]>) to 10.0.24.126
2021-06-25 09:05:42.505464 (Thread-1): finished collecting timing info
2021-06-25 09:05:42.505877 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '325ad7f4-e1db-49c0-9a1d-c37bca45c687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa5cce3ac0>]}
2021-06-25 09:05:42.506178 (Thread-1): 09:05:42 | 3 of 3 OK created view model dbt_mskonberg.stg_orders................ [OK in 0.87s]
2021-06-25 09:05:42.506252 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 09:05:42.507712 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 09:05:42.507980 (MainThread): 09:05:42 | 
2021-06-25 09:05:42.508052 (MainThread): 09:05:42 | Finished running 1 table model, 2 view models in 6.83s.
2021-06-25 09:05:42.508103 (MainThread): Connection 'master' was properly closed.
2021-06-25 09:05:42.508142 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-06-25 09:05:42.579882 (MainThread): 
2021-06-25 09:05:42.580040 (MainThread): Completed successfully
2021-06-25 09:05:42.580111 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-25 09:05:43.536595 (Thread-64): handling poll request
2021-06-25 09:05:43.536890 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8bb0220>]}
2021-06-25 09:05:43.538003 (Thread-64): sending response (<Response 13300 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:05:44.184517 (Thread-65): handling status request
2021-06-25 09:05:44.184851 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6f3e80>]}
2021-06-25 09:05:44.185794 (Thread-65): sending response (<Response 11275 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:05:44.193837 (Thread-66): handling status request
2021-06-25 09:05:44.194047 (Thread-66): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8bb0370>]}
2021-06-25 09:05:44.194779 (Thread-66): sending response (<Response 11275 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:05:44.247710 (Thread-67): handling status request
2021-06-25 09:05:44.248061 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab74c700>]}
2021-06-25 09:05:44.248913 (Thread-67): sending response (<Response 11275 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:08:51.926874 (Thread-68): Got an acceptable cached parse result
2021-06-25 09:08:51.959150 (Thread-68): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 09:08:52.208348 (Thread-68): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:08:52.208752 (Thread-68): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5a1d90>]}
2021-06-25 09:08:52.451561 (Thread-69): handling status request
2021-06-25 09:08:52.451841 (Thread-69): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c061f0>]}
2021-06-25 09:08:52.452382 (Thread-69): sending response (<Response 1601 bytes [200 OK]>) to 10.0.24.126
2021-06-25 09:08:52.509815 (Thread-70): handling status request
2021-06-25 09:08:52.510130 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a332e0>]}
2021-06-25 09:08:52.510629 (Thread-70): sending response (<Response 1601 bytes [200 OK]>) to 10.0.12.250
2021-06-25 09:08:52.541456 (Thread-71): handling status request
2021-06-25 09:08:52.541775 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a33370>]}
2021-06-25 09:08:52.542303 (Thread-71): sending response (<Response 1601 bytes [200 OK]>) to 10.0.36.22
2021-06-25 09:08:56.589018 (Thread-73): handling status request
2021-06-25 09:08:56.589296 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a33700>]}
2021-06-25 09:08:56.590136 (Thread-73): sending response (<Response 1601 bytes [200 OK]>) to 10.0.3.5
2021-06-25 09:08:56.594466 (Thread-72): handling status request
2021-06-25 09:08:56.594659 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80ece80>]}
2021-06-25 09:08:56.595049 (Thread-72): sending response (<Response 1601 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:08:56.959994 (Thread-74): handling cli_args request
2021-06-25 09:08:56.960289 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a33ac0>]}
2021-06-25 09:08:56.971665 (Thread-74): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 09:08:58.791157 (Thread-74): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:08:58.827791 (MainThread): Partial parsing not enabled
2021-06-25 09:08:58.830275 (MainThread): Parsing macros/adapters.sql
2021-06-25 09:08:58.851610 (MainThread): Parsing macros/etc.sql
2021-06-25 09:08:58.853872 (MainThread): Parsing macros/catalog.sql
2021-06-25 09:08:58.860440 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 09:08:58.865097 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 09:08:58.875345 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 09:08:58.888787 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 09:08:58.892470 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 09:08:58.895173 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 09:08:58.900029 (MainThread): Parsing macros/core.sql
2021-06-25 09:08:58.905275 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 09:08:58.917569 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 09:08:58.934442 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 09:08:58.936514 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 09:08:58.954219 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 09:08:58.986662 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 09:08:58.992620 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 09:08:58.998927 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 09:08:59.020348 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 09:08:59.027261 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 09:08:59.029218 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 09:08:59.035533 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 09:08:59.037319 (MainThread): Parsing macros/etc/query.sql
2021-06-25 09:08:59.038536 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 09:08:59.047599 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 09:08:59.048678 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 09:08:59.050506 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 09:08:59.052571 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 09:08:59.054301 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 09:08:59.057353 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 09:08:59.059326 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 09:08:59.061146 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 09:08:59.107547 (Thread-75): handling poll request
2021-06-25 09:08:59.107879 (Thread-75): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab623910>]}
2021-06-25 09:08:59.109160 (Thread-75): sending response (<Response 9342 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:08:59.111916 (MainThread): Partial parsing not enabled
2021-06-25 09:08:59.146375 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 09:08:59.161370 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 09:08:59.167327 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 09:08:59.291684 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:08:59.291961 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5acfc7a9-f83f-49d6-8d63-934b03e2cb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc6acd7f0>]}
2021-06-25 09:08:59.307861 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5acfc7a9-f83f-49d6-8d63-934b03e2cb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc6b94910>]}
2021-06-25 09:08:59.308135 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:08:59.308696 (MainThread): 
2021-06-25 09:08:59.309011 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 09:08:59.309954 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 09:08:59.310081 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 09:08:59.510568 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 09:08:59.510712 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 09:08:59.702758 (MainThread): 09:08:59 | Concurrency: 1 threads (target='default')
2021-06-25 09:08:59.702886 (MainThread): 09:08:59 | 
2021-06-25 09:08:59.734628 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 09:08:59.734931 (Thread-1): 09:08:59 | 1 of 3 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 09:08:59.735208 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 09:08:59.735303 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 09:08:59.738558 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 09:08:59.757329 (Thread-1): finished collecting timing info
2021-06-25 09:08:59.785245 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 09:08:59.801209 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:08:59.806064 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 09:09:00.509645 (Thread-76): handling poll request
2021-06-25 09:09:00.509977 (Thread-76): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9ec7d30>]}
2021-06-25 09:09:00.510765 (Thread-76): sending response (<Response 9371 bytes [200 OK]>) to 10.0.3.5
2021-06-25 09:09:00.820163 (Thread-1): finished collecting timing info
2021-06-25 09:09:00.820558 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5acfc7a9-f83f-49d6-8d63-934b03e2cb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc4390790>]}
2021-06-25 09:09:00.820851 (Thread-1): 09:09:00 | 1 of 3 OK created view model dbt_mskonberg.stg_customers............. [OK in 1.09s]
2021-06-25 09:09:00.820925 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 09:09:00.821025 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 09:09:00.821163 (Thread-1): 09:09:00 | 2 of 3 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 09:09:00.821341 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 09:09:00.821409 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 09:09:00.822933 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 09:09:00.842756 (Thread-1): finished collecting timing info
2021-06-25 09:09:00.844664 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 09:09:00.862743 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 09:09:00.867009 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 09:09:01.784091 (Thread-77): handling poll request
2021-06-25 09:09:01.784384 (Thread-77): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7826a0>]}
2021-06-25 09:09:01.785158 (Thread-77): sending response (<Response 5937 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:09:01.895560 (Thread-1): finished collecting timing info
2021-06-25 09:09:01.895947 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5acfc7a9-f83f-49d6-8d63-934b03e2cb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc5bbc0d0>]}
2021-06-25 09:09:01.896401 (Thread-1): 09:09:01 | 2 of 3 OK created view model dbt_mskonberg.stg_orders................ [OK in 1.07s]
2021-06-25 09:09:01.896480 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 09:09:01.897213 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 09:09:01.897389 (Thread-1): 09:09:01 | 3 of 3 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-25 09:09:01.897594 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 09:09:01.897690 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 09:09:01.901240 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 09:09:01.919762 (Thread-1): finished collecting timing info
2021-06-25 09:09:01.933733 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 09:09:02.145804 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 09:09:02.166200 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 09:09:03.080751 (Thread-78): handling poll request
2021-06-25 09:09:03.081047 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbba001640>]}
2021-06-25 09:09:03.081811 (Thread-78): sending response (<Response 6705 bytes [200 OK]>) to 10.0.24.126
2021-06-25 09:09:04.343818 (Thread-79): handling poll request
2021-06-25 09:09:04.344100 (Thread-79): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5a15b0>]}
2021-06-25 09:09:04.344596 (Thread-79): sending response (<Response 285 bytes [200 OK]>) to 10.0.21.203
2021-06-25 09:09:05.247322 (Thread-1): finished collecting timing info
2021-06-25 09:09:05.247724 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5acfc7a9-f83f-49d6-8d63-934b03e2cb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bc5bbc100>]}
2021-06-25 09:09:05.248027 (Thread-1): 09:09:05 | 3 of 3 OK created table model dbt_mskonberg.dim_customers............ [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.35s]
2021-06-25 09:09:05.248104 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 09:09:05.249546 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 09:09:05.249856 (MainThread): 09:09:05 | 
2021-06-25 09:09:05.249924 (MainThread): 09:09:05 | Finished running 2 view models, 1 table model in 5.94s.
2021-06-25 09:09:05.249973 (MainThread): Connection 'master' was properly closed.
2021-06-25 09:09:05.250013 (MainThread): Connection 'list_neat-episode-288515_dbt_mskonberg' was properly closed.
2021-06-25 09:09:05.250050 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 09:09:05.316385 (MainThread): 
2021-06-25 09:09:05.316544 (MainThread): Completed successfully
2021-06-25 09:09:05.316648 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-25 09:09:05.594804 (Thread-80): handling poll request
2021-06-25 09:09:05.595089 (Thread-80): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9ffa0>]}
2021-06-25 09:09:05.596275 (Thread-80): sending response (<Response 13411 bytes [200 OK]>) to 10.0.21.203
2021-06-25 09:09:06.118484 (Thread-81): handling status request
2021-06-25 09:09:06.118771 (Thread-81): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9f6a0>]}
2021-06-25 09:09:06.119407 (Thread-81): sending response (<Response 1601 bytes [200 OK]>) to 10.0.36.22
2021-06-25 09:09:06.234927 (Thread-82): handling status request
2021-06-25 09:09:06.235291 (Thread-82): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9f6d0>]}
2021-06-25 09:09:06.235820 (Thread-82): sending response (<Response 1601 bytes [200 OK]>) to 10.0.24.126
2021-06-25 09:09:06.254743 (Thread-83): handling status request
2021-06-25 09:09:06.254996 (Thread-83): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9fa60>]}
2021-06-25 09:09:06.255472 (Thread-83): sending response (<Response 1601 bytes [200 OK]>) to 10.0.40.45
2021-06-25 09:13:28.172789 (Thread-84): Got an acceptable cached parse result
2021-06-25 09:13:28.317220 (Thread-84): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:13:28.317640 (Thread-84): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab551d60>]}
2021-06-25 09:13:28.619834 (Thread-85): handling status request
2021-06-25 09:13:28.620103 (Thread-85): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab551850>]}
2021-06-25 09:13:28.620601 (Thread-85): sending response (<Response 1300 bytes [200 OK]>) to 10.0.12.250
2021-06-25 09:13:28.634325 (Thread-86): handling status request
2021-06-25 09:13:28.634610 (Thread-86): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab551940>]}
2021-06-25 09:13:28.635145 (Thread-86): sending response (<Response 1300 bytes [200 OK]>) to 10.0.42.69
2021-06-25 09:13:28.761444 (Thread-87): handling status request
2021-06-25 09:13:28.761739 (Thread-87): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5512e0>]}
2021-06-25 09:13:28.762292 (Thread-87): sending response (<Response 1300 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:13:56.597845 (Thread-88): Got an acceptable cached parse result
2021-06-25 09:13:56.631318 (Thread-88): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 09:13:56.742383 (Thread-88): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:13:56.748856 (Thread-88): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a2bbe0>]}
2021-06-25 09:13:56.962010 (Thread-89): handling status request
2021-06-25 09:13:56.962312 (Thread-89): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c06d90>]}
2021-06-25 09:13:57.007462 (Thread-89): sending response (<Response 1600 bytes [200 OK]>) to 10.0.40.45
2021-06-25 09:13:57.075221 (Thread-90): handling status request
2021-06-25 09:13:57.075516 (Thread-90): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7923a0>]}
2021-06-25 09:13:57.076032 (Thread-90): sending response (<Response 1600 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:13:57.166599 (Thread-91): handling status request
2021-06-25 09:13:57.166889 (Thread-91): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab792820>]}
2021-06-25 09:13:57.167393 (Thread-91): sending response (<Response 1600 bytes [200 OK]>) to 10.0.10.110
2021-06-25 09:20:28.246897 (Thread-92): handling status request
2021-06-25 09:20:28.248394 (Thread-92): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a36b80>]}
2021-06-25 09:20:28.248908 (Thread-92): sending response (<Response 1600 bytes [200 OK]>) to 10.0.12.250
2021-06-25 09:20:28.626451 (Thread-93): handling run_sql request
2021-06-25 09:20:28.626727 (Thread-93): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a36f70>]}
2021-06-25 09:20:28.629044 (Thread-93): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-06-25 09:20:30.437695 (Thread-93): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.22
2021-06-25 09:20:30.448608 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:20:30.461706 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1b9360e-00fa-4af7-85dd-9e7a4e8303e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb23470e80>]}
2021-06-25 09:20:30.461951 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:20:30.462350 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:20:30.462480 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:20:30.463591 (Thread-1): finished collecting timing info
2021-06-25 09:20:30.463712 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:20:30.468313 (Thread-1): On rpc.jaffle_shop.request: with payments as (

    select
        id as customer_id,
        orderid as order_id,
        status,
        amount,

    from `dbt-tutorial.stripe.payment

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:20:30.746974 (Thread-94): handling poll request
2021-06-25 09:20:30.747293 (Thread-94): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80ec700>]}
2021-06-25 09:20:30.749164 (Thread-94): sending response (<Response 3269 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:20:30.843507 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/f77fc919-04a5-4383-b24f-692e53edd5b2?maxResults=0&location=US&prettyPrint=false: Syntax error: Unclosed identifier literal at [9:10]')
2021-06-25 09:20:32.037479 (Thread-95): handling poll request
2021-06-25 09:20:32.037793 (Thread-95): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab792fd0>]}
2021-06-25 09:20:32.038343 (Thread-95): sending response (<Response 894 bytes [200 OK]>) to 10.0.24.126
2021-06-25 09:20:32.220035 (Thread-1): finished collecting timing info
2021-06-25 09:20:32.220223 (Thread-1): Got an exception: Database Error
  Syntax error: Unclosed identifier literal at [9:10]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/31171921-cb7a-4fb5-8d5e-79391f03d2a7?maxResults=0&location=US&prettyPrint=false: Syntax error: Unclosed identifier literal at [9:10]

(job ID: 31171921-cb7a-4fb5-8d5e-79391f03d2a7)

         -----Query Job SQL Follows-----         

    |    .    |    .    |    .    |    .    |
   1:with payments as (
   2:
   3:    select
   4:        id as customer_id,
   5:        orderid as order_id,
   6:        status,
   7:        amount,
   8:
   9:    from `dbt-tutorial.stripe.payment
  10:
  11:)
  12:
  13:select * from payments
  14:limit 500
  15:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Unclosed identifier literal at [9:10]
2021-06-25 09:20:32.222701 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Syntax error: Unclosed identifier literal at [9:10]', 'raw_sql': 'with payments as (\r\n\r\n    select\r\n        id as customer_id,\r\n        orderid as order_id,\r\n        status,\r\n        amount,\r\n\r\n    from `dbt-tutorial.stripe.payment\r\n\r\n)\r\n\r\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with payments as (\r\n\r\n    select\r\n        id as customer_id,\r\n        orderid as order_id,\r\n        status,\r\n        amount,\r\n\r\n    from `dbt-tutorial.stripe.payment\r\n\r\n)\r\n\r\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Syntax error: Unclosed identifier literal at [9:10]', 'raw_sql': 'with payments as (\r\n\r\n    select\r\n        id as customer_id,\r\n        orderid as order_id,\r\n        status,\r\n        amount,\r\n\r\n    from `dbt-tutorial.stripe.payment\r\n\r\n)\r\n\r\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with payments as (\r\n\r\n    select\r\n        id as customer_id,\r\n        orderid as order_id,\r\n        status,\r\n        amount,\r\n\r\n    from `dbt-tutorial.stripe.payment\r\n\r\n)\r\n\r\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-06-25 09:20:33.436249 (Thread-96): handling poll request
2021-06-25 09:20:33.436538 (Thread-96): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a48ac0>]}
2021-06-25 09:20:33.437212 (Thread-96): sending response (<Response 12986 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:20:44.197438 (Thread-97): handling status request
2021-06-25 09:20:44.197767 (Thread-97): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a2b8e0>]}
2021-06-25 09:20:44.198345 (Thread-97): sending response (<Response 1600 bytes [200 OK]>) to 10.0.6.80
2021-06-25 09:20:44.459583 (Thread-98): handling run_sql request
2021-06-25 09:20:44.459882 (Thread-98): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a2be80>]}
2021-06-25 09:20:46.248713 (Thread-98): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.250
2021-06-25 09:20:46.259863 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:20:46.270405 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28dc502f-f3a3-4478-99b5-c5860be07a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facec9aaf10>]}
2021-06-25 09:20:46.270662 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:20:46.271079 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:20:46.271191 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:20:46.272342 (Thread-1): finished collecting timing info
2021-06-25 09:20:46.272487 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:20:46.277032 (Thread-1): On rpc.jaffle_shop.request: with payments as (

    select
        id as customer_id,
        orderid as order_id,
        status,
        amount,

    from `dbt-tutorial.stripe.payment`

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:20:46.498541 (Thread-99): handling poll request
2021-06-25 09:20:46.498854 (Thread-99): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab78a8b0>]}
2021-06-25 09:20:46.499820 (Thread-99): sending response (<Response 3270 bytes [200 OK]>) to 10.0.3.5
2021-06-25 09:20:47.929113 (Thread-100): handling poll request
2021-06-25 09:20:47.929414 (Thread-100): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8abd220>]}
2021-06-25 09:20:47.929981 (Thread-100): sending response (<Response 399 bytes [200 OK]>) to 10.0.26.142
2021-06-25 09:20:49.270790 (Thread-101): handling poll request
2021-06-25 09:20:49.271089 (Thread-101): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8abd430>]}
2021-06-25 09:20:49.271604 (Thread-101): sending response (<Response 399 bytes [200 OK]>) to 10.0.21.203
2021-06-25 09:20:49.825995 (Thread-1): finished collecting timing info
2021-06-25 09:20:51.193521 (Thread-102): handling poll request
2021-06-25 09:20:51.193862 (Thread-102): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80da880>]}
2021-06-25 09:20:51.195294 (Thread-102): sending response (<Response 7388 bytes [200 OK]>) to 10.0.21.203
2021-06-25 09:20:56.469311 (Thread-103): handling status request
2021-06-25 09:20:56.469604 (Thread-103): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80c4460>]}
2021-06-25 09:20:56.470217 (Thread-103): sending response (<Response 1600 bytes [200 OK]>) to 10.0.12.250
2021-06-25 09:20:56.778535 (Thread-104): handling run_sql request
2021-06-25 09:20:56.778833 (Thread-104): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80c0820>]}
2021-06-25 09:20:58.563022 (Thread-104): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:20:58.574613 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:20:58.584988 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9a4e083-4840-4eff-9637-dfbc7a0c7018', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe107cbeeb0>]}
2021-06-25 09:20:58.585250 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:20:58.585706 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:20:58.585842 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:20:58.586959 (Thread-1): finished collecting timing info
2021-06-25 09:20:58.587092 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:20:58.591559 (Thread-1): On rpc.jaffle_shop.request: with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:20:58.897267 (Thread-105): handling poll request
2021-06-25 09:20:58.897595 (Thread-105): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6fce50>]}
2021-06-25 09:20:58.898597 (Thread-105): sending response (<Response 3275 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:20:59.899550 (Thread-1): finished collecting timing info
2021-06-25 09:21:00.132889 (Thread-106): handling poll request
2021-06-25 09:21:00.133180 (Thread-106): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6dc940>]}
2021-06-25 09:21:00.134534 (Thread-106): sending response (<Response 7496 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:21:58.004492 (Thread-107): Got an acceptable cached parse result
2021-06-25 09:21:58.043608 (Thread-107): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 09:21:58.158528 (Thread-107): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:21:58.160445 (Thread-107): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b59b80>]}
2021-06-25 09:21:58.479613 (Thread-108): handling status request
2021-06-25 09:21:58.479887 (Thread-108): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b59460>]}
2021-06-25 09:21:58.480418 (Thread-108): sending response (<Response 1602 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:21:58.511949 (Thread-109): handling status request
2021-06-25 09:21:58.512372 (Thread-109): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b598e0>]}
2021-06-25 09:21:58.512970 (Thread-109): sending response (<Response 1602 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:21:58.513470 (Thread-110): handling status request
2021-06-25 09:21:58.513960 (Thread-110): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b59430>]}
2021-06-25 09:21:58.514395 (Thread-110): sending response (<Response 1602 bytes [200 OK]>) to 10.0.31.198
2021-06-25 09:24:09.563013 (MainThread): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-06-25 09:24:09.603405 (Thread-111): Got an acceptable cached parse result
2021-06-25 09:24:09.771146 (Thread-111): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 09:24:09.892398 (Thread-111): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:24:09.892842 (Thread-111): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80d2c10>]}
2021-06-25 09:24:10.167336 (Thread-112): handling status request
2021-06-25 09:24:10.167624 (Thread-112): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80d2d00>]}
2021-06-25 09:24:10.168145 (Thread-112): sending response (<Response 1604 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:24:10.168799 (Thread-113): handling status request
2021-06-25 09:24:10.169383 (Thread-113): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80d2280>]}
2021-06-25 09:24:10.169903 (Thread-113): sending response (<Response 1604 bytes [200 OK]>) to 10.0.6.80
2021-06-25 09:24:10.175378 (Thread-114): handling status request
2021-06-25 09:24:10.175599 (Thread-114): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4ce820>]}
2021-06-25 09:24:10.176006 (Thread-114): sending response (<Response 1604 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:30:21.790151 (Thread-115): handling status request
2021-06-25 09:30:21.791985 (Thread-115): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80d2a00>]}
2021-06-25 09:30:21.792497 (Thread-115): sending response (<Response 1604 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:30:22.267084 (Thread-116): handling run_sql request
2021-06-25 09:30:22.267374 (Thread-116): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80d2280>]}
2021-06-25 09:30:22.268442 (Thread-116): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-06-25 09:30:24.071408 (Thread-116): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.203
2021-06-25 09:30:24.082495 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:30:24.096075 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d69b8ba-95d2-45a2-a3d1-84ed68535218', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3fd47cf40>]}
2021-06-25 09:30:24.096352 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:30:24.096774 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:30:24.096885 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:30:24.098039 (Thread-1): finished collecting timing info
2021-06-25 09:30:24.098169 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:30:24.102722 (Thread-1): On rpc.jaffle_shop.request: with payments as (

    select
        id as customer_id,
        orderid as order_id,
        amount,

    from `dbt-tutorial.stripe.payment`

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:30:24.485230 (Thread-117): handling poll request
2021-06-25 09:30:24.486352 (Thread-117): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6dcc70>]}
2021-06-25 09:30:24.487353 (Thread-117): sending response (<Response 3251 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:30:25.556055 (Thread-1): finished collecting timing info
2021-06-25 09:30:25.853419 (Thread-118): handling poll request
2021-06-25 09:30:25.853736 (Thread-118): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b560d0>]}
2021-06-25 09:30:25.855083 (Thread-118): sending response (<Response 6003 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:30:30.949269 (Thread-119): handling status request
2021-06-25 09:30:30.949563 (Thread-119): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b568e0>]}
2021-06-25 09:30:30.974510 (Thread-119): sending response (<Response 1604 bytes [200 OK]>) to 10.0.47.156
2021-06-25 09:30:31.319091 (Thread-120): handling compile_sql request
2021-06-25 09:30:31.319379 (Thread-120): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b59a90>]}
2021-06-25 09:30:33.077360 (Thread-120): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.22
2021-06-25 09:30:33.088516 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:30:33.098987 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3829cfee-6d06-48f9-88eb-2b9cea2d9211', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf21aafe80>]}
2021-06-25 09:30:33.099262 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:30:33.099659 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:30:33.099768 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:30:33.100858 (Thread-1): finished collecting timing info
2021-06-25 09:30:33.100976 (Thread-1): finished collecting timing info
2021-06-25 09:30:33.352010 (Thread-121): handling poll request
2021-06-25 09:30:33.352337 (Thread-121): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b56ac0>]}
2021-06-25 09:30:33.353571 (Thread-121): sending response (<Response 5393 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:30:38.355997 (Thread-122): Got an acceptable cached parse result
2021-06-25 09:30:38.387642 (Thread-122): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 09:30:38.501560 (Thread-122): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:30:38.502081 (Thread-122): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8131400>]}
2021-06-25 09:30:38.919434 (Thread-123): handling status request
2021-06-25 09:30:38.919723 (Thread-123): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8131850>]}
2021-06-25 09:30:38.920263 (Thread-123): sending response (<Response 1604 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:30:38.975738 (Thread-124): handling status request
2021-06-25 09:30:38.976027 (Thread-124): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8131e20>]}
2021-06-25 09:30:38.976558 (Thread-124): sending response (<Response 1604 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:30:39.052447 (Thread-125): handling status request
2021-06-25 09:30:39.052733 (Thread-125): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5cd9d0>]}
2021-06-25 09:30:39.053244 (Thread-125): sending response (<Response 1604 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:30:45.699178 (Thread-126): handling status request
2021-06-25 09:30:45.699474 (Thread-126): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5cdb50>]}
2021-06-25 09:30:45.699984 (Thread-126): sending response (<Response 1604 bytes [200 OK]>) to 10.0.21.135
2021-06-25 09:30:46.007134 (Thread-127): handling run_sql request
2021-06-25 09:30:46.007440 (Thread-127): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5cd7f0>]}
2021-06-25 09:30:46.008553 (Thread-127): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-06-25 09:30:47.775109 (Thread-127): sending response (<Response 138 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:30:47.786069 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:30:47.798140 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f95ac31-a5e5-4a39-a5f4-29e00d9d8742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18db4bffa0>]}
2021-06-25 09:30:47.798397 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:30:47.798855 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:30:47.798965 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:30:47.801553 (Thread-1): finished collecting timing info
2021-06-25 09:30:47.801711 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:30:47.806278 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        payments.amount

    from orders

    left join payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:30:48.160501 (Thread-128): handling poll request
2021-06-25 09:30:48.160828 (Thread-128): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab551550>]}
2021-06-25 09:30:48.161800 (Thread-128): sending response (<Response 3466 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:30:48.216476 (Thread-1): Unhandled error while running:
--build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        payments.amount

    from orders

    left join payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:30:48.216692 (Thread-1): finished collecting timing info
2021-06-25 09:30:48.216810 (Thread-1): Got an exception: Runtime Error
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/865f7f55-b29a-41aa-a872-beaa01ced20e?maxResults=0&location=US&prettyPrint=false: Not found: Table neat-episode-288515:dbt_mskonberg.stg_payments was not found in location US
  
  (job ID: 865f7f55-b29a-41aa-a872-beaa01ced20e)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/865f7f55-b29a-41aa-a872-beaa01ced20e?maxResults=0&location=US&prettyPrint=false: Not found: Table neat-episode-288515:dbt_mskonberg.stg_payments was not found in location US

(job ID: 865f7f55-b29a-41aa-a872-beaa01ced20e)

                      -----Query Job SQL Follows-----                       

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:--build this as a table
   2:
   3:
   4:
   5:with payments as (
   6:
   7:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
   8:
   9:),
  10:
  11:orders as (
  12:
  13:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  14:
  15:),
  16:
  17:final as (
  18:
  19:    select
  20:        orders.order_id,
  21:        orders.customer_id,
  22:        payments.amount
  23:
  24:    from orders
  25:
  26:    left join payments using (order_id)
  27:
  28:)
  29:
  30:select * from final
  31:limit 500
  32:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 181, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/865f7f55-b29a-41aa-a872-beaa01ced20e?maxResults=0&location=US&prettyPrint=false: Not found: Table neat-episode-288515:dbt_mskonberg.stg_payments was not found in location US
  
  (job ID: 865f7f55-b29a-41aa-a872-beaa01ced20e)
2021-06-25 09:30:48.220198 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/865f7f55-b29a-41aa-a872-beaa01ced20e?maxResults=0&location=US&prettyPrint=false: Not found: Table neat-episode-288515:dbt_mskonberg.stg_payments was not found in location US\n  \n  (job ID: 865f7f55-b29a-41aa-a872-beaa01ced20e)', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith payments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_customers\')}}\r\n\r\n),\r\n\r\nfinal as (\r\n\r\n    select\r\n        orders.order_id,\r\n        orders.customer_id,\r\n        payments.amount\r\n\r\n    from orders\r\n\r\n    left join payments using (order_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '--build this as a table\n\n\n\nwith payments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n\n    from orders\n\n    left join payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/865f7f55-b29a-41aa-a872-beaa01ced20e?maxResults=0&location=US&prettyPrint=false: Not found: Table neat-episode-288515:dbt_mskonberg.stg_payments was not found in location US\n  \n  (job ID: 865f7f55-b29a-41aa-a872-beaa01ced20e)', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith payments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_customers\')}}\r\n\r\n),\r\n\r\nfinal as (\r\n\r\n    select\r\n        orders.order_id,\r\n        orders.customer_id,\r\n        payments.amount\r\n\r\n    from orders\r\n\r\n    left join payments using (order_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '--build this as a table\n\n\n\nwith payments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n\n    from orders\n\n    left join payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-06-25 09:30:49.418529 (Thread-129): handling poll request
2021-06-25 09:30:49.418822 (Thread-129): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab551730>]}
2021-06-25 09:30:49.419514 (Thread-129): sending response (<Response 16509 bytes [200 OK]>) to 10.0.42.69
2021-06-25 09:31:05.245874 (Thread-130): handling status request
2021-06-25 09:31:05.246178 (Thread-130): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab753ca0>]}
2021-06-25 09:31:05.246765 (Thread-130): sending response (<Response 1604 bytes [200 OK]>) to 10.0.21.135
2021-06-25 09:31:05.383505 (Thread-131): handling status request
2021-06-25 09:31:05.383792 (Thread-131): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81317c0>]}
2021-06-25 09:31:05.384311 (Thread-131): sending response (<Response 1604 bytes [200 OK]>) to 10.0.47.156
2021-06-25 09:31:05.714607 (Thread-132): handling cli_args request
2021-06-25 09:31:05.715030 (Thread-132): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8131dc0>]}
2021-06-25 09:31:07.542727 (Thread-132): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:31:07.565908 (MainThread): Partial parsing not enabled
2021-06-25 09:31:07.568407 (MainThread): Parsing macros/adapters.sql
2021-06-25 09:31:07.588730 (MainThread): Parsing macros/etc.sql
2021-06-25 09:31:07.590887 (MainThread): Parsing macros/catalog.sql
2021-06-25 09:31:07.596883 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 09:31:07.601353 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 09:31:07.611009 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 09:31:07.623163 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 09:31:07.625852 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 09:31:07.627675 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 09:31:07.631140 (MainThread): Parsing macros/core.sql
2021-06-25 09:31:07.635009 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 09:31:07.644081 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 09:31:07.657853 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 09:31:07.659668 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 09:31:07.676794 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 09:31:07.707919 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 09:31:07.712882 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 09:31:07.719013 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 09:31:07.739189 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 09:31:07.745629 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 09:31:07.747481 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 09:31:07.753361 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 09:31:07.754999 (MainThread): Parsing macros/etc/query.sql
2021-06-25 09:31:07.756090 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 09:31:07.764722 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 09:31:07.765736 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 09:31:07.767409 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 09:31:07.769358 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 09:31:07.770924 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 09:31:07.773591 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 09:31:07.775502 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 09:31:07.777270 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 09:31:07.826088 (MainThread): Partial parsing not enabled
2021-06-25 09:31:07.859881 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 09:31:07.871910 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 09:31:07.876703 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 09:31:07.881481 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 09:31:07.887866 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 09:31:07.906172 (Thread-133): handling poll request
2021-06-25 09:31:07.906467 (Thread-133): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c8feb0>]}
2021-06-25 09:31:07.907698 (Thread-133): sending response (<Response 11110 bytes [200 OK]>) to 10.0.3.5
2021-06-25 09:31:07.993974 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:31:07.994279 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d7cf497-0003-419a-89c0-e0b3a810be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d5b70a30>]}
2021-06-25 09:31:08.024961 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d7cf497-0003-419a-89c0-e0b3a810be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d5c5ad30>]}
2021-06-25 09:31:08.025389 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:31:08.026116 (MainThread): 
2021-06-25 09:31:08.026405 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 09:31:08.027366 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 09:31:08.027497 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 09:31:08.215201 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 09:31:08.215344 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 09:31:08.495920 (MainThread): 09:31:08 | Concurrency: 1 threads (target='default')
2021-06-25 09:31:08.496048 (MainThread): 09:31:08 | 
2021-06-25 09:31:08.498238 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 09:31:08.498496 (Thread-1): 09:31:08 | 1 of 4 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 09:31:08.498704 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 09:31:08.498780 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 09:31:08.500036 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 09:31:08.521639 (Thread-1): finished collecting timing info
2021-06-25 09:31:08.548462 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 09:31:08.563890 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 09:31:08.568142 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 09:31:09.216716 (Thread-134): handling poll request
2021-06-25 09:31:09.216994 (Thread-134): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6a5910>]}
2021-06-25 09:31:09.217757 (Thread-134): sending response (<Response 8207 bytes [200 OK]>) to 10.0.40.45
2021-06-25 09:31:09.739876 (Thread-1): finished collecting timing info
2021-06-25 09:31:09.740319 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d7cf497-0003-419a-89c0-e0b3a810be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d5becaf0>]}
2021-06-25 09:31:09.740636 (Thread-1): 09:31:09 | 1 of 4 OK created view model dbt_mskonberg.stg_customers............. [OK in 1.24s]
2021-06-25 09:31:09.740713 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 09:31:09.740821 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 09:31:09.741009 (Thread-1): 09:31:09 | 2 of 4 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 09:31:09.741199 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 09:31:09.741268 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 09:31:09.743603 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 09:31:09.762752 (Thread-1): finished collecting timing info
2021-06-25 09:31:09.764885 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 09:31:09.783047 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 09:31:09.787435 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 09:31:10.516132 (Thread-135): handling poll request
2021-06-25 09:31:10.516417 (Thread-135): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5b8d60>]}
2021-06-25 09:31:10.517083 (Thread-135): sending response (<Response 5939 bytes [200 OK]>) to 10.0.31.198
2021-06-25 09:31:10.720591 (Thread-1): finished collecting timing info
2021-06-25 09:31:10.720985 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d7cf497-0003-419a-89c0-e0b3a810be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d5bffc40>]}
2021-06-25 09:31:10.721426 (Thread-1): 09:31:10 | 2 of 4 OK created view model dbt_mskonberg.stg_orders................ [OK in 0.98s]
2021-06-25 09:31:10.721505 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 09:31:10.721606 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 09:31:10.721768 (Thread-1): 09:31:10 | 3 of 4 START view model dbt_mskonberg.stg_payments................... [RUN]
2021-06-25 09:31:10.721992 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 09:31:10.722062 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 09:31:10.723179 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 09:31:10.744056 (Thread-1): finished collecting timing info
2021-06-25 09:31:10.746054 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 09:31:10.764290 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 09:31:10.768663 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
  OPTIONS()
  as with payments as (

    select
        id as customer_id,
        orderid as order_id,
        amount,

    from `dbt-tutorial.stripe.payment`

)

select * from payments;


2021-06-25 09:31:11.774841 (Thread-1): finished collecting timing info
2021-06-25 09:31:11.775225 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d7cf497-0003-419a-89c0-e0b3a810be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d44650a0>]}
2021-06-25 09:31:11.775520 (Thread-1): 09:31:11 | 3 of 4 OK created view model dbt_mskonberg.stg_payments.............. [OK in 1.05s]
2021-06-25 09:31:11.775595 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 09:31:11.775694 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 09:31:11.775829 (Thread-1): 09:31:11 | 4 of 4 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-25 09:31:11.776017 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 09:31:11.776086 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 09:31:11.778985 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 09:31:11.796532 (Thread-1): finished collecting timing info
2021-06-25 09:31:11.810647 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 09:31:11.969998 (Thread-136): handling poll request
2021-06-25 09:31:11.970324 (Thread-136): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5c48b0>]}
2021-06-25 09:31:11.971167 (Thread-136): sending response (<Response 10553 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:31:12.025477 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 09:31:12.046045 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 09:31:13.383633 (Thread-137): handling poll request
2021-06-25 09:31:13.383916 (Thread-137): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7c4520>]}
2021-06-25 09:31:13.384484 (Thread-137): sending response (<Response 2099 bytes [200 OK]>) to 10.0.36.22
2021-06-25 09:31:14.746620 (Thread-138): handling poll request
2021-06-25 09:31:14.746917 (Thread-138): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7c4160>]}
2021-06-25 09:31:14.747521 (Thread-138): sending response (<Response 284 bytes [200 OK]>) to 10.0.24.126
2021-06-25 09:31:15.092602 (Thread-1): finished collecting timing info
2021-06-25 09:31:15.093010 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d7cf497-0003-419a-89c0-e0b3a810be2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9d448c1c0>]}
2021-06-25 09:31:15.093470 (Thread-1): 09:31:15 | 4 of 4 OK created table model dbt_mskonberg.dim_customers............ [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.32s]
2021-06-25 09:31:15.093549 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 09:31:15.094792 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 09:31:15.095055 (MainThread): 09:31:15 | 
2021-06-25 09:31:15.095118 (MainThread): 09:31:15 | Finished running 3 view models, 1 table model in 7.07s.
2021-06-25 09:31:15.095165 (MainThread): Connection 'master' was properly closed.
2021-06-25 09:31:15.095205 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 09:31:15.160551 (MainThread): 
2021-06-25 09:31:15.160701 (MainThread): Completed successfully
2021-06-25 09:31:15.160773 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-25 09:31:16.093600 (Thread-139): handling poll request
2021-06-25 09:31:16.093979 (Thread-139): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7c4760>]}
2021-06-25 09:31:16.095262 (Thread-139): sending response (<Response 15282 bytes [200 OK]>) to 10.0.12.250
2021-06-25 09:31:16.695479 (Thread-140): handling status request
2021-06-25 09:31:16.695805 (Thread-140): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c717f0>]}
2021-06-25 09:31:16.696365 (Thread-140): sending response (<Response 1604 bytes [200 OK]>) to 10.0.21.135
2021-06-25 09:31:16.716197 (Thread-141): handling status request
2021-06-25 09:31:16.716503 (Thread-141): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7c4760>]}
2021-06-25 09:31:16.716988 (Thread-141): sending response (<Response 1604 bytes [200 OK]>) to 10.0.26.142
2021-06-25 09:31:16.777397 (Thread-142): handling status request
2021-06-25 09:31:16.777720 (Thread-142): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c71a60>]}
2021-06-25 09:31:16.778236 (Thread-142): sending response (<Response 1604 bytes [200 OK]>) to 10.0.21.203
2021-06-25 09:31:32.093509 (Thread-143): handling status request
2021-06-25 09:31:32.093861 (Thread-143): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c714f0>]}
2021-06-25 09:31:32.094384 (Thread-143): sending response (<Response 1604 bytes [200 OK]>) to 10.0.24.126
2021-06-25 09:31:32.337162 (Thread-144): handling run_sql request
2021-06-25 09:31:32.337448 (Thread-144): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c710a0>]}
2021-06-25 09:31:34.108401 (Thread-144): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.142
2021-06-25 09:31:34.119570 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:31:34.131515 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1258b680-7ede-4c94-8335-0ba9ef5d6555', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1af0b9ef10>]}
2021-06-25 09:31:34.131789 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:31:34.132208 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:31:34.132297 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:31:34.134840 (Thread-1): finished collecting timing info
2021-06-25 09:31:34.134969 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:31:34.139701 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        payments.amount

    from orders

    left join payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:31:34.420978 (Thread-145): handling poll request
2021-06-25 09:31:34.421296 (Thread-145): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7c4070>]}
2021-06-25 09:31:34.422336 (Thread-145): sending response (<Response 3466 bytes [200 OK]>) to 10.0.36.22
2021-06-25 09:31:34.601947 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/513cffc8-ecde-4bd7-b771-6e0ab93c0164?maxResults=0&location=US&prettyPrint=false: Column order_id in USING clause not found on left side of join at [26:31]')
2021-06-25 09:31:35.716603 (Thread-146): handling poll request
2021-06-25 09:31:35.716886 (Thread-146): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c061c0>]}
2021-06-25 09:31:35.717437 (Thread-146): sending response (<Response 910 bytes [200 OK]>) to 10.0.21.135
2021-06-25 09:31:36.048183 (Thread-1): finished collecting timing info
2021-06-25 09:31:36.048381 (Thread-1): Got an exception: Database Error
  Column order_id in USING clause not found on left side of join at [26:31]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/d9fcaf9d-e2ae-4710-b8f7-91e65b76d809?maxResults=0&location=US&prettyPrint=false: Column order_id in USING clause not found on left side of join at [26:31]

(job ID: d9fcaf9d-e2ae-4710-b8f7-91e65b76d809)

                      -----Query Job SQL Follows-----                       

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:--build this as a table
   2:
   3:
   4:
   5:with payments as (
   6:
   7:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
   8:
   9:),
  10:
  11:orders as (
  12:
  13:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  14:
  15:),
  16:
  17:final as (
  18:
  19:    select
  20:        orders.order_id,
  21:        orders.customer_id,
  22:        payments.amount
  23:
  24:    from orders
  25:
  26:    left join payments using (order_id)
  27:
  28:)
  29:
  30:select * from final
  31:limit 500
  32:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Column order_id in USING clause not found on left side of join at [26:31]
2021-06-25 09:31:36.050848 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Column order_id in USING clause not found on left side of join at [26:31]', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith payments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_customers\')}}\r\n\r\n),\r\n\r\nfinal as (\r\n\r\n    select\r\n        orders.order_id,\r\n        orders.customer_id,\r\n        payments.amount\r\n\r\n    from orders\r\n\r\n    left join payments using (order_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '--build this as a table\n\n\n\nwith payments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n\n    from orders\n\n    left join payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Column order_id in USING clause not found on left side of join at [26:31]', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith payments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_customers\')}}\r\n\r\n),\r\n\r\nfinal as (\r\n\r\n    select\r\n        orders.order_id,\r\n        orders.customer_id,\r\n        payments.amount\r\n\r\n    from orders\r\n\r\n    left join payments using (order_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '--build this as a table\n\n\n\nwith payments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        payments.amount\n\n    from orders\n\n    left join payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-06-25 09:31:37.067498 (Thread-147): handling poll request
2021-06-25 09:31:37.067865 (Thread-147): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5c4a90>]}
2021-06-25 09:31:37.068585 (Thread-147): sending response (<Response 15209 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:34:51.520929 (Thread-148): handling status request
2021-06-25 09:34:51.523045 (Thread-148): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c8fbe0>]}
2021-06-25 09:34:51.523637 (Thread-148): sending response (<Response 1604 bytes [200 OK]>) to 10.0.40.45
2021-06-25 09:34:51.830771 (Thread-149): handling run_sql request
2021-06-25 09:34:51.831079 (Thread-149): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c6e610>]}
2021-06-25 09:34:53.621739 (Thread-149): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:34:53.633076 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:34:53.648125 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3a11a41-10d1-4c2a-83f8-59cb2daf50eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd7950efa0>]}
2021-06-25 09:34:53.648380 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:34:53.648755 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:34:53.648863 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:34:53.651425 (Thread-1): finished collecting timing info
2021-06-25 09:34:53.651567 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:34:53.656135 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

final as (

    select
        orders.order_id,
        orders.customer_id,
        payments.amount

    from orders

    left join payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:34:53.974044 (Thread-150): handling poll request
2021-06-25 09:34:53.974358 (Thread-150): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7c3670>]}
2021-06-25 09:34:53.975269 (Thread-150): sending response (<Response 3463 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:34:55.285734 (Thread-1): finished collecting timing info
2021-06-25 09:34:55.297684 (Thread-151): handling poll request
2021-06-25 09:34:55.297965 (Thread-151): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81d0b50>]}
2021-06-25 09:34:55.298508 (Thread-151): sending response (<Response 801 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:34:56.645927 (Thread-152): handling poll request
2021-06-25 09:34:56.646264 (Thread-152): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81d0c10>]}
2021-06-25 09:34:56.647550 (Thread-152): sending response (<Response 6661 bytes [200 OK]>) to 10.0.3.5
2021-06-25 09:35:03.852105 (Thread-153): handling status request
2021-06-25 09:35:03.852398 (Thread-153): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81dc6d0>]}
2021-06-25 09:35:03.852964 (Thread-153): sending response (<Response 1604 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:35:04.186545 (Thread-154): handling compile_sql request
2021-06-25 09:35:04.186894 (Thread-154): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c6e0a0>]}
2021-06-25 09:35:05.997455 (Thread-154): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:35:06.009260 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:35:06.021462 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76a35b5d-d82b-4a75-88ce-6d4e5773786e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86370e0e80>]}
2021-06-25 09:35:06.021755 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:35:06.022170 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:35:06.022289 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:35:06.024788 (Thread-1): finished collecting timing info
2021-06-25 09:35:06.024902 (Thread-1): finished collecting timing info
2021-06-25 09:35:06.245621 (Thread-155): handling poll request
2021-06-25 09:35:06.245962 (Thread-155): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81d0b80>]}
2021-06-25 09:35:06.247106 (Thread-155): sending response (<Response 6481 bytes [200 OK]>) to 10.0.12.250
2021-06-25 09:35:09.696498 (Thread-156): Got an acceptable cached parse result
2021-06-25 09:35:09.732404 (Thread-156): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 09:35:10.009861 (Thread-156): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:35:10.010413 (Thread-156): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4e4ee0>]}
2021-06-25 09:35:10.189305 (Thread-157): handling status request
2021-06-25 09:35:10.189593 (Thread-157): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4e4940>]}
2021-06-25 09:35:10.190151 (Thread-157): sending response (<Response 1602 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:35:10.249620 (Thread-158): handling status request
2021-06-25 09:35:10.250203 (Thread-158): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4e48b0>]}
2021-06-25 09:35:10.250641 (Thread-159): handling status request
2021-06-25 09:35:10.251210 (Thread-158): sending response (<Response 1602 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:35:10.251506 (Thread-159): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8039520>]}
2021-06-25 09:35:10.252213 (Thread-159): sending response (<Response 1602 bytes [200 OK]>) to 10.0.21.135
2021-06-25 09:41:31.320662 (Thread-160): handling status request
2021-06-25 09:41:31.322437 (Thread-160): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3f9d90>]}
2021-06-25 09:41:31.323007 (Thread-160): sending response (<Response 1602 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:41:31.608059 (Thread-161): handling run_sql request
2021-06-25 09:41:31.608349 (Thread-161): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4e4130>]}
2021-06-25 09:41:31.609759 (Thread-161): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-06-25 09:41:33.410690 (Thread-161): sending response (<Response 138 bytes [200 OK]>) to 10.0.47.156
2021-06-25 09:41:33.421911 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:41:33.435810 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e4c4b2d-e4cc-4b95-a1e6-a6a89ef3d543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4596331f10>]}
2021-06-25 09:41:33.436100 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:41:33.436540 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:41:33.436651 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:41:33.437821 (Thread-1): finished collecting timing info
2021-06-25 09:41:33.437954 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:41:33.442409 (Thread-1): On rpc.jaffle_shop.request: with payments as (

    select
        id as customer_id,
        orderid as order_id,
        amount,

    from `dbt-tutorial.stripe.payment`

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:41:33.764554 (Thread-162): handling poll request
2021-06-25 09:41:33.764879 (Thread-162): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4dc4c0>]}
2021-06-25 09:41:33.765885 (Thread-162): sending response (<Response 3250 bytes [200 OK]>) to 10.0.47.156
2021-06-25 09:41:34.746813 (Thread-1): finished collecting timing info
2021-06-25 09:41:35.162928 (Thread-163): handling poll request
2021-06-25 09:41:35.163229 (Thread-163): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5981f0>]}
2021-06-25 09:41:35.164544 (Thread-163): sending response (<Response 6004 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:46:50.686420 (Thread-164): handling status request
2021-06-25 09:46:50.688231 (Thread-164): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab598490>]}
2021-06-25 09:46:50.688834 (Thread-164): sending response (<Response 1602 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:46:50.990100 (Thread-165): handling run_sql request
2021-06-25 09:46:50.990394 (Thread-165): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab598f40>]}
2021-06-25 09:46:52.808989 (Thread-165): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:46:52.820206 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:46:52.835419 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73175d39-4b02-41a2-9045-725747cd483e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce1d24f10>]}
2021-06-25 09:46:52.835666 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:46:52.836075 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:46:52.836184 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:46:52.838982 (Thread-1): finished collecting timing info
2021-06-25 09:46:52.839102 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:46:52.843621 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
)

customer_orders as (

    select
        orders.customer_id,

        min(orders.order_date) as first_order_date,
        max(orders.order_date) as most_recent_order_date,
        count(orders.order_id) as number_of_orders,
        sum(payments.amount) as lifetime_value

    from orders

    left join payments using (customer_id)

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:46:53.037339 (Thread-166): handling poll request
2021-06-25 09:46:53.037660 (Thread-166): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c8fe50>]}
2021-06-25 09:46:53.038689 (Thread-166): sending response (<Response 4200 bytes [200 OK]>) to 10.0.47.156
2021-06-25 09:46:53.275083 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/b5affee7-2254-42d2-9ff8-209d5e6aba38?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected "(" or "," or keyword SELECT but got identifier "customer_orders" at [22:1]')
2021-06-25 09:46:54.387944 (Thread-167): handling poll request
2021-06-25 09:46:54.388228 (Thread-167): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c8fe20>]}
2021-06-25 09:46:54.388772 (Thread-167): sending response (<Response 943 bytes [200 OK]>) to 10.0.12.250
2021-06-25 09:46:54.583892 (Thread-1): finished collecting timing info
2021-06-25 09:46:54.584079 (Thread-1): Got an exception: Database Error
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "customer_orders" at [22:1]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/95606b3f-c569-4c32-baa8-aa83b6985f24?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected "(" or "," or keyword SELECT but got identifier "customer_orders" at [22:1]

(job ID: 95606b3f-c569-4c32-baa8-aa83b6985f24)

                        -----Query Job SQL Follows-----                        

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:--build this as a table
   2:
   3:
   4:
   5:with customers as (
   6:
   7:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
   8:
   9:),
  10:
  11:orders as (
  12:
  13:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  14:
  15:),
  16:
  17:payments as (
  18:
  19:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
  20:)
  21:
  22:customer_orders as (
  23:
  24:    select
  25:        orders.customer_id,
  26:
  27:        min(orders.order_date) as first_order_date,
  28:        max(orders.order_date) as most_recent_order_date,
  29:        count(orders.order_id) as number_of_orders,
  30:        sum(payments.amount) as lifetime_value
  31:
  32:    from orders
  33:
  34:    left join payments using (customer_id)
  35:
  36:    group by 1
  37:
  38:),
  39:
  40:
  41:final as (
  42:
  43:    select
  44:        customers.customer_id,
  45:        customers.first_name,
  46:        customers.last_name,
  47:        customer_orders.first_order_date,
  48:        customer_orders.most_recent_order_date,
  49:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  50:        coalesce(customer_orders.lifetime_value, 0) as lifetime_value
  51:
  52:    from customers
  53:
  54:    left join customer_orders using (customer_id)
  55:
  56:)
  57:
  58:select * from final
  59:limit 500
  60:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "customer_orders" at [22:1]
2021-06-25 09:46:54.586552 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "customer_orders" at [22:1]', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith customers as (\r\n\r\n    select * from {{ ref(\'stg_customers\')}}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_orders\') }}\r\n\r\n),\r\n\r\npayments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n)\r\n\r\ncustomer_orders as (\r\n\r\n    select\r\n        orders.customer_id,\r\n\r\n        min(orders.order_date) as first_order_date,\r\n        max(orders.order_date) as most_recent_order_date,\r\n        count(orders.order_id) as number_of_orders,\r\n        sum(payments.amount) as lifetime_value\r\n\r\n    from orders\r\n\r\n    left join payments using (customer_id)\r\n\r\n    group by 1\r\n\r\n),\r\n\r\n\r\nfinal as (\r\n\r\n    select\r\n        customers.customer_id,\r\n        customers.first_name,\r\n        customers.last_name,\r\n        customer_orders.first_order_date,\r\n        customer_orders.most_recent_order_date,\r\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\r\n        coalesce(customer_orders.lifetime_value, 0) as lifetime_value\r\n\r\n    from customers\r\n\r\n    left join customer_orders using (customer_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '--build this as a table\n\n\n\nwith customers as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`\n\n),\n\npayments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n)\n\ncustomer_orders as (\n\n    select\n        orders.customer_id,\n\n        min(orders.order_date) as first_order_date,\n        max(orders.order_date) as most_recent_order_date,\n        count(orders.order_id) as number_of_orders,\n        sum(payments.amount) as lifetime_value\n\n    from orders\n\n    left join payments using (customer_id)\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        coalesce(customer_orders.lifetime_value, 0) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "customer_orders" at [22:1]', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith customers as (\r\n\r\n    select * from {{ ref(\'stg_customers\')}}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_orders\') }}\r\n\r\n),\r\n\r\npayments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n)\r\n\r\ncustomer_orders as (\r\n\r\n    select\r\n        orders.customer_id,\r\n\r\n        min(orders.order_date) as first_order_date,\r\n        max(orders.order_date) as most_recent_order_date,\r\n        count(orders.order_id) as number_of_orders,\r\n        sum(payments.amount) as lifetime_value\r\n\r\n    from orders\r\n\r\n    left join payments using (customer_id)\r\n\r\n    group by 1\r\n\r\n),\r\n\r\n\r\nfinal as (\r\n\r\n    select\r\n        customers.customer_id,\r\n        customers.first_name,\r\n        customers.last_name,\r\n        customer_orders.first_order_date,\r\n        customer_orders.most_recent_order_date,\r\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\r\n        coalesce(customer_orders.lifetime_value, 0) as lifetime_value\r\n\r\n    from customers\r\n\r\n    left join customer_orders using (customer_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': '--build this as a table\n\n\n\nwith customers as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`\n\n),\n\npayments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n)\n\ncustomer_orders as (\n\n    select\n        orders.customer_id,\n\n        min(orders.order_date) as first_order_date,\n        max(orders.order_date) as most_recent_order_date,\n        count(orders.order_id) as number_of_orders,\n        sum(payments.amount) as lifetime_value\n\n    from orders\n\n    left join payments using (customer_id)\n\n    group by 1\n\n),\n\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order_date,\n        customer_orders.most_recent_order_date,\n        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,\n        coalesce(customer_orders.lifetime_value, 0) as lifetime_value\n\n    from customers\n\n    left join customer_orders using (customer_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-06-25 09:46:55.807768 (Thread-168): handling poll request
2021-06-25 09:46:55.808077 (Thread-168): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c8f1f0>]}
2021-06-25 09:46:55.808815 (Thread-168): sending response (<Response 21683 bytes [200 OK]>) to 10.0.21.135
2021-06-25 09:47:12.358589 (Thread-169): handling status request
2021-06-25 09:47:12.358871 (Thread-169): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81df940>]}
2021-06-25 09:47:12.359435 (Thread-169): sending response (<Response 1602 bytes [200 OK]>) to 10.0.42.69
2021-06-25 09:47:12.704676 (Thread-170): handling run_sql request
2021-06-25 09:47:12.704970 (Thread-170): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81dfb50>]}
2021-06-25 09:47:14.475207 (Thread-170): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:47:14.486501 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:47:14.498385 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd426c7c-bf63-4636-86b4-c0835119016a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbe543f10>]}
2021-06-25 09:47:14.498620 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:47:14.499002 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:47:14.499106 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:47:14.501862 (Thread-1): finished collecting timing info
2021-06-25 09:47:14.501986 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:47:14.506477 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
),

customer_orders as (

    select
        orders.customer_id,

        min(orders.order_date) as first_order_date,
        max(orders.order_date) as most_recent_order_date,
        count(orders.order_id) as number_of_orders,
        sum(payments.amount) as lifetime_value

    from orders

    left join payments using (customer_id)

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:47:14.726555 (Thread-171): handling poll request
2021-06-25 09:47:14.726864 (Thread-171): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c850a0>]}
2021-06-25 09:47:14.727966 (Thread-171): sending response (<Response 4201 bytes [200 OK]>) to 10.0.31.198
2021-06-25 09:47:16.024580 (Thread-172): handling poll request
2021-06-25 09:47:16.024880 (Thread-172): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c85df0>]}
2021-06-25 09:47:16.025441 (Thread-172): sending response (<Response 396 bytes [200 OK]>) to 10.0.21.203
2021-06-25 09:47:16.922610 (Thread-1): finished collecting timing info
2021-06-25 09:47:17.280299 (Thread-173): handling poll request
2021-06-25 09:47:17.280587 (Thread-173): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7ef370>]}
2021-06-25 09:47:17.282430 (Thread-173): sending response (<Response 13376 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:48:13.734880 (Thread-174): Got an acceptable cached parse result
2021-06-25 09:48:13.769090 (Thread-174): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 09:48:13.882976 (Thread-174): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:48:13.883408 (Thread-174): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b7a880>]}
2021-06-25 09:48:14.263722 (Thread-175): handling status request
2021-06-25 09:48:14.264016 (Thread-175): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80d3c40>]}
2021-06-25 09:48:14.264566 (Thread-175): sending response (<Response 1605 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:48:14.337751 (Thread-176): handling status request
2021-06-25 09:48:14.338047 (Thread-176): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b7a460>]}
2021-06-25 09:48:14.338555 (Thread-176): sending response (<Response 1605 bytes [200 OK]>) to 10.0.31.198
2021-06-25 09:48:14.690271 (Thread-177): handling status request
2021-06-25 09:48:14.690551 (Thread-177): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b7aac0>]}
2021-06-25 09:48:14.691057 (Thread-177): sending response (<Response 1605 bytes [200 OK]>) to 10.0.6.80
2021-06-25 09:50:00.426874 (Thread-178): handling status request
2021-06-25 09:50:00.428673 (Thread-178): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c3c460>]}
2021-06-25 09:50:00.429186 (Thread-178): sending response (<Response 1605 bytes [200 OK]>) to 10.0.10.110
2021-06-25 09:50:00.858890 (Thread-179): handling run_sql request
2021-06-25 09:50:00.859181 (Thread-179): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c3c3a0>]}
2021-06-25 09:50:00.883748 (Thread-179): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 09:50:02.675074 (Thread-179): sending response (<Response 138 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:50:02.687422 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:50:02.700925 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '950f0276-301a-4e3e-a469-5479b3474c18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e3467ffa0>]}
2021-06-25 09:50:02.701230 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:50:02.701721 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:50:02.701833 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:50:02.703074 (Thread-1): finished collecting timing info
2021-06-25 09:50:02.703217 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:50:02.708034 (Thread-1): On rpc.jaffle_shop.request: with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        createdat as created_at

    from `dbt-tutorial.stripe.payment`

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:50:03.108514 (Thread-180): handling poll request
2021-06-25 09:50:03.108820 (Thread-180): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4e4970>]}
2021-06-25 09:50:03.109793 (Thread-180): sending response (<Response 3414 bytes [200 OK]>) to 10.0.21.135
2021-06-25 09:50:03.207898 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/4a4b2830-33c9-46b3-bae6-cb78a69b03d3?maxResults=0&location=US&prettyPrint=false: Unrecognized name: createdat; Did you mean created? at [10:9]')
2021-06-25 09:50:04.206347 (Thread-1): finished collecting timing info
2021-06-25 09:50:04.206540 (Thread-1): Got an exception: Database Error
  Unrecognized name: createdat; Did you mean created? at [10:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/ce5f3fdf-23c0-4cf4-a315-62c6271cd7a8?maxResults=0&location=US&prettyPrint=false: Unrecognized name: createdat; Did you mean created? at [10:9]

(job ID: ce5f3fdf-23c0-4cf4-a315-62c6271cd7a8)

          -----Query Job SQL Follows-----          

    |    .    |    .    |    .    |    .    |
   1:with payments as (
   2:
   3:    select
   4:        id as payment_id,
   5:        orderid as order_id,
   6:        paymentmethod as payment_method,
   7:        status,
   8:        --convert amount from cents to dollars
   9:        amount / 100 as amount,
  10:        createdat as created_at
  11:
  12:    from `dbt-tutorial.stripe.payment`
  13:
  14:)
  15:
  16:select * from payments
  17:limit 500
  18:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: createdat; Did you mean created? at [10:9]
2021-06-25 09:50:04.208934 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: createdat; Did you mean created? at [10:9]', 'raw_sql': 'with payments as (\r\n\r\n    select\r\n        id as payment_id,\r\n        orderid as order_id,\r\n        paymentmethod as payment_method,\r\n        status,\r\n        --convert amount from cents to dollars\r\n        amount / 100 as amount,\r\n        createdat as created_at\r\n\r\n    from `dbt-tutorial.stripe.payment`\r\n\r\n)\r\n\r\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with payments as (\r\n\r\n    select\r\n        id as payment_id,\r\n        orderid as order_id,\r\n        paymentmethod as payment_method,\r\n        status,\r\n        --convert amount from cents to dollars\r\n        amount / 100 as amount,\r\n        createdat as created_at\r\n\r\n    from `dbt-tutorial.stripe.payment`\r\n\r\n)\r\n\r\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: createdat; Did you mean created? at [10:9]', 'raw_sql': 'with payments as (\r\n\r\n    select\r\n        id as payment_id,\r\n        orderid as order_id,\r\n        paymentmethod as payment_method,\r\n        status,\r\n        --convert amount from cents to dollars\r\n        amount / 100 as amount,\r\n        createdat as created_at\r\n\r\n    from `dbt-tutorial.stripe.payment`\r\n\r\n)\r\n\r\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': 'with payments as (\r\n\r\n    select\r\n        id as payment_id,\r\n        orderid as order_id,\r\n        paymentmethod as payment_method,\r\n        status,\r\n        --convert amount from cents to dollars\r\n        amount / 100 as amount,\r\n        createdat as created_at\r\n\r\n    from `dbt-tutorial.stripe.payment`\r\n\r\n)\r\n\r\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-06-25 09:50:04.325984 (Thread-181): handling poll request
2021-06-25 09:50:04.326276 (Thread-181): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b7a880>]}
2021-06-25 09:50:04.326919 (Thread-181): sending response (<Response 10417 bytes [200 OK]>) to 10.0.21.203
2021-06-25 09:50:05.693066 (Thread-182): handling poll request
2021-06-25 09:50:05.693361 (Thread-182): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b7a5b0>]}
2021-06-25 09:50:05.694086 (Thread-182): sending response (<Response 14251 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:50:20.257551 (Thread-183): handling status request
2021-06-25 09:50:20.257892 (Thread-183): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4475b0>]}
2021-06-25 09:50:20.258490 (Thread-183): sending response (<Response 1605 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:50:20.749165 (Thread-184): handling run_sql request
2021-06-25 09:50:20.749463 (Thread-184): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab447490>]}
2021-06-25 09:50:22.523412 (Thread-184): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:50:22.534234 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:50:22.544557 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7de0198d-959b-454d-a43d-b0d6f50a2876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84525fef40>]}
2021-06-25 09:50:22.544810 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:50:22.545209 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:50:22.545311 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:50:22.546397 (Thread-1): finished collecting timing info
2021-06-25 09:50:22.546529 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:50:22.551022 (Thread-1): On rpc.jaffle_shop.request: with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial.stripe.payment`

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:50:22.894192 (Thread-185): handling poll request
2021-06-25 09:50:22.894518 (Thread-185): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9ed30>]}
2021-06-25 09:50:22.895475 (Thread-185): sending response (<Response 3412 bytes [200 OK]>) to 10.0.47.156
2021-06-25 09:50:24.160517 (Thread-186): handling poll request
2021-06-25 09:50:24.160816 (Thread-186): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9e7f0>]}
2021-06-25 09:50:24.161334 (Thread-186): sending response (<Response 399 bytes [200 OK]>) to 10.0.36.22
2021-06-25 09:50:25.490798 (Thread-187): handling poll request
2021-06-25 09:50:25.491082 (Thread-187): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9e280>]}
2021-06-25 09:50:25.491583 (Thread-187): sending response (<Response 399 bytes [200 OK]>) to 10.0.42.69
2021-06-25 09:50:26.409819 (Thread-1): finished collecting timing info
2021-06-25 09:50:26.832184 (Thread-188): handling poll request
2021-06-25 09:50:26.832477 (Thread-188): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a13460>]}
2021-06-25 09:50:26.834107 (Thread-188): sending response (<Response 11209 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:50:31.968460 (Thread-189): handling status request
2021-06-25 09:50:31.968765 (Thread-189): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a138b0>]}
2021-06-25 09:50:31.969326 (Thread-189): sending response (<Response 1605 bytes [200 OK]>) to 10.0.10.110
2021-06-25 09:50:32.255707 (Thread-190): handling compile_sql request
2021-06-25 09:50:32.256012 (Thread-190): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a13400>]}
2021-06-25 09:50:34.005008 (Thread-190): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.2
2021-06-25 09:50:34.015904 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:50:34.026579 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4d87263-6aeb-497e-b68f-b0ff96acb0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a7eb57fd0>]}
2021-06-25 09:50:34.026873 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:50:34.027338 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:50:34.027518 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:50:34.028881 (Thread-1): finished collecting timing info
2021-06-25 09:50:34.029016 (Thread-1): finished collecting timing info
2021-06-25 09:50:34.207230 (Thread-191): handling poll request
2021-06-25 09:50:34.207553 (Thread-191): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a13820>]}
2021-06-25 09:50:34.208765 (Thread-191): sending response (<Response 6037 bytes [200 OK]>) to 10.0.24.126
2021-06-25 09:50:37.194921 (Thread-192): Got an acceptable cached parse result
2021-06-25 09:50:37.227102 (Thread-192): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 09:50:37.340754 (Thread-192): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:50:37.341189 (Thread-192): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80e13a0>]}
2021-06-25 09:50:37.616438 (Thread-193): handling status request
2021-06-25 09:50:37.616723 (Thread-193): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80e1370>]}
2021-06-25 09:50:37.617282 (Thread-193): sending response (<Response 1604 bytes [200 OK]>) to 10.0.6.80
2021-06-25 09:50:37.657624 (Thread-194): handling status request
2021-06-25 09:50:37.657888 (Thread-194): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9e640>]}
2021-06-25 09:50:37.658384 (Thread-194): sending response (<Response 1604 bytes [200 OK]>) to 10.0.10.110
2021-06-25 09:50:37.668935 (Thread-195): handling status request
2021-06-25 09:50:37.669153 (Thread-195): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c3c490>]}
2021-06-25 09:50:37.669616 (Thread-195): sending response (<Response 1604 bytes [200 OK]>) to 10.0.40.72
2021-06-25 09:53:29.841241 (Thread-196): handling status request
2021-06-25 09:53:29.843123 (Thread-196): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c3c220>]}
2021-06-25 09:53:29.843686 (Thread-196): sending response (<Response 1604 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:53:30.129213 (Thread-197): handling run_sql request
2021-06-25 09:53:30.129511 (Thread-197): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9e550>]}
2021-06-25 09:53:30.130691 (Thread-197): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-06-25 09:53:31.891545 (Thread-197): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.5
2021-06-25 09:53:31.902877 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:53:31.917368 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daa2b3f0-1d4f-40f5-b425-9b2c878c6a0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4072d5fa0>]}
2021-06-25 09:53:31.917603 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:53:31.918019 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:53:31.918122 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:53:31.920564 (Thread-1): finished collecting timing info
2021-06-25 09:53:31.920697 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:53:31.925130 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:53:32.180995 (Thread-198): handling poll request
2021-06-25 09:53:32.181374 (Thread-198): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8af4550>]}
2021-06-25 09:53:32.182449 (Thread-198): sending response (<Response 3690 bytes [200 OK]>) to 10.0.42.69
2021-06-25 09:53:32.496279 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/96d910a2-233b-47bd-9471-87b0544ca9dc?maxResults=0&location=US&prettyPrint=false: Unrecognized name: status at [20:23]')
2021-06-25 09:53:33.657701 (Thread-199): handling poll request
2021-06-25 09:53:33.657992 (Thread-199): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab701fa0>]}
2021-06-25 09:53:33.658523 (Thread-199): sending response (<Response 873 bytes [200 OK]>) to 10.0.40.45
2021-06-25 09:53:33.735506 (Thread-1): finished collecting timing info
2021-06-25 09:53:33.735692 (Thread-1): Got an exception: Database Error
  Unrecognized name: status at [20:23]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/1878d5f7-48a0-43e3-9082-842e46c3ddeb?maxResults=0&location=US&prettyPrint=false: Unrecognized name: status at [20:23]

(job ID: 1878d5f7-48a0-43e3-9082-842e46c3ddeb)

                      -----Query Job SQL Follows-----                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:--build this as a table
   2:
   3:
   4:
   5:with payments as (
   6:
   7:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
   8:
   9:),
  10:
  11:orders as (
  12:
  13:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  14:
  15:),
  16:
  17:order_payments as (
  18:    select
  19:        order_id,
  20:        sum(case when status = 'success' then amount end) as amount
  21:
  22:    from payments
  23:    group by 1
  24:),
  25:
  26:final as (
  27:
  28:    select
  29:        orders.order_id,
  30:        orders.customer_id,
  31:        orders.order_date,
  32:        coalesce(order_payments.amount, 0) as amount
  33:
  34:    from orders
  35:
  36:    left join order_payments using (order_id)
  37:
  38:)
  39:
  40:select * from final
  41:limit 500
  42:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: status at [20:23]
2021-06-25 09:53:33.738169 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: status at [20:23]', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith payments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_orders\')}}\r\n\r\n),\r\n\r\norder_payments as (\r\n    select\r\n        order_id,\r\n        sum(case when status = \'success\' then amount end) as amount\r\n\r\n    from payments\r\n    group by 1\r\n),\r\n\r\nfinal as (\r\n\r\n    select\r\n        orders.order_id,\r\n        orders.customer_id,\r\n        orders.order_date,\r\n        coalesce(order_payments.amount, 0) as amount\r\n\r\n    from orders\r\n\r\n    left join order_payments using (order_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': "--build this as a table\n\n\n\nwith payments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`\n\n),\n\norder_payments as (\n    select\n        order_id,\n        sum(case when status = 'success' then amount end) as amount\n\n    from payments\n    group by 1\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        coalesce(order_payments.amount, 0) as amount\n\n    from orders\n\n    left join order_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: status at [20:23]', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith payments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_orders\')}}\r\n\r\n),\r\n\r\norder_payments as (\r\n    select\r\n        order_id,\r\n        sum(case when status = \'success\' then amount end) as amount\r\n\r\n    from payments\r\n    group by 1\r\n),\r\n\r\nfinal as (\r\n\r\n    select\r\n        orders.order_id,\r\n        orders.customer_id,\r\n        orders.order_date,\r\n        coalesce(order_payments.amount, 0) as amount\r\n\r\n    from orders\r\n\r\n    left join order_payments using (order_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': "--build this as a table\n\n\n\nwith payments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`\n\n),\n\norder_payments as (\n    select\n        order_id,\n        sum(case when status = 'success' then amount end) as amount\n\n    from payments\n    group by 1\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        coalesce(order_payments.amount, 0) as amount\n\n    from orders\n\n    left join order_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2021-06-25 09:53:34.907019 (Thread-200): handling poll request
2021-06-25 09:53:34.907348 (Thread-200): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c3c2e0>]}
2021-06-25 09:53:34.908061 (Thread-200): sending response (<Response 16923 bytes [200 OK]>) to 10.0.26.142
2021-06-25 09:54:41.464493 (Thread-201): handling status request
2021-06-25 09:54:41.466564 (Thread-201): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80e1460>]}
2021-06-25 09:54:41.467126 (Thread-201): sending response (<Response 1604 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:54:41.732301 (Thread-202): handling run_sql request
2021-06-25 09:54:41.732588 (Thread-202): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80e1cd0>]}
2021-06-25 09:54:43.529687 (Thread-202): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.198
2021-06-25 09:54:43.540607 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:54:43.553799 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '918ad3d4-c56a-4a20-bc0a-dbe7e7520c7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe903191ee0>]}
2021-06-25 09:54:43.554056 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:54:43.554444 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:54:43.554553 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:54:43.555714 (Thread-1): finished collecting timing info
2021-06-25 09:54:43.555856 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:54:43.560351 (Thread-1): On rpc.jaffle_shop.request: with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial.stripe.payment`

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:54:43.864255 (Thread-203): handling poll request
2021-06-25 09:54:43.864578 (Thread-203): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8af47c0>]}
2021-06-25 09:54:43.865554 (Thread-203): sending response (<Response 3412 bytes [200 OK]>) to 10.0.36.19
2021-06-25 09:54:44.820994 (Thread-1): finished collecting timing info
2021-06-25 09:54:45.143218 (Thread-204): handling poll request
2021-06-25 09:54:45.143563 (Thread-204): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81d5fd0>]}
2021-06-25 09:54:45.145113 (Thread-204): sending response (<Response 11210 bytes [200 OK]>) to 10.0.21.135
2021-06-25 09:55:03.182009 (Thread-205): handling status request
2021-06-25 09:55:03.182299 (Thread-205): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81d5e50>]}
2021-06-25 09:55:03.182843 (Thread-205): sending response (<Response 1604 bytes [200 OK]>) to 10.0.3.5
2021-06-25 09:55:03.405551 (Thread-206): handling run_sql request
2021-06-25 09:55:03.405872 (Thread-206): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81d5880>]}
2021-06-25 09:55:05.188287 (Thread-206): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.80
2021-06-25 09:55:05.199440 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:55:05.211222 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '512fb548-a04c-4c42-9e89-e1e3b6cd0b76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3f5e14f40>]}
2021-06-25 09:55:05.211452 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:55:05.211829 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:55:05.211931 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:55:05.214433 (Thread-1): finished collecting timing info
2021-06-25 09:55:05.214553 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:55:05.218954 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:55:05.512129 (Thread-207): handling poll request
2021-06-25 09:55:05.512451 (Thread-207): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81d5bb0>]}
2021-06-25 09:55:05.513377 (Thread-207): sending response (<Response 3690 bytes [200 OK]>) to 10.0.42.69
2021-06-25 09:55:05.724716 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/7a8ee7a3-eb54-4d7c-8a50-e930ee0289da?maxResults=0&location=US&prettyPrint=false: Unrecognized name: status at [20:23]')
2021-06-25 09:55:06.752256 (Thread-1): finished collecting timing info
2021-06-25 09:55:06.752455 (Thread-1): Got an exception: Database Error
  Unrecognized name: status at [20:23]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/856110a3-2fe5-4e62-9e0f-d6369f269bc9?maxResults=0&location=US&prettyPrint=false: Unrecognized name: status at [20:23]

(job ID: 856110a3-2fe5-4e62-9e0f-d6369f269bc9)

                      -----Query Job SQL Follows-----                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:--build this as a table
   2:
   3:
   4:
   5:with payments as (
   6:
   7:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
   8:
   9:),
  10:
  11:orders as (
  12:
  13:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  14:
  15:),
  16:
  17:order_payments as (
  18:    select
  19:        order_id,
  20:        sum(case when status = 'success' then amount end) as amount
  21:
  22:    from payments
  23:    group by 1
  24:),
  25:
  26:final as (
  27:
  28:    select
  29:        orders.order_id,
  30:        orders.customer_id,
  31:        orders.order_date,
  32:        coalesce(order_payments.amount, 0) as amount
  33:
  34:    from orders
  35:
  36:    left join order_payments using (order_id)
  37:
  38:)
  39:
  40:select * from final
  41:limit 500
  42:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: status at [20:23]
2021-06-25 09:55:06.754902 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: status at [20:23]', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith payments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_orders\')}}\r\n\r\n),\r\n\r\norder_payments as (\r\n    select\r\n        order_id,\r\n        sum(case when status = \'success\' then amount end) as amount\r\n\r\n    from payments\r\n    group by 1\r\n),\r\n\r\nfinal as (\r\n\r\n    select\r\n        orders.order_id,\r\n        orders.customer_id,\r\n        orders.order_date,\r\n        coalesce(order_payments.amount, 0) as amount\r\n\r\n    from orders\r\n\r\n    left join order_payments using (order_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': "--build this as a table\n\n\n\nwith payments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`\n\n),\n\norder_payments as (\n    select\n        order_id,\n        sum(case when status = 'success' then amount end) as amount\n\n    from payments\n    group by 1\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        coalesce(order_payments.amount, 0) as amount\n\n    from orders\n\n    left join order_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: status at [20:23]', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith payments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_orders\')}}\r\n\r\n),\r\n\r\norder_payments as (\r\n    select\r\n        order_id,\r\n        sum(case when status = \'success\' then amount end) as amount\r\n\r\n    from payments\r\n    group by 1\r\n),\r\n\r\nfinal as (\r\n\r\n    select\r\n        orders.order_id,\r\n        orders.customer_id,\r\n        orders.order_date,\r\n        coalesce(order_payments.amount, 0) as amount\r\n\r\n    from orders\r\n\r\n    left join order_payments using (order_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': "--build this as a table\n\n\n\nwith payments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`\n\n),\n\norder_payments as (\n    select\n        order_id,\n        sum(case when status = 'success' then amount end) as amount\n\n    from payments\n    group by 1\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        coalesce(order_payments.amount, 0) as amount\n\n    from orders\n\n    left join order_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2021-06-25 09:55:06.779946 (Thread-208): handling poll request
2021-06-25 09:55:06.780268 (Thread-208): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a98c40>]}
2021-06-25 09:55:06.780958 (Thread-208): sending response (<Response 12197 bytes [200 OK]>) to 10.0.10.110
2021-06-25 09:55:08.111322 (Thread-209): handling poll request
2021-06-25 09:55:08.111613 (Thread-209): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a10fd0>]}
2021-06-25 09:55:08.134837 (Thread-209): sending response (<Response 16923 bytes [200 OK]>) to 10.0.45.5
2021-06-25 09:55:28.006102 (Thread-210): Got an acceptable cached parse result
2021-06-25 09:55:28.147929 (Thread-210): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 09:55:28.148403 (Thread-210): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5471f0>]}
2021-06-25 09:55:28.500184 (Thread-211): handling status request
2021-06-25 09:55:28.500473 (Thread-211): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8090430>]}
2021-06-25 09:55:28.501016 (Thread-211): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:55:28.579390 (Thread-212): handling status request
2021-06-25 09:55:28.579945 (Thread-212): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab327790>]}
2021-06-25 09:55:28.580475 (Thread-212): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.45
2021-06-25 09:55:28.580948 (Thread-213): handling status request
2021-06-25 09:55:28.581499 (Thread-213): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab65c400>]}
2021-06-25 09:55:28.581999 (Thread-213): sending response (<Response 1303 bytes [200 OK]>) to 10.0.10.110
2021-06-25 09:55:39.200267 (Thread-214): handling status request
2021-06-25 09:55:39.200634 (Thread-214): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f3d820>]}
2021-06-25 09:55:39.201284 (Thread-214): sending response (<Response 1303 bytes [200 OK]>) to 10.0.10.110
2021-06-25 09:55:39.457756 (Thread-215): handling run_sql request
2021-06-25 09:55:39.458055 (Thread-215): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab65c640>]}
2021-06-25 09:55:41.250018 (Thread-215): sending response (<Response 138 bytes [200 OK]>) to 10.0.47.156
2021-06-25 09:55:41.261224 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:55:41.273205 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0577ae17-2b7a-4e28-bb40-4e35411ea294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e4db8cf70>]}
2021-06-25 09:55:41.273458 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 09:55:41.273900 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 09:55:41.274009 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 09:55:41.276504 (Thread-1): finished collecting timing info
2021-06-25 09:55:41.276630 (Thread-1): Opening a new connection, currently in state init
2021-06-25 09:55:41.281074 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 09:55:41.541615 (Thread-216): handling poll request
2021-06-25 09:55:41.541965 (Thread-216): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab57e250>]}
2021-06-25 09:55:41.545398 (Thread-216): sending response (<Response 3690 bytes [200 OK]>) to 10.0.26.142
2021-06-25 09:55:41.845027 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/b6d706ad-06c3-4d30-955e-58f8986830d0?maxResults=0&location=US&prettyPrint=false: Unrecognized name: status at [20:23]')
2021-06-25 09:55:42.810219 (Thread-217): handling poll request
2021-06-25 09:55:42.810499 (Thread-217): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3e5610>]}
2021-06-25 09:55:42.811042 (Thread-217): sending response (<Response 873 bytes [200 OK]>) to 10.0.26.7
2021-06-25 09:55:43.211885 (Thread-1): finished collecting timing info
2021-06-25 09:55:43.212076 (Thread-1): Got an exception: Database Error
  Unrecognized name: status at [20:23]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/d79cd62d-8eb8-4713-97d7-b3fcd2be96fb?maxResults=0&location=US&prettyPrint=false: Unrecognized name: status at [20:23]

(job ID: d79cd62d-8eb8-4713-97d7-b3fcd2be96fb)

                      -----Query Job SQL Follows-----                      

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:--build this as a table
   2:
   3:
   4:
   5:with payments as (
   6:
   7:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
   8:
   9:),
  10:
  11:orders as (
  12:
  13:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  14:
  15:),
  16:
  17:order_payments as (
  18:    select
  19:        order_id,
  20:        sum(case when status = 'success' then amount end) as amount
  21:
  22:    from payments
  23:    group by 1
  24:),
  25:
  26:final as (
  27:
  28:    select
  29:        orders.order_id,
  30:        orders.customer_id,
  31:        orders.order_date,
  32:        coalesce(order_payments.amount, 0) as amount
  33:
  34:    from orders
  35:
  36:    left join order_payments using (order_id)
  37:
  38:)
  39:
  40:select * from final
  41:limit 500
  42:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Unrecognized name: status at [20:23]
2021-06-25 09:55:43.214562 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: status at [20:23]', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith payments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_orders\')}}\r\n\r\n),\r\n\r\norder_payments as (\r\n    select\r\n        order_id,\r\n        sum(case when status = \'success\' then amount end) as amount\r\n\r\n    from payments\r\n    group by 1\r\n),\r\n\r\nfinal as (\r\n\r\n    select\r\n        orders.order_id,\r\n        orders.customer_id,\r\n        orders.order_date,\r\n        coalesce(order_payments.amount, 0) as amount\r\n\r\n    from orders\r\n\r\n    left join order_payments using (order_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': "--build this as a table\n\n\n\nwith payments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`\n\n),\n\norder_payments as (\n    select\n        order_id,\n        sum(case when status = 'success' then amount end) as amount\n\n    from payments\n    group by 1\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        coalesce(order_payments.amount, 0) as amount\n\n    from orders\n\n    left join order_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Unrecognized name: status at [20:23]', 'raw_sql': '--build this as a table\r\n\r\n{{ config (\r\n    materialized="table"\r\n)}}\r\n\r\nwith payments as (\r\n\r\n    select * from {{ ref(\'stg_payments\') }}\r\n\r\n),\r\n\r\norders as (\r\n\r\n    select * from {{ ref(\'stg_orders\')}}\r\n\r\n),\r\n\r\norder_payments as (\r\n    select\r\n        order_id,\r\n        sum(case when status = \'success\' then amount end) as amount\r\n\r\n    from payments\r\n    group by 1\r\n),\r\n\r\nfinal as (\r\n\r\n    select\r\n        orders.order_id,\r\n        orders.customer_id,\r\n        orders.order_date,\r\n        coalesce(order_payments.amount, 0) as amount\r\n\r\n    from orders\r\n\r\n    left join order_payments using (order_id)\r\n\r\n)\r\n\r\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_sql': "--build this as a table\n\n\n\nwith payments as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`\n\n),\n\norders as (\n\n    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`\n\n),\n\norder_payments as (\n    select\n        order_id,\n        sum(case when status = 'success' then amount end) as amount\n\n    from payments\n    group by 1\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        coalesce(order_payments.amount, 0) as amount\n\n    from orders\n\n    left join order_payments using (order_id)\n\n)\n\nselect * from final\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2021-06-25 09:55:44.074769 (Thread-218): handling poll request
2021-06-25 09:55:44.075063 (Thread-218): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab57e550>]}
2021-06-25 09:55:44.075716 (Thread-218): sending response (<Response 16923 bytes [200 OK]>) to 10.0.45.5
2021-06-25 10:00:41.590071 (Thread-219): Got an acceptable cached parse result
2021-06-25 10:00:41.627893 (Thread-219): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:00:41.890658 (Thread-219): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:00:41.891095 (Thread-219): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab25d670>]}
2021-06-25 10:00:42.213530 (Thread-220): handling status request
2021-06-25 10:00:42.213855 (Thread-220): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3eab50>]}
2021-06-25 10:00:42.214415 (Thread-220): sending response (<Response 1602 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:00:42.250030 (Thread-221): handling status request
2021-06-25 10:00:42.250320 (Thread-221): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab25d670>]}
2021-06-25 10:00:42.250852 (Thread-221): sending response (<Response 1602 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:00:42.289980 (Thread-222): handling status request
2021-06-25 10:00:42.290249 (Thread-222): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab25d190>]}
2021-06-25 10:00:42.290755 (Thread-222): sending response (<Response 1602 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:00:47.550486 (Thread-223): handling status request
2021-06-25 10:00:47.551244 (Thread-224): handling status request
2021-06-25 10:00:47.551546 (Thread-223): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab1989d0>]}
2021-06-25 10:00:47.551789 (Thread-224): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab24d580>]}
2021-06-25 10:00:47.552343 (Thread-223): sending response (<Response 1602 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:00:47.552847 (Thread-224): sending response (<Response 1602 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:00:47.828818 (Thread-225): handling cli_args request
2021-06-25 10:00:47.829104 (Thread-225): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab24d490>]}
2021-06-25 10:00:47.838610 (Thread-225): Connection 'model.jaffle_shop.fct_orders' was properly closed.
2021-06-25 10:00:49.612182 (Thread-225): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:00:49.647352 (MainThread): Partial parsing not enabled
2021-06-25 10:00:49.650091 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:00:49.670641 (MainThread): Parsing macros/etc.sql
2021-06-25 10:00:49.672743 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:00:49.678860 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:00:49.683342 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:00:49.694157 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:00:49.714807 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:00:49.719069 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:00:49.720919 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:00:49.724380 (MainThread): Parsing macros/core.sql
2021-06-25 10:00:49.728206 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:00:49.737173 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:00:49.752647 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:00:49.754526 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:00:49.771953 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:00:49.814313 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:00:49.819364 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:00:49.825563 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:00:49.850460 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:00:49.856998 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:00:49.858886 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:00:49.864784 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:00:49.866457 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:00:49.867549 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:00:49.876336 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:00:49.877313 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:00:49.879010 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:00:49.880979 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:00:49.882559 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:00:49.885196 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:00:49.887135 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:00:49.888889 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:00:49.936061 (Thread-226): handling poll request
2021-06-25 10:00:49.936391 (Thread-226): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4a6b50>]}
2021-06-25 10:00:49.937629 (Thread-226): sending response (<Response 9375 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:00:49.938326 (MainThread): Partial parsing not enabled
2021-06-25 10:00:49.971520 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:00:49.982693 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:00:49.989051 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:00:49.993877 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:00:50.000616 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:00:50.112181 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:00:50.112468 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e73f7c6d-4b59-44a1-a0d3-576e284682b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e29adf40>]}
2021-06-25 10:00:50.148868 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e73f7c6d-4b59-44a1-a0d3-576e284682b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e29d6070>]}
2021-06-25 10:00:50.149114 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:00:50.149782 (MainThread): 
2021-06-25 10:00:50.150060 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:00:50.151070 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 10:00:50.151202 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 10:00:50.334472 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:00:50.334611 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 10:00:50.583051 (MainThread): 10:00:50 | Concurrency: 1 threads (target='default')
2021-06-25 10:00:50.583178 (MainThread): 10:00:50 | 
2021-06-25 10:00:50.585331 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 10:00:50.585598 (Thread-1): 10:00:50 | 1 of 5 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 10:00:50.585836 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:00:50.585916 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 10:00:50.587145 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 10:00:50.603734 (Thread-1): finished collecting timing info
2021-06-25 10:00:50.630031 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 10:00:50.647447 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:00:50.652013 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 10:00:51.269033 (Thread-227): handling poll request
2021-06-25 10:00:51.269332 (Thread-227): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab25d130>]}
2021-06-25 10:00:51.270182 (Thread-227): sending response (<Response 9962 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:00:51.610633 (Thread-1): finished collecting timing info
2021-06-25 10:00:51.611008 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73f7c6d-4b59-44a1-a0d3-576e284682b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e29f5790>]}
2021-06-25 10:00:51.611296 (Thread-1): 10:00:51 | 1 of 5 OK created view model dbt_mskonberg.stg_orders................ [OK in 1.03s]
2021-06-25 10:00:51.611369 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 10:00:51.611469 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 10:00:51.611602 (Thread-1): 10:00:51 | 2 of 5 START view model dbt_mskonberg.stg_payments................... [RUN]
2021-06-25 10:00:51.611785 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:00:51.611853 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 10:00:51.613897 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 10:00:51.632481 (Thread-1): finished collecting timing info
2021-06-25 10:00:51.634207 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 10:00:51.649850 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:00:51.654096 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
  OPTIONS()
  as with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial.stripe.payment`

)

select * from payments;


2021-06-25 10:00:52.600359 (Thread-1): finished collecting timing info
2021-06-25 10:00:52.600763 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73f7c6d-4b59-44a1-a0d3-576e284682b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e28cf0d0>]}
2021-06-25 10:00:52.601056 (Thread-1): 10:00:52 | 2 of 5 OK created view model dbt_mskonberg.stg_payments.............. [OK in 0.99s]
2021-06-25 10:00:52.601128 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 10:00:52.601228 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 10:00:52.601361 (Thread-1): 10:00:52 | 3 of 5 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 10:00:52.601553 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:00:52.601622 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 10:00:52.602713 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 10:00:52.621590 (Thread-1): finished collecting timing info
2021-06-25 10:00:52.623449 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 10:00:52.640398 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:00:52.644450 (Thread-228): handling poll request
2021-06-25 10:00:52.644698 (Thread-228): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4a8d30>]}
2021-06-25 10:00:52.645512 (Thread-228): sending response (<Response 11024 bytes [200 OK]>) to 10.0.47.156
2021-06-25 10:00:52.644673 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 10:00:53.778245 (Thread-1): finished collecting timing info
2021-06-25 10:00:53.778627 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73f7c6d-4b59-44a1-a0d3-576e284682b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e29f5790>]}
2021-06-25 10:00:53.778920 (Thread-1): 10:00:53 | 3 of 5 OK created view model dbt_mskonberg.stg_customers............. [OK in 1.18s]
2021-06-25 10:00:53.778995 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 10:00:53.779091 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 10:00:53.779228 (Thread-1): 10:00:53 | 4 of 5 START table model dbt_mskonberg.fct_orders.................... [RUN]
2021-06-25 10:00:53.779424 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:00:53.779494 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 10:00:53.782493 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 10:00:53.793499 (Thread-1): finished collecting timing info
2021-06-25 10:00:53.817927 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 10:00:53.828652 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:00:53.833039 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`
  
  
  OPTIONS()
  as (
    --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
    
2021-06-25 10:00:53.958707 (Thread-229): handling poll request
2021-06-25 10:00:53.958981 (Thread-229): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4a84c0>]}
2021-06-25 10:00:53.959702 (Thread-229): sending response (<Response 7244 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:00:55.233945 (Thread-230): handling poll request
2021-06-25 10:00:55.234240 (Thread-230): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab48c070>]}
2021-06-25 10:00:55.234765 (Thread-230): sending response (<Response 285 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:00:56.499554 (Thread-231): handling poll request
2021-06-25 10:00:56.499850 (Thread-231): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab48cb20>]}
2021-06-25 10:00:56.500357 (Thread-231): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.19
2021-06-25 10:00:56.871503 (Thread-1): finished collecting timing info
2021-06-25 10:00:56.871909 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73f7c6d-4b59-44a1-a0d3-576e284682b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e01efc70>]}
2021-06-25 10:00:56.872230 (Thread-1): 10:00:56 | 4 of 5 OK created table model dbt_mskonberg.fct_orders............... [CREATE TABLE (99.0 rows, 5.2 KB processed) in 3.09s]
2021-06-25 10:00:56.872316 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 10:00:56.872419 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 10:00:56.872564 (Thread-1): 10:00:56 | 5 of 5 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-25 10:00:56.873225 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:00:56.873324 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 10:00:56.876324 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 10:00:56.896165 (Thread-1): finished collecting timing info
2021-06-25 10:00:56.897924 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:00:57.069586 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 10:00:57.087607 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
),

customer_orders as (

    select
        orders.customer_id,

        min(orders.order_date) as first_order_date,
        max(orders.order_date) as most_recent_order_date,
        count(orders.order_id) as number_of_orders,
        sum(payments.amount) as lifetime_value

    from orders

    left join payments using (customer_id)

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 10:00:57.788064 (Thread-232): handling poll request
2021-06-25 10:00:57.788346 (Thread-232): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab48c580>]}
2021-06-25 10:00:57.789044 (Thread-232): sending response (<Response 7082 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:00:57.851148 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/7856483f-878d-4947-a7e9-1d5d98c2be57?maxResults=0&location=US&prettyPrint=false: Column customer_id in USING clause not found on right side of join at [42:31]')
2021-06-25 10:00:59.040750 (Thread-233): handling poll request
2021-06-25 10:00:59.041038 (Thread-233): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab48c730>]}
2021-06-25 10:00:59.041581 (Thread-233): sending response (<Response 854 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:00:59.574223 (Thread-1): finished collecting timing info
2021-06-25 10:00:59.574602 (Thread-1): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  Column customer_id in USING clause not found on right side of join at [42:31]
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/0ae9609b-6cc1-4ed9-836c-8eb1a83f5ff8?maxResults=0&location=US&prettyPrint=false: Column customer_id in USING clause not found on right side of join at [42:31]

(job ID: 0ae9609b-6cc1-4ed9-836c-8eb1a83f5ff8)

                                                         -----Query Job SQL Follows-----                                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */
   2:
   3:
   4:  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    --build this as a table
  10:
  11:
  12:
  13:with customers as (
  14:
  15:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  16:
  17:),
  18:
  19:orders as (
  20:
  21:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  22:
  23:),
  24:
  25:payments as (
  26:
  27:    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
  28:),
  29:
  30:customer_orders as (
  31:
  32:    select
  33:        orders.customer_id,
  34:
  35:        min(orders.order_date) as first_order_date,
  36:        max(orders.order_date) as most_recent_order_date,
  37:        count(orders.order_id) as number_of_orders,
  38:        sum(payments.amount) as lifetime_value
  39:
  40:    from orders
  41:
  42:    left join payments using (customer_id)
  43:
  44:    group by 1
  45:
  46:),
  47:
  48:
  49:final as (
  50:
  51:    select
  52:        customers.customer_id,
  53:        customers.first_name,
  54:        customers.last_name,
  55:        customer_orders.first_order_date,
  56:        customer_orders.most_recent_order_date,
  57:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
  58:        coalesce(customer_orders.lifetime_value, 0) as lifetime_value
  59:
  60:    from customers
  61:
  62:    left join customer_orders using (customer_id)
  63:
  64:)
  65:
  66:select * from final
  67:  );
  68:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models/marts/core/dim_customers.sql)
  Column customer_id in USING clause not found on right side of join at [42:31]
  compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-06-25 10:00:59.577618 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e73f7c6d-4b59-44a1-a0d3-576e284682b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e0189280>]}
2021-06-25 10:00:59.577961 (Thread-1): 10:00:59 | 5 of 5 ERROR creating table model dbt_mskonberg.dim_customers........ [ERROR in 2.70s]
2021-06-25 10:00:59.578038 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 10:00:59.579521 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:00:59.579800 (MainThread): 10:00:59 | 
2021-06-25 10:00:59.579865 (MainThread): 10:00:59 | Finished running 3 view models, 2 table models in 9.43s.
2021-06-25 10:00:59.579913 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:00:59.579953 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 10:00:59.641113 (MainThread): 
2021-06-25 10:00:59.641234 (MainThread): Completed with 1 error and 0 warnings:
2021-06-25 10:00:59.641291 (MainThread): 
2021-06-25 10:00:59.641346 (MainThread): Database Error in model dim_customers (models/marts/core/dim_customers.sql)
2021-06-25 10:00:59.641390 (MainThread):   Column customer_id in USING clause not found on right side of join at [42:31]
2021-06-25 10:00:59.641429 (MainThread):   compiled SQL at target/run/jaffle_shop/models/marts/core/dim_customers.sql
2021-06-25 10:00:59.641484 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-06-25 10:01:00.309742 (Thread-234): handling poll request
2021-06-25 10:01:00.310037 (Thread-234): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab24d2e0>]}
2021-06-25 10:01:00.311510 (Thread-234): sending response (<Response 31087 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:01:00.888495 (Thread-235): handling status request
2021-06-25 10:01:00.888784 (Thread-235): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab24d2e0>]}
2021-06-25 10:01:00.889362 (Thread-235): sending response (<Response 1602 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:01:00.925337 (Thread-236): handling status request
2021-06-25 10:01:00.925578 (Thread-236): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab49e0a0>]}
2021-06-25 10:01:00.926087 (Thread-236): sending response (<Response 1602 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:01:00.969065 (Thread-237): handling status request
2021-06-25 10:01:00.969286 (Thread-237): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5477c0>]}
2021-06-25 10:01:00.969777 (Thread-237): sending response (<Response 1602 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:01:18.779345 (Thread-238): handling status request
2021-06-25 10:01:18.779634 (Thread-238): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab547c40>]}
2021-06-25 10:01:18.780135 (Thread-238): sending response (<Response 1602 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:01:18.991804 (Thread-239): handling run_sql request
2021-06-25 10:01:18.992085 (Thread-239): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5475b0>]}
2021-06-25 10:01:20.833504 (Thread-239): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:01:20.844921 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 10:01:20.856892 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3ce8bf4-31d6-4389-950c-98e10cca920b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faca9cdffa0>]}
2021-06-25 10:01:20.857146 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:01:20.857549 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 10:01:20.857655 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 10:01:20.860510 (Thread-1): finished collecting timing info
2021-06-25 10:01:20.860640 (Thread-1): Opening a new connection, currently in state init
2021-06-25 10:01:20.865757 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 10:01:21.114462 (Thread-240): handling poll request
2021-06-25 10:01:21.114779 (Thread-240): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2fb4c0>]}
2021-06-25 10:01:21.115691 (Thread-240): sending response (<Response 3698 bytes [200 OK]>) to 10.0.36.19
2021-06-25 10:01:22.444498 (Thread-241): handling poll request
2021-06-25 10:01:22.444802 (Thread-241): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3164c0>]}
2021-06-25 10:01:22.445321 (Thread-241): sending response (<Response 393 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:01:22.887483 (Thread-1): finished collecting timing info
2021-06-25 10:01:23.725347 (Thread-242): handling poll request
2021-06-25 10:01:23.725630 (Thread-242): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4ed0a0>]}
2021-06-25 10:01:23.727062 (Thread-242): sending response (<Response 8781 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:02:31.862159 (Thread-243): handling status request
2021-06-25 10:02:31.862463 (Thread-243): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6c8250>]}
2021-06-25 10:02:31.863030 (Thread-243): sending response (<Response 1602 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:02:32.161798 (Thread-244): handling run_sql request
2021-06-25 10:02:32.162087 (Thread-244): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f31d60>]}
2021-06-25 10:02:33.933151 (Thread-244): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:02:33.944382 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 10:02:33.960279 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d888fdb-696d-4b26-b5a3-38c43a60519f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f152810bee0>]}
2021-06-25 10:02:33.960531 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:02:33.960924 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 10:02:33.961029 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 10:02:33.963570 (Thread-1): finished collecting timing info
2021-06-25 10:02:33.963695 (Thread-1): Opening a new connection, currently in state init
2021-06-25 10:02:33.968282 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders
    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        customer_orders.lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 10:02:34.271736 (Thread-245): handling poll request
2021-06-25 10:02:34.272115 (Thread-245): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80f1e20>]}
2021-06-25 10:02:34.273089 (Thread-245): sending response (<Response 3994 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:02:35.586087 (Thread-246): handling poll request
2021-06-25 10:02:35.586361 (Thread-246): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f661c0>]}
2021-06-25 10:02:35.586879 (Thread-246): sending response (<Response 396 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:02:36.095209 (Thread-1): finished collecting timing info
2021-06-25 10:02:36.868844 (Thread-247): handling poll request
2021-06-25 10:02:36.869164 (Thread-247): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f66250>]}
2021-06-25 10:02:36.870656 (Thread-247): sending response (<Response 12404 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:03:13.486612 (Thread-248): handling status request
2021-06-25 10:03:13.486893 (Thread-248): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8164d30>]}
2021-06-25 10:03:13.487428 (Thread-248): sending response (<Response 1602 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:03:13.846341 (Thread-249): handling run_sql request
2021-06-25 10:03:13.846638 (Thread-249): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8164fa0>]}
2021-06-25 10:03:15.622128 (Thread-249): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:03:15.632682 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 10:03:15.644419 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a3f4e16-139c-4bfb-a822-f49074b1088b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c0d521f10>]}
2021-06-25 10:03:15.644648 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:03:15.645042 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 10:03:15.645145 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 10:03:15.647640 (Thread-1): finished collecting timing info
2021-06-25 10:03:15.647760 (Thread-1): Opening a new connection, currently in state init
2021-06-25 10:03:15.652125 (Thread-1): On rpc.jaffle_shop.request: --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders
    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 10:03:15.864239 (Thread-250): handling poll request
2021-06-25 10:03:15.864562 (Thread-250): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f667f0>]}
2021-06-25 10:03:15.865525 (Thread-250): sending response (<Response 4025 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:03:17.186885 (Thread-251): handling poll request
2021-06-25 10:03:17.187172 (Thread-251): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f66820>]}
2021-06-25 10:03:17.187707 (Thread-251): sending response (<Response 395 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:03:17.767478 (Thread-1): finished collecting timing info
2021-06-25 10:03:18.503794 (Thread-252): handling poll request
2021-06-25 10:03:18.504100 (Thread-252): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80900d0>]}
2021-06-25 10:03:18.505761 (Thread-252): sending response (<Response 12490 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:03:23.208830 (Thread-253): handling status request
2021-06-25 10:03:23.209125 (Thread-253): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8090df0>]}
2021-06-25 10:03:23.209746 (Thread-253): sending response (<Response 1602 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:03:23.428462 (Thread-254): handling compile_sql request
2021-06-25 10:03:23.428783 (Thread-254): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80906a0>]}
2021-06-25 10:03:25.199569 (Thread-254): sending response (<Response 138 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:03:25.210951 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 10:03:25.222997 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24476ec5-1da7-498b-b9a8-6dbc43d05e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb67d01bfd0>]}
2021-06-25 10:03:25.223235 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:03:25.223646 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 10:03:25.223752 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 10:03:25.226291 (Thread-1): finished collecting timing info
2021-06-25 10:03:25.226411 (Thread-1): finished collecting timing info
2021-06-25 10:03:25.469993 (Thread-255): handling poll request
2021-06-25 10:03:25.470306 (Thread-255): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b1d250>]}
2021-06-25 10:03:25.471517 (Thread-255): sending response (<Response 8769 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:03:28.239001 (Thread-256): Got an acceptable cached parse result
2021-06-25 10:03:28.273130 (Thread-256): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:03:28.386684 (Thread-256): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:03:28.387428 (Thread-256): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a40220>]}
2021-06-25 10:03:28.741700 (Thread-257): handling status request
2021-06-25 10:03:28.741996 (Thread-257): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5d0790>]}
2021-06-25 10:03:28.742544 (Thread-257): sending response (<Response 1605 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:03:28.769849 (Thread-258): handling status request
2021-06-25 10:03:28.770080 (Thread-258): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5d0cd0>]}
2021-06-25 10:03:28.770597 (Thread-258): sending response (<Response 1605 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:03:28.907549 (Thread-259): handling status request
2021-06-25 10:03:28.907914 (Thread-259): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a6c460>]}
2021-06-25 10:03:28.908440 (Thread-259): sending response (<Response 1605 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:03:32.475111 (Thread-260): handling status request
2021-06-25 10:03:32.475392 (Thread-260): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a6c490>]}
2021-06-25 10:03:32.475899 (Thread-260): sending response (<Response 1605 bytes [200 OK]>) to 10.0.26.7
2021-06-25 10:03:32.587046 (Thread-261): handling status request
2021-06-25 10:03:32.587341 (Thread-261): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a6c940>]}
2021-06-25 10:03:32.587851 (Thread-261): sending response (<Response 1605 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:03:32.793282 (Thread-262): handling cli_args request
2021-06-25 10:03:32.793571 (Thread-262): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a6c790>]}
2021-06-25 10:03:32.803741 (Thread-262): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 10:03:34.602472 (Thread-262): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:03:34.637468 (MainThread): Partial parsing not enabled
2021-06-25 10:03:34.640180 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:03:34.663494 (MainThread): Parsing macros/etc.sql
2021-06-25 10:03:34.665680 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:03:34.671810 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:03:34.676295 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:03:34.686186 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:03:34.698434 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:03:34.701154 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:03:34.703006 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:03:34.706471 (MainThread): Parsing macros/core.sql
2021-06-25 10:03:34.710383 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:03:34.719537 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:03:34.733466 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:03:34.735325 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:03:34.755385 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:03:34.787082 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:03:34.792216 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:03:34.798584 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:03:34.819279 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:03:34.825935 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:03:34.827827 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:03:34.833828 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:03:34.835488 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:03:34.836599 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:03:34.847661 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:03:34.848717 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:03:34.850454 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:03:34.852489 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:03:34.854075 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:03:34.856770 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:03:34.858926 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:03:34.860781 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:03:34.905852 (Thread-263): handling poll request
2021-06-25 10:03:34.906236 (Thread-263): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a0dc40>]}
2021-06-25 10:03:34.907531 (Thread-263): sending response (<Response 9375 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:03:34.910822 (MainThread): Partial parsing not enabled
2021-06-25 10:03:34.945075 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:03:34.956431 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:03:34.960912 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:03:34.965620 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:03:34.971909 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:03:35.080204 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:03:35.080514 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94503745-0ba0-4802-9d50-e40d753abc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188cf82ee0>]}
2021-06-25 10:03:35.113489 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94503745-0ba0-4802-9d50-e40d753abc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188cf9cac0>]}
2021-06-25 10:03:35.113831 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:03:35.114573 (MainThread): 
2021-06-25 10:03:35.114851 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:03:35.115995 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 10:03:35.116137 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 10:03:35.312017 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:03:35.312157 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 10:03:35.508439 (MainThread): 10:03:35 | Concurrency: 1 threads (target='default')
2021-06-25 10:03:35.508568 (MainThread): 10:03:35 | 
2021-06-25 10:03:35.510758 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 10:03:35.511020 (Thread-1): 10:03:35 | 1 of 5 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 10:03:35.511276 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:03:35.511392 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 10:03:35.512639 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 10:03:35.528427 (Thread-1): finished collecting timing info
2021-06-25 10:03:35.555649 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 10:03:35.571576 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:03:35.575877 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 10:03:36.231519 (Thread-264): handling poll request
2021-06-25 10:03:36.231820 (Thread-264): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8148a90>]}
2021-06-25 10:03:36.232610 (Thread-264): sending response (<Response 9962 bytes [200 OK]>) to 10.0.45.5
2021-06-25 10:03:36.440736 (Thread-1): finished collecting timing info
2021-06-25 10:03:36.441108 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94503745-0ba0-4802-9d50-e40d753abc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188cf7f850>]}
2021-06-25 10:03:36.441396 (Thread-1): 10:03:36 | 1 of 5 OK created view model dbt_mskonberg.stg_orders................ [OK in 0.93s]
2021-06-25 10:03:36.441470 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 10:03:36.441570 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 10:03:36.441729 (Thread-1): 10:03:36 | 2 of 5 START view model dbt_mskonberg.stg_payments................... [RUN]
2021-06-25 10:03:36.441916 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:03:36.441984 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 10:03:36.444003 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 10:03:36.459578 (Thread-1): finished collecting timing info
2021-06-25 10:03:36.461478 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 10:03:36.479134 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:03:36.483480 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
  OPTIONS()
  as with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial.stripe.payment`

)

select * from payments;


2021-06-25 10:03:37.319658 (Thread-1): finished collecting timing info
2021-06-25 10:03:37.320037 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94503745-0ba0-4802-9d50-e40d753abc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188ce9c580>]}
2021-06-25 10:03:37.320489 (Thread-1): 10:03:37 | 2 of 5 OK created view model dbt_mskonberg.stg_payments.............. [OK in 0.88s]
2021-06-25 10:03:37.320566 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 10:03:37.320668 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 10:03:37.320810 (Thread-1): 10:03:37 | 3 of 5 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 10:03:37.321016 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:03:37.321093 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 10:03:37.322252 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 10:03:37.338449 (Thread-1): finished collecting timing info
2021-06-25 10:03:37.340547 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 10:03:37.359588 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:03:37.367697 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 10:03:37.452168 (Thread-265): handling poll request
2021-06-25 10:03:37.452468 (Thread-265): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8148820>]}
2021-06-25 10:03:37.453694 (Thread-265): sending response (<Response 11815 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:03:38.262228 (Thread-1): finished collecting timing info
2021-06-25 10:03:38.262616 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94503745-0ba0-4802-9d50-e40d753abc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188cf7f850>]}
2021-06-25 10:03:38.262906 (Thread-1): 10:03:38 | 3 of 5 OK created view model dbt_mskonberg.stg_customers............. [OK in 0.94s]
2021-06-25 10:03:38.262985 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 10:03:38.263113 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 10:03:38.263270 (Thread-1): 10:03:38 | 4 of 5 START table model dbt_mskonberg.fct_orders.................... [RUN]
2021-06-25 10:03:38.263475 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:03:38.263546 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 10:03:38.266485 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 10:03:38.282541 (Thread-1): finished collecting timing info
2021-06-25 10:03:38.296319 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:03:38.475563 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 10:03:38.493926 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`
  
  
  OPTIONS()
  as (
    --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
    
2021-06-25 10:03:38.782510 (Thread-266): handling poll request
2021-06-25 10:03:38.782799 (Thread-266): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a6cb50>]}
2021-06-25 10:03:38.783500 (Thread-266): sending response (<Response 6453 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:03:40.048557 (Thread-267): handling poll request
2021-06-25 10:03:40.048949 (Thread-267): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a402e0>]}
2021-06-25 10:03:40.049718 (Thread-267): sending response (<Response 285 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:03:41.353772 (Thread-268): handling poll request
2021-06-25 10:03:41.354066 (Thread-268): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a40910>]}
2021-06-25 10:03:41.354687 (Thread-268): sending response (<Response 285 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:03:41.563006 (Thread-1): finished collecting timing info
2021-06-25 10:03:41.563402 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94503745-0ba0-4802-9d50-e40d753abc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188c1e3af0>]}
2021-06-25 10:03:41.563701 (Thread-1): 10:03:41 | 4 of 5 OK created table model dbt_mskonberg.fct_orders............... [CREATE TABLE (99.0 rows, 5.2 KB processed) in 3.30s]
2021-06-25 10:03:41.563775 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 10:03:41.564707 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 10:03:41.564937 (Thread-1): 10:03:41 | 5 of 5 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-25 10:03:41.565169 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:03:41.565301 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 10:03:41.568603 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 10:03:41.587119 (Thread-1): finished collecting timing info
2021-06-25 10:03:41.588516 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:03:41.752899 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 10:03:41.776724 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders
    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 10:03:42.592812 (Thread-269): handling poll request
2021-06-25 10:03:42.593096 (Thread-269): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5dc370>]}
2021-06-25 10:03:42.617102 (Thread-269): sending response (<Response 6864 bytes [200 OK]>) to 10.0.47.156
2021-06-25 10:03:43.914519 (Thread-270): handling poll request
2021-06-25 10:03:43.914815 (Thread-270): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5dcb80>]}
2021-06-25 10:03:43.915338 (Thread-270): sending response (<Response 285 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:03:44.458459 (Thread-1): finished collecting timing info
2021-06-25 10:03:44.458850 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94503745-0ba0-4802-9d50-e40d753abc06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f188ce47dc0>]}
2021-06-25 10:03:44.459298 (Thread-1): 10:03:44 | 5 of 5 OK created table model dbt_mskonberg.dim_customers............ [CREATE TABLE (100.0 rows, 5.0 KB processed) in 2.89s]
2021-06-25 10:03:44.459379 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 10:03:44.460556 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:03:44.460837 (MainThread): 10:03:44 | 
2021-06-25 10:03:44.460903 (MainThread): 10:03:44 | Finished running 3 view models, 2 table models in 9.35s.
2021-06-25 10:03:44.460951 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:03:44.460991 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 10:03:44.521468 (MainThread): 
2021-06-25 10:03:44.521590 (MainThread): Completed successfully
2021-06-25 10:03:44.521659 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-06-25 10:03:45.272725 (Thread-271): handling poll request
2021-06-25 10:03:45.273035 (Thread-271): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c74340>]}
2021-06-25 10:03:45.274433 (Thread-271): sending response (<Response 19188 bytes [200 OK]>) to 10.0.45.5
2021-06-25 10:03:45.894583 (Thread-272): handling status request
2021-06-25 10:03:45.894932 (Thread-272): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c749a0>]}
2021-06-25 10:03:45.895483 (Thread-272): sending response (<Response 1605 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:03:45.950590 (Thread-273): handling status request
2021-06-25 10:03:45.950884 (Thread-273): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5dc2b0>]}
2021-06-25 10:03:45.951360 (Thread-273): sending response (<Response 1605 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:03:46.001510 (Thread-274): handling status request
2021-06-25 10:03:46.001794 (Thread-274): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c742e0>]}
2021-06-25 10:03:46.002305 (Thread-274): sending response (<Response 1605 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:31:38.160176 (Thread-275): Got an acceptable cached parse result
2021-06-25 10:31:38.312484 (Thread-275): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:31:38.313097 (Thread-275): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2e4d30>]}
2021-06-25 10:31:38.611524 (Thread-276): handling status request
2021-06-25 10:31:38.611790 (Thread-276): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2e4250>]}
2021-06-25 10:31:38.612284 (Thread-276): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:31:38.619765 (Thread-277): handling status request
2021-06-25 10:31:38.619997 (Thread-277): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c52eb0>]}
2021-06-25 10:31:38.620387 (Thread-277): sending response (<Response 1303 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:31:38.689640 (Thread-278): handling status request
2021-06-25 10:31:38.689961 (Thread-278): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2e4ee0>]}
2021-06-25 10:31:38.690458 (Thread-278): sending response (<Response 1303 bytes [200 OK]>) to 10.0.36.19
2021-06-25 10:33:36.793829 (Thread-279): handling status request
2021-06-25 10:33:36.795832 (Thread-279): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2e4c40>]}
2021-06-25 10:33:36.796374 (Thread-279): sending response (<Response 1303 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:33:36.844233 (Thread-280): handling status request
2021-06-25 10:33:36.844579 (Thread-280): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2e45b0>]}
2021-06-25 10:33:36.845245 (Thread-280): sending response (<Response 1303 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:33:37.018322 (Thread-281): handling cli_args request
2021-06-25 10:33:37.018613 (Thread-281): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2a4250>]}
2021-06-25 10:33:38.832026 (Thread-281): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.7
2021-06-25 10:33:38.868471 (MainThread): Partial parsing not enabled
2021-06-25 10:33:38.870935 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:33:38.891396 (MainThread): Parsing macros/etc.sql
2021-06-25 10:33:38.893586 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:33:38.899738 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:33:38.904254 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:33:38.913931 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:33:38.926060 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:33:38.928720 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:33:38.930587 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:33:38.934100 (MainThread): Parsing macros/core.sql
2021-06-25 10:33:38.937915 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:33:38.946817 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:33:38.960694 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:33:38.962525 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:33:38.979669 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:33:39.010479 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:33:39.015460 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:33:39.021890 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:33:39.042613 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:33:39.049275 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:33:39.051218 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:33:39.057266 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:33:39.058948 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:33:39.060054 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:33:39.069026 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:33:39.070231 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:33:39.071930 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:33:39.073989 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:33:39.075578 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:33:39.078344 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:33:39.080268 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:33:39.082114 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:33:39.092777 (Thread-282): handling poll request
2021-06-25 10:33:39.093047 (Thread-282): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab18e9a0>]}
2021-06-25 10:33:39.094345 (Thread-282): sending response (<Response 9391 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:33:39.132949 (MainThread): Partial parsing not enabled
2021-06-25 10:33:39.169267 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:33:39.180618 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:33:39.185270 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:33:39.190033 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:33:39.197311 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:33:39.308708 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:33:39.308982 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3e62995-4392-420b-bd2b-ef8329f1dc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f946a5be0>]}
2021-06-25 10:33:39.339458 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3e62995-4392-420b-bd2b-ef8329f1dc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f9470d2e0>]}
2021-06-25 10:33:39.339713 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:33:39.340240 (MainThread): 
2021-06-25 10:33:39.340488 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:33:39.341271 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 10:33:39.341399 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 10:33:39.538694 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:33:39.538862 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 10:33:39.716498 (MainThread): 10:33:39 | Concurrency: 1 threads (target='default')
2021-06-25 10:33:39.716634 (MainThread): 10:33:39 | 
2021-06-25 10:33:39.730535 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 10:33:39.730806 (Thread-1): 10:33:39 | 1 of 1 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 10:33:39.731044 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:33:39.731121 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 10:33:39.732349 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 10:33:39.757090 (Thread-1): finished collecting timing info
2021-06-25 10:33:39.784126 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 10:33:39.807841 (Thread-1): Opening a new connection, currently in state init
2021-06-25 10:33:39.812312 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 10:33:40.418279 (Thread-283): handling poll request
2021-06-25 10:33:40.418570 (Thread-283): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0e73d0>]}
2021-06-25 10:33:40.419381 (Thread-283): sending response (<Response 10017 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:33:40.822149 (Thread-1): finished collecting timing info
2021-06-25 10:33:40.822529 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e62995-4392-420b-bd2b-ef8329f1dc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f945fd880>]}
2021-06-25 10:33:40.822819 (Thread-1): 10:33:40 | 1 of 1 OK created view model dbt_mskonberg.stg_customers............. [OK in 1.09s]
2021-06-25 10:33:40.822896 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 10:33:40.824154 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:33:40.824462 (MainThread): 10:33:40 | 
2021-06-25 10:33:40.824532 (MainThread): 10:33:40 | Finished running 1 view model in 1.48s.
2021-06-25 10:33:40.824581 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:33:40.824621 (MainThread): Connection 'list_neat-episode-288515_dbt_mskonberg' was properly closed.
2021-06-25 10:33:40.824657 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-06-25 10:33:40.902742 (MainThread): 
2021-06-25 10:33:40.902883 (MainThread): Completed successfully
2021-06-25 10:33:40.902949 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-25 10:33:41.645721 (Thread-284): handling poll request
2021-06-25 10:33:41.646013 (Thread-284): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0bbb50>]}
2021-06-25 10:33:41.649275 (Thread-284): sending response (<Response 7313 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:33:42.182331 (Thread-285): handling status request
2021-06-25 10:33:42.182634 (Thread-285): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4a6c70>]}
2021-06-25 10:33:42.183219 (Thread-285): sending response (<Response 1303 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:33:42.258581 (Thread-286): handling status request
2021-06-25 10:33:42.258870 (Thread-286): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4a6a30>]}
2021-06-25 10:33:42.259379 (Thread-286): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:33:42.265265 (Thread-287): handling status request
2021-06-25 10:33:42.265487 (Thread-287): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a409d0>]}
2021-06-25 10:33:42.265985 (Thread-287): sending response (<Response 1303 bytes [200 OK]>) to 10.0.47.156
2021-06-25 10:33:55.256450 (Thread-288): Got an acceptable cached parse result
2021-06-25 10:33:55.664764 (Thread-289): handling status request
2021-06-25 10:33:55.665073 (Thread-289): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab04bd60>]}
2021-06-25 10:33:55.665581 (Thread-289): sending response (<Response 1158 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:33:55.687989 (Thread-290): handling status request
2021-06-25 10:33:55.688244 (Thread-290): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab15aa30>]}
2021-06-25 10:33:55.688701 (Thread-290): sending response (<Response 1158 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:33:55.721109 (Thread-291): handling status request
2021-06-25 10:33:55.721371 (Thread-291): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab04bc10>]}
2021-06-25 10:33:55.721863 (Thread-291): sending response (<Response 1158 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:34:22.783208 (Thread-292): Got an acceptable cached parse result
2021-06-25 10:34:23.460716 (Thread-293): handling status request
2021-06-25 10:34:23.461011 (Thread-293): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab413430>]}
2021-06-25 10:34:23.461516 (Thread-293): sending response (<Response 1039 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:34:23.531257 (Thread-294): handling status request
2021-06-25 10:34:23.531523 (Thread-294): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab413a90>]}
2021-06-25 10:34:23.531992 (Thread-294): sending response (<Response 1039 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:34:23.550719 (Thread-295): handling status request
2021-06-25 10:34:23.550906 (Thread-295): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4130a0>]}
2021-06-25 10:34:23.551291 (Thread-295): sending response (<Response 1039 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:35:05.000338 (Thread-296): handling status request
2021-06-25 10:35:05.000633 (Thread-296): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab413760>]}
2021-06-25 10:35:05.001110 (Thread-296): sending response (<Response 1039 bytes [200 OK]>) to 10.0.45.5
2021-06-25 10:35:05.093857 (Thread-297): handling status request
2021-06-25 10:35:05.094146 (Thread-297): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab413610>]}
2021-06-25 10:35:05.094650 (Thread-297): sending response (<Response 1039 bytes [200 OK]>) to 10.0.40.72
2021-06-25 10:35:05.257244 (Thread-298): handling cli_args request
2021-06-25 10:35:05.257537 (Thread-298): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4135b0>]}
2021-06-25 10:35:05.257956 (Thread-298): sending response (<Response 1503 bytes [200 OK]>) to 10.0.40.72
2021-06-25 10:35:26.208897 (Thread-299): handling status request
2021-06-25 10:35:26.209176 (Thread-299): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4137f0>]}
2021-06-25 10:35:26.209660 (Thread-299): sending response (<Response 1039 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:35:26.261125 (Thread-300): handling status request
2021-06-25 10:35:26.261901 (Thread-301): handling status request
2021-06-25 10:35:26.262242 (Thread-300): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4138b0>]}
2021-06-25 10:35:26.262444 (Thread-301): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab339af0>]}
2021-06-25 10:35:26.262942 (Thread-300): sending response (<Response 1039 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:35:26.285373 (Thread-301): sending response (<Response 1039 bytes [200 OK]>) to 10.0.26.7
2021-06-25 10:35:54.585814 (Thread-302): Got an acceptable cached parse result
2021-06-25 10:35:55.026064 (Thread-303): handling status request
2021-06-25 10:35:55.026361 (Thread-303): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a33ca0>]}
2021-06-25 10:35:55.026861 (Thread-303): sending response (<Response 1035 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:35:55.066873 (Thread-304): handling status request
2021-06-25 10:35:55.067787 (Thread-305): handling status request
2021-06-25 10:35:55.068092 (Thread-304): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a33d00>]}
2021-06-25 10:35:55.068319 (Thread-305): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b556a0>]}
2021-06-25 10:35:55.068828 (Thread-304): sending response (<Response 1035 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:35:55.069308 (Thread-305): sending response (<Response 1035 bytes [200 OK]>) to 10.0.36.19
2021-06-25 10:37:46.930205 (Thread-306): Got an acceptable cached parse result
2021-06-25 10:37:47.293883 (Thread-307): handling status request
2021-06-25 10:37:47.294168 (Thread-307): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f22430>]}
2021-06-25 10:37:47.294650 (Thread-307): sending response (<Response 1035 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:37:47.363004 (Thread-308): handling status request
2021-06-25 10:37:47.363263 (Thread-308): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f22700>]}
2021-06-25 10:37:47.363726 (Thread-308): sending response (<Response 1035 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:37:47.402459 (Thread-309): handling status request
2021-06-25 10:37:47.402727 (Thread-309): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f22b80>]}
2021-06-25 10:37:47.403183 (Thread-309): sending response (<Response 1035 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:38:21.727779 (Thread-310): Got an acceptable cached parse result
2021-06-25 10:38:22.170415 (Thread-311): handling status request
2021-06-25 10:38:22.170724 (Thread-311): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab574f10>]}
2021-06-25 10:38:22.171318 (Thread-311): sending response (<Response 1034 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:38:22.329477 (Thread-312): handling status request
2021-06-25 10:38:22.329791 (Thread-312): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab574dc0>]}
2021-06-25 10:38:22.330280 (Thread-312): sending response (<Response 1034 bytes [200 OK]>) to 10.0.40.72
2021-06-25 10:38:22.467728 (Thread-313): handling status request
2021-06-25 10:38:22.468019 (Thread-313): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b058e0>]}
2021-06-25 10:38:22.468523 (Thread-313): sending response (<Response 1034 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:38:54.176051 (Thread-314): Got an acceptable cached parse result
2021-06-25 10:38:54.330006 (Thread-314): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:38:54.330498 (Thread-314): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab054310>]}
2021-06-25 10:38:54.748786 (Thread-315): handling status request
2021-06-25 10:38:54.749250 (Thread-315): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab26fe80>]}
2021-06-25 10:38:54.749981 (Thread-315): sending response (<Response 1303 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:38:54.779584 (Thread-316): handling status request
2021-06-25 10:38:54.779957 (Thread-316): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab26f760>]}
2021-06-25 10:38:54.780645 (Thread-316): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.7
2021-06-25 10:38:54.844323 (Thread-317): handling status request
2021-06-25 10:38:54.844612 (Thread-317): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab054310>]}
2021-06-25 10:38:54.845104 (Thread-317): sending response (<Response 1303 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:39:40.501314 (Thread-318): handling status request
2021-06-25 10:39:40.501605 (Thread-318): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0543a0>]}
2021-06-25 10:39:40.502141 (Thread-318): sending response (<Response 1303 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:39:40.566377 (Thread-319): handling status request
2021-06-25 10:39:40.566672 (Thread-319): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6f4c40>]}
2021-06-25 10:39:40.567145 (Thread-319): sending response (<Response 1303 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:39:40.788930 (Thread-320): handling cli_args request
2021-06-25 10:39:40.789201 (Thread-320): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab23e850>]}
2021-06-25 10:39:42.579773 (Thread-320): sending response (<Response 138 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:39:42.615082 (MainThread): Partial parsing not enabled
2021-06-25 10:39:42.617448 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:39:42.637556 (MainThread): Parsing macros/etc.sql
2021-06-25 10:39:42.639744 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:39:42.645886 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:39:42.650370 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:39:42.660167 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:39:42.672139 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:39:42.674840 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:39:42.676699 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:39:42.680194 (MainThread): Parsing macros/core.sql
2021-06-25 10:39:42.684032 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:39:42.692918 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:39:42.706684 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:39:42.708506 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:39:42.726014 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:39:42.757258 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:39:42.762214 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:39:42.768397 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:39:42.788785 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:39:42.795290 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:39:42.797206 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:39:42.803160 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:39:42.804801 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:39:42.805921 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:39:42.814733 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:39:42.815724 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:39:42.817407 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:39:42.819422 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:39:42.820984 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:39:42.823657 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:39:42.825655 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:39:42.827448 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:39:42.884262 (Thread-321): handling poll request
2021-06-25 10:39:42.878682 (MainThread): Partial parsing not enabled
2021-06-25 10:39:42.884907 (Thread-321): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb811f640>]}
2021-06-25 10:39:42.886240 (Thread-321): sending response (<Response 9637 bytes [200 OK]>) to 10.0.40.72
2021-06-25 10:39:42.918736 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:39:42.929993 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:39:42.934800 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:39:42.940095 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:39:42.947256 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:39:43.075166 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:39:43.075552 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d54c1ad-3afc-447d-9850-cc413a8feba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61ecc5220>]}
2021-06-25 10:39:43.119110 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d54c1ad-3afc-447d-9850-cc413a8feba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61ed82700>]}
2021-06-25 10:39:43.119403 (MainThread): Found 5 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:39:43.120126 (MainThread): 
2021-06-25 10:39:43.120399 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:39:43.121698 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:39:43.121808 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 10:39:43.335145 (MainThread): 10:39:43 | Concurrency: 1 threads (target='default')
2021-06-25 10:39:43.335274 (MainThread): 10:39:43 | 
2021-06-25 10:39:43.337330 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 10:39:43.337496 (Thread-1): 10:39:43 | 1 of 2 START test not_null_stg_customers_customer_id................. [RUN]
2021-06-25 10:39:43.337747 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-06-25 10:39:43.337836 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 10:39:43.348558 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-06-25 10:39:43.375038 (Thread-1): finished collecting timing info
2021-06-25 10:39:43.375244 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:39:43.379539 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
where customer_id is null



2021-06-25 10:39:44.167364 (Thread-322): handling poll request
2021-06-25 10:39:44.167670 (Thread-322): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab1f8130>]}
2021-06-25 10:39:44.168458 (Thread-322): sending response (<Response 8984 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:39:45.506427 (Thread-323): handling poll request
2021-06-25 10:39:45.509110 (Thread-323): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab1dbfd0>]}
2021-06-25 10:39:45.509629 (Thread-323): sending response (<Response 286 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:39:46.264484 (Thread-1): finished collecting timing info
2021-06-25 10:39:46.264909 (Thread-1): 10:39:46 | 1 of 2 PASS not_null_stg_customers_customer_id....................... [PASS in 2.93s]
2021-06-25 10:39:46.264998 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 10:39:46.265105 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 10:39:46.265199 (Thread-1): 10:39:46 | 2 of 2 START test unique_stg_customers_customer_id................... [RUN]
2021-06-25 10:39:46.265748 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-06-25 10:39:46.265848 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 10:39:46.272324 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-06-25 10:39:46.285510 (Thread-1): finished collecting timing info
2021-06-25 10:39:46.285688 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:39:46.290080 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-06-25 10:39:46.839015 (Thread-324): handling poll request
2021-06-25 10:39:46.839310 (Thread-324): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab20ad30>]}
2021-06-25 10:39:46.840022 (Thread-324): sending response (<Response 5540 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:39:47.762782 (Thread-1): finished collecting timing info
2021-06-25 10:39:47.763193 (Thread-1): 10:39:47 | 2 of 2 PASS unique_stg_customers_customer_id......................... [PASS in 1.50s]
2021-06-25 10:39:47.763279 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 10:39:47.764574 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:39:47.764834 (MainThread): 10:39:47 | 
2021-06-25 10:39:47.764900 (MainThread): 10:39:47 | Finished running 2 tests in 4.64s.
2021-06-25 10:39:47.764949 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:39:47.764990 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id' was properly closed.
2021-06-25 10:39:47.823957 (MainThread): 
2021-06-25 10:39:47.824102 (MainThread): Completed successfully
2021-06-25 10:39:47.824170 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-06-25 10:39:48.289059 (Thread-325): handling poll request
2021-06-25 10:39:48.289355 (Thread-325): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2b45e0>]}
2021-06-25 10:39:48.290498 (Thread-325): sending response (<Response 8975 bytes [200 OK]>) to 10.0.47.156
2021-06-25 10:39:49.084720 (Thread-326): handling status request
2021-06-25 10:39:49.085022 (Thread-326): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab29d0a0>]}
2021-06-25 10:39:49.085562 (Thread-326): sending response (<Response 1303 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:39:49.179198 (Thread-327): handling status request
2021-06-25 10:39:49.179486 (Thread-327): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab29d100>]}
2021-06-25 10:39:49.180001 (Thread-327): sending response (<Response 1303 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:39:49.213411 (Thread-328): handling status request
2021-06-25 10:39:49.213719 (Thread-328): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab29d160>]}
2021-06-25 10:39:49.214248 (Thread-328): sending response (<Response 1303 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:43:00.344193 (Thread-329): Got an acceptable cached parse result
2021-06-25 10:43:00.812691 (Thread-330): handling status request
2021-06-25 10:43:00.812994 (Thread-330): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab11ab50>]}
2021-06-25 10:43:00.813520 (Thread-330): sending response (<Response 783 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:43:00.833590 (Thread-331): handling status request
2021-06-25 10:43:00.833914 (Thread-331): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab1c3490>]}
2021-06-25 10:43:00.834427 (Thread-331): sending response (<Response 783 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:43:00.835571 (Thread-332): handling status request
2021-06-25 10:43:00.835810 (Thread-332): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c8faf0>]}
2021-06-25 10:43:00.836182 (Thread-332): sending response (<Response 783 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:44:02.152338 (Thread-333): Got an acceptable cached parse result
2021-06-25 10:44:02.313996 (Thread-333): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:44:02.314558 (Thread-333): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c354f0>]}
2021-06-25 10:44:02.369978 (Thread-334): handling status request
2021-06-25 10:44:02.370262 (Thread-334): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c35fd0>]}
2021-06-25 10:44:02.370804 (Thread-334): sending response (<Response 1303 bytes [200 OK]>) to 10.0.36.19
2021-06-25 10:44:02.378407 (Thread-335): handling status request
2021-06-25 10:44:02.378608 (Thread-335): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c35730>]}
2021-06-25 10:44:02.403392 (Thread-335): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.7
2021-06-25 10:44:02.580682 (Thread-336): handling status request
2021-06-25 10:44:02.580978 (Thread-336): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c371c0>]}
2021-06-25 10:44:02.581497 (Thread-336): sending response (<Response 1303 bytes [200 OK]>) to 10.0.47.156
2021-06-25 10:44:21.418931 (Thread-337): handling status request
2021-06-25 10:44:21.419242 (Thread-337): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2481f0>]}
2021-06-25 10:44:21.419759 (Thread-337): sending response (<Response 1303 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:44:21.625913 (Thread-338): handling status request
2021-06-25 10:44:21.626200 (Thread-338): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6c8eb0>]}
2021-06-25 10:44:21.626709 (Thread-338): sending response (<Response 1303 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:44:21.669567 (Thread-339): handling cli_args request
2021-06-25 10:44:21.669808 (Thread-339): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c378b0>]}
2021-06-25 10:44:23.457013 (Thread-339): sending response (<Response 138 bytes [200 OK]>) to 10.0.47.156
2021-06-25 10:44:23.492507 (MainThread): Partial parsing not enabled
2021-06-25 10:44:23.494954 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:44:23.515190 (MainThread): Parsing macros/etc.sql
2021-06-25 10:44:23.517339 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:44:23.523355 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:44:23.527811 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:44:23.537475 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:44:23.549516 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:44:23.552220 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:44:23.554051 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:44:23.557462 (MainThread): Parsing macros/core.sql
2021-06-25 10:44:23.561305 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:44:23.570383 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:44:23.584145 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:44:23.585986 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:44:23.603369 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:44:23.634065 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:44:23.638934 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:44:23.645099 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:44:23.665275 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:44:23.671798 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:44:23.673636 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:44:23.679527 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:44:23.681163 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:44:23.682280 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:44:23.690937 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:44:23.691943 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:44:23.693615 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:44:23.695584 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:44:23.697156 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:44:23.699899 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:44:23.701878 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:44:23.703706 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:44:23.713595 (Thread-340): handling poll request
2021-06-25 10:44:23.713899 (Thread-340): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8193eb0>]}
2021-06-25 10:44:23.715135 (Thread-340): sending response (<Response 9390 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:44:23.752962 (MainThread): Partial parsing not enabled
2021-06-25 10:44:23.791611 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:44:23.803076 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:44:23.807959 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:44:23.812776 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:44:23.819026 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:44:23.954276 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:44:23.955833 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ca1a16f-7f93-4db8-b156-2869977351b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee1fce7700>]}
2021-06-25 10:44:23.993106 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ca1a16f-7f93-4db8-b156-2869977351b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee20724250>]}
2021-06-25 10:44:23.993374 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:44:23.994013 (MainThread): 
2021-06-25 10:44:23.994280 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:44:23.995465 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:44:23.995563 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 10:44:24.177515 (MainThread): 10:44:24 | Concurrency: 1 threads (target='default')
2021-06-25 10:44:24.177643 (MainThread): 10:44:24 | 
2021-06-25 10:44:24.179768 (Thread-1): Began running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed
2021-06-25 10:44:24.179939 (Thread-1): 10:44:24 | 1 of 1 START test accepted_stg_orders_status__returned__completed__shipped__placed [RUN]
2021-06-25 10:44:24.180445 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed".
2021-06-25 10:44:24.180541 (Thread-1): Compiling test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed
2021-06-25 10:44:24.185730 (Thread-1): finished collecting timing info
2021-06-25 10:44:24.185997 (Thread-1): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_accepted' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
2021-06-25 10:44:24.187348 (Thread-1): 10:44:24 | 1 of 1 ERROR accepted_stg_orders_status__returned__completed__shipped__placed [ERROR in 0.01s]
2021-06-25 10:44:24.187423 (Thread-1): Finished running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed
2021-06-25 10:44:24.188535 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:44:24.188762 (MainThread): 10:44:24 | 
2021-06-25 10:44:24.188823 (MainThread): 10:44:24 | Finished running 1 test in 0.19s.
2021-06-25 10:44:24.188872 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:44:24.188912 (MainThread): Connection 'test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed' was properly closed.
2021-06-25 10:44:24.244972 (MainThread): 
2021-06-25 10:44:24.245113 (MainThread): Completed with 1 error and 0 warnings:
2021-06-25 10:44:24.245172 (MainThread): 
2021-06-25 10:44:24.245227 (MainThread): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed (models/staging/jaffle_shop/stg_jaffle_shop.yml)
2021-06-25 10:44:24.245272 (MainThread):   'test_accepted' is undefined
2021-06-25 10:44:24.245320 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-25 10:44:25.149541 (Thread-341): handling poll request
2021-06-25 10:44:25.149954 (Thread-341): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c35df0>]}
2021-06-25 10:44:25.151223 (Thread-341): sending response (<Response 18655 bytes [200 OK]>) to 10.0.47.156
2021-06-25 10:44:25.769137 (Thread-342): handling status request
2021-06-25 10:44:25.769427 (Thread-342): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81191c0>]}
2021-06-25 10:44:25.769997 (Thread-342): sending response (<Response 1303 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:44:25.833440 (Thread-343): handling status request
2021-06-25 10:44:25.833765 (Thread-343): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8119eb0>]}
2021-06-25 10:44:25.834277 (Thread-343): sending response (<Response 1303 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:44:25.844646 (Thread-344): handling status request
2021-06-25 10:44:25.844922 (Thread-344): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2481f0>]}
2021-06-25 10:44:25.845398 (Thread-344): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:45:04.352185 (Thread-345): handling status request
2021-06-25 10:45:04.352483 (Thread-345): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7bd910>]}
2021-06-25 10:45:04.352980 (Thread-345): sending response (<Response 1303 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:45:04.362085 (Thread-346): handling status request
2021-06-25 10:45:04.362299 (Thread-346): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4dccd0>]}
2021-06-25 10:45:04.362725 (Thread-346): sending response (<Response 1303 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:45:04.739758 (Thread-347): handling cli_args request
2021-06-25 10:45:04.740124 (Thread-347): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab567520>]}
2021-06-25 10:45:06.555149 (Thread-347): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:45:06.589978 (MainThread): Partial parsing not enabled
2021-06-25 10:45:06.592287 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:45:06.612503 (MainThread): Parsing macros/etc.sql
2021-06-25 10:45:06.614595 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:45:06.620596 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:45:06.625063 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:45:06.634947 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:45:06.647081 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:45:06.649748 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:45:06.651565 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:45:06.654988 (MainThread): Parsing macros/core.sql
2021-06-25 10:45:06.658831 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:45:06.667769 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:45:06.681874 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:45:06.683670 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:45:06.701874 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:45:06.732950 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:45:06.737905 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:45:06.744071 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:45:06.764464 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:45:06.771197 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:45:06.773081 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:45:06.779020 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:45:06.780652 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:45:06.781750 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:45:06.791135 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:45:06.792166 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:45:06.793900 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:45:06.796053 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:45:06.798033 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:45:06.800818 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:45:06.802768 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:45:06.804532 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:45:06.811708 (Thread-348): handling poll request
2021-06-25 10:45:06.811988 (Thread-348): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5d6df0>]}
2021-06-25 10:45:06.813186 (Thread-348): sending response (<Response 9389 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:45:06.854196 (MainThread): Partial parsing not enabled
2021-06-25 10:45:06.887429 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:45:06.898496 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:45:06.903480 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:45:06.908112 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:45:06.914320 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:45:07.073820 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:45:07.075826 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2460fba3-859e-4056-9d7f-b04b4e610384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8363cae640>]}
2021-06-25 10:45:07.107255 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2460fba3-859e-4056-9d7f-b04b4e610384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83646f41c0>]}
2021-06-25 10:45:07.107536 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:45:07.108165 (MainThread): 
2021-06-25 10:45:07.108514 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:45:07.109430 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 10:45:07.109558 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 10:45:07.309508 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:45:07.309649 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 10:45:07.508201 (MainThread): 10:45:07 | Concurrency: 1 threads (target='default')
2021-06-25 10:45:07.508326 (MainThread): 10:45:07 | 
2021-06-25 10:45:07.530563 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 10:45:07.530872 (Thread-1): 10:45:07 | 1 of 1 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 10:45:07.531157 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:45:07.531243 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 10:45:07.532690 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 10:45:07.550181 (Thread-1): finished collecting timing info
2021-06-25 10:45:07.577269 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 10:45:07.593730 (Thread-1): Opening a new connection, currently in state init
2021-06-25 10:45:07.597982 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 10:45:08.059702 (Thread-349): handling poll request
2021-06-25 10:45:08.059999 (Thread-349): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0e8130>]}
2021-06-25 10:45:08.060803 (Thread-349): sending response (<Response 9973 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:45:08.492282 (Thread-1): finished collecting timing info
2021-06-25 10:45:08.492657 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2460fba3-859e-4056-9d7f-b04b4e610384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8363da88b0>]}
2021-06-25 10:45:08.492944 (Thread-1): 10:45:08 | 1 of 1 OK created view model dbt_mskonberg.stg_orders................ [OK in 0.96s]
2021-06-25 10:45:08.493017 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 10:45:08.494350 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:45:08.494624 (MainThread): 10:45:08 | 
2021-06-25 10:45:08.494690 (MainThread): 10:45:08 | Finished running 1 view model in 1.39s.
2021-06-25 10:45:08.494738 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:45:08.494779 (MainThread): Connection 'list_neat-episode-288515_dbt_mskonberg' was properly closed.
2021-06-25 10:45:08.494815 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-06-25 10:45:08.553353 (MainThread): 
2021-06-25 10:45:08.553477 (MainThread): Completed successfully
2021-06-25 10:45:08.553539 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-25 10:45:09.377790 (Thread-350): handling poll request
2021-06-25 10:45:09.378085 (Thread-350): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0fdc70>]}
2021-06-25 10:45:09.379110 (Thread-350): sending response (<Response 7457 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:45:10.076368 (Thread-351): handling status request
2021-06-25 10:45:10.076655 (Thread-351): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab26f460>]}
2021-06-25 10:45:10.077183 (Thread-351): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.7
2021-06-25 10:45:10.110152 (Thread-352): handling status request
2021-06-25 10:45:10.110418 (Thread-352): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab26fdf0>]}
2021-06-25 10:45:10.110893 (Thread-352): sending response (<Response 1303 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:45:10.130195 (Thread-353): handling status request
2021-06-25 10:45:10.130446 (Thread-353): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab26f9d0>]}
2021-06-25 10:45:10.130981 (Thread-353): sending response (<Response 1303 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:45:41.296206 (Thread-354): handling status request
2021-06-25 10:45:41.296504 (Thread-354): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab26f100>]}
2021-06-25 10:45:41.297006 (Thread-354): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:45:41.329702 (Thread-355): handling status request
2021-06-25 10:45:41.329937 (Thread-355): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab26fa30>]}
2021-06-25 10:45:41.330373 (Thread-355): sending response (<Response 1303 bytes [200 OK]>) to 10.0.45.5
2021-06-25 10:45:41.594791 (Thread-356): handling cli_args request
2021-06-25 10:45:41.595126 (Thread-356): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab265190>]}
2021-06-25 10:45:43.376646 (Thread-356): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:45:43.412396 (MainThread): Partial parsing not enabled
2021-06-25 10:45:43.415219 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:45:43.435681 (MainThread): Parsing macros/etc.sql
2021-06-25 10:45:43.437861 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:45:43.443956 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:45:43.448459 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:45:43.458086 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:45:43.470114 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:45:43.472811 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:45:43.474649 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:45:43.478082 (MainThread): Parsing macros/core.sql
2021-06-25 10:45:43.481919 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:45:43.490771 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:45:43.504461 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:45:43.506320 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:45:43.523469 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:45:43.553950 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:45:43.558843 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:45:43.564922 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:45:43.585278 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:45:43.591725 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:45:43.593581 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:45:43.599452 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:45:43.601064 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:45:43.602194 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:45:43.610788 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:45:43.611764 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:45:43.613414 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:45:43.615380 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:45:43.616918 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:45:43.619603 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:45:43.621493 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:45:43.623267 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:45:43.672672 (MainThread): Partial parsing not enabled
2021-06-25 10:45:43.706346 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:45:43.717619 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:45:43.722294 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:45:43.727554 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:45:43.734323 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:45:43.778220 (Thread-357): handling poll request
2021-06-25 10:45:43.778504 (Thread-357): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5d5fd0>]}
2021-06-25 10:45:43.780304 (Thread-357): sending response (<Response 11164 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:45:43.868213 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:45:43.870587 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdb35c23-b769-496d-a883-a22cda9ed226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54cb02f640>]}
2021-06-25 10:45:43.902167 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdb35c23-b769-496d-a883-a22cda9ed226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54cba6a4f0>]}
2021-06-25 10:45:43.902418 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:45:43.902997 (MainThread): 
2021-06-25 10:45:43.903243 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:45:43.904482 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:45:43.904582 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 10:45:44.118547 (MainThread): 10:45:44 | Concurrency: 1 threads (target='default')
2021-06-25 10:45:44.118680 (MainThread): 10:45:44 | 
2021-06-25 10:45:44.120646 (Thread-1): Began running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed
2021-06-25 10:45:44.120819 (Thread-1): 10:45:44 | 1 of 1 START test accepted_stg_orders_status__returned__completed__shipped__placed [RUN]
2021-06-25 10:45:44.121387 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed".
2021-06-25 10:45:44.121490 (Thread-1): Compiling test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed
2021-06-25 10:45:44.126855 (Thread-1): finished collecting timing info
2021-06-25 10:45:44.127138 (Thread-1): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_accepted' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
2021-06-25 10:45:44.128458 (Thread-1): 10:45:44 | 1 of 1 ERROR accepted_stg_orders_status__returned__completed__shipped__placed [ERROR in 0.01s]
2021-06-25 10:45:44.128538 (Thread-1): Finished running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed
2021-06-25 10:45:44.129659 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:45:44.129905 (MainThread): 10:45:44 | 
2021-06-25 10:45:44.129967 (MainThread): 10:45:44 | Finished running 1 test in 0.23s.
2021-06-25 10:45:44.130014 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:45:44.130054 (MainThread): Connection 'test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed' was properly closed.
2021-06-25 10:45:44.193095 (MainThread): 
2021-06-25 10:45:44.193233 (MainThread): Completed with 1 error and 0 warnings:
2021-06-25 10:45:44.193290 (MainThread): 
2021-06-25 10:45:44.193344 (MainThread): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed (models/staging/jaffle_shop/stg_jaffle_shop.yml)
2021-06-25 10:45:44.193387 (MainThread):   'test_accepted' is undefined
2021-06-25 10:45:44.193435 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-25 10:45:45.204706 (Thread-358): handling poll request
2021-06-25 10:45:45.204998 (Thread-358): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab1dd8b0>]}
2021-06-25 10:45:45.206291 (Thread-358): sending response (<Response 16881 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:45:45.657126 (Thread-359): handling status request
2021-06-25 10:45:45.657408 (Thread-359): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab1ddfa0>]}
2021-06-25 10:45:45.657988 (Thread-359): sending response (<Response 1303 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:45:45.708050 (Thread-360): handling status request
2021-06-25 10:45:45.708313 (Thread-360): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab1ddbe0>]}
2021-06-25 10:45:45.708814 (Thread-360): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:45:45.716798 (Thread-361): handling status request
2021-06-25 10:45:45.716999 (Thread-361): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8bc6910>]}
2021-06-25 10:45:45.717427 (Thread-361): sending response (<Response 1303 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:47:10.149784 (Thread-362): Got an acceptable cached parse result
2021-06-25 10:47:10.307329 (Thread-362): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:47:10.307932 (Thread-362): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab215c70>]}
2021-06-25 10:47:10.664307 (Thread-363): handling status request
2021-06-25 10:47:10.665010 (Thread-364): handling status request
2021-06-25 10:47:10.665306 (Thread-363): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab22bcd0>]}
2021-06-25 10:47:10.665556 (Thread-364): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab215610>]}
2021-06-25 10:47:10.666107 (Thread-363): sending response (<Response 1303 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:47:10.666588 (Thread-364): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.7
2021-06-25 10:47:10.720474 (Thread-365): handling status request
2021-06-25 10:47:10.720723 (Thread-365): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab215f10>]}
2021-06-25 10:47:10.970611 (Thread-365): sending response (<Response 1303 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:47:18.995731 (Thread-366): handling status request
2021-06-25 10:47:18.996129 (Thread-366): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab20da90>]}
2021-06-25 10:47:18.996836 (Thread-366): sending response (<Response 1303 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:47:19.066709 (Thread-367): handling status request
2021-06-25 10:47:19.066995 (Thread-367): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab20da60>]}
2021-06-25 10:47:19.067488 (Thread-367): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:47:19.225240 (Thread-368): handling cli_args request
2021-06-25 10:47:19.225530 (Thread-368): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3bdc10>]}
2021-06-25 10:47:21.030688 (Thread-368): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:47:21.067092 (MainThread): Partial parsing not enabled
2021-06-25 10:47:21.069536 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:47:21.089993 (MainThread): Parsing macros/etc.sql
2021-06-25 10:47:21.092173 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:47:21.098624 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:47:21.103147 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:47:21.112879 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:47:21.124882 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:47:21.127592 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:47:21.129411 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:47:21.132885 (MainThread): Parsing macros/core.sql
2021-06-25 10:47:21.136708 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:47:21.145546 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:47:21.159565 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:47:21.161385 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:47:21.178585 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:47:21.209082 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:47:21.214047 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:47:21.220844 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:47:21.241004 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:47:21.247444 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:47:21.249300 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:47:21.255234 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:47:21.256860 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:47:21.257973 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:47:21.266605 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:47:21.267581 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:47:21.269279 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:47:21.271260 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:47:21.272806 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:47:21.275562 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:47:21.277494 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:47:21.279286 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:47:21.329128 (MainThread): Partial parsing not enabled
2021-06-25 10:47:21.362648 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:47:21.374194 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:47:21.379192 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:47:21.383998 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:47:21.390219 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:47:21.436471 (Thread-369): handling poll request
2021-06-25 10:47:21.436819 (Thread-369): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3befd0>]}
2021-06-25 10:47:21.438274 (Thread-369): sending response (<Response 11163 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:47:21.522139 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:47:21.522516 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '777cd943-e4b3-408d-b2a9-369777a8b6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bd03349a0>]}
2021-06-25 10:47:21.550370 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '777cd943-e4b3-408d-b2a9-369777a8b6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bd03cb880>]}
2021-06-25 10:47:21.550622 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:47:21.551205 (MainThread): 
2021-06-25 10:47:21.551457 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:47:21.552256 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 10:47:21.552404 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 10:47:21.790169 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:47:21.790326 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 10:47:21.986436 (MainThread): 10:47:21 | Concurrency: 1 threads (target='default')
2021-06-25 10:47:21.986567 (MainThread): 10:47:21 | 
2021-06-25 10:47:21.988665 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 10:47:21.988948 (Thread-1): 10:47:21 | 1 of 1 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 10:47:21.989166 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:47:21.989246 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 10:47:21.990961 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 10:47:22.009753 (Thread-1): finished collecting timing info
2021-06-25 10:47:22.037098 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 10:47:22.053168 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:47:22.057863 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 10:47:22.772012 (Thread-370): handling poll request
2021-06-25 10:47:22.772305 (Thread-370): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab20d4c0>]}
2021-06-25 10:47:22.773051 (Thread-370): sending response (<Response 8200 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:47:23.043037 (Thread-1): finished collecting timing info
2021-06-25 10:47:23.043413 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '777cd943-e4b3-408d-b2a9-369777a8b6ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bd033f340>]}
2021-06-25 10:47:23.043851 (Thread-1): 10:47:23 | 1 of 1 OK created view model dbt_mskonberg.stg_orders................ [OK in 1.05s]
2021-06-25 10:47:23.043931 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 10:47:23.045118 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:47:23.045370 (MainThread): 10:47:23 | 
2021-06-25 10:47:23.045433 (MainThread): 10:47:23 | Finished running 1 view model in 1.49s.
2021-06-25 10:47:23.045480 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:47:23.045520 (MainThread): Connection 'list_neat-episode-288515' was properly closed.
2021-06-25 10:47:23.045557 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-06-25 10:47:23.101559 (MainThread): 
2021-06-25 10:47:23.101728 (MainThread): Completed successfully
2021-06-25 10:47:23.101799 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-25 10:47:24.250610 (Thread-371): handling poll request
2021-06-25 10:47:24.250897 (Thread-371): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2af430>]}
2021-06-25 10:47:24.251904 (Thread-371): sending response (<Response 7444 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:47:24.802830 (Thread-372): handling status request
2021-06-25 10:47:24.803120 (Thread-372): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2af460>]}
2021-06-25 10:47:24.803642 (Thread-372): sending response (<Response 1303 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:47:24.854834 (Thread-373): handling status request
2021-06-25 10:47:24.855113 (Thread-373): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0b16d0>]}
2021-06-25 10:47:24.855609 (Thread-373): sending response (<Response 1303 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:47:24.930989 (Thread-374): handling status request
2021-06-25 10:47:24.931257 (Thread-374): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0b1b80>]}
2021-06-25 10:47:24.931740 (Thread-374): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:47:29.088943 (Thread-375): handling status request
2021-06-25 10:47:29.089232 (Thread-375): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab39f910>]}
2021-06-25 10:47:29.089749 (Thread-375): sending response (<Response 1303 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:47:29.221940 (Thread-376): handling status request
2021-06-25 10:47:29.222244 (Thread-376): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab39f550>]}
2021-06-25 10:47:29.222782 (Thread-376): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:47:29.361109 (Thread-377): handling cli_args request
2021-06-25 10:47:29.361391 (Thread-377): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab39f850>]}
2021-06-25 10:47:31.166414 (Thread-377): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:47:31.202446 (MainThread): Partial parsing not enabled
2021-06-25 10:47:31.204915 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:47:31.225785 (MainThread): Parsing macros/etc.sql
2021-06-25 10:47:31.227925 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:47:31.234022 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:47:31.238649 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:47:31.248477 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:47:31.260673 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:47:31.263457 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:47:31.265321 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:47:31.268843 (MainThread): Parsing macros/core.sql
2021-06-25 10:47:31.272722 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:47:31.281700 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:47:31.295536 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:47:31.297356 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:47:31.314645 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:47:31.351033 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:47:31.355979 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:47:31.362205 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:47:31.382592 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:47:31.389088 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:47:31.390961 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:47:31.396849 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:47:31.398496 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:47:31.399626 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:47:31.408305 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:47:31.409362 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:47:31.411072 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:47:31.413062 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:47:31.414641 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:47:31.417357 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:47:31.419331 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:47:31.421144 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:47:31.455071 (Thread-378): handling poll request
2021-06-25 10:47:31.455360 (Thread-378): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaef8700>]}
2021-06-25 10:47:31.456509 (Thread-378): sending response (<Response 9390 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:47:31.471123 (MainThread): Partial parsing not enabled
2021-06-25 10:47:31.505368 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:47:31.516653 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:47:31.521303 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:47:31.526349 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:47:31.532937 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:47:31.671777 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:47:31.672130 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22c5dca-8224-48c3-b625-41c6d9b9314f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a6de29a0>]}
2021-06-25 10:47:31.705973 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22c5dca-8224-48c3-b625-41c6d9b9314f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a781b670>]}
2021-06-25 10:47:31.706232 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:47:31.706820 (MainThread): 
2021-06-25 10:47:31.707071 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:47:31.708270 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:47:31.708369 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 10:47:31.884495 (MainThread): 10:47:31 | Concurrency: 1 threads (target='default')
2021-06-25 10:47:31.884635 (MainThread): 10:47:31 | 
2021-06-25 10:47:31.886749 (Thread-1): Began running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:47:31.886916 (Thread-1): 10:47:31 | 1 of 1 START test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending [RUN]
2021-06-25 10:47:31.887128 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 10:47:31.887207 (Thread-1): Compiling test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:47:31.893146 (Thread-1): finished collecting timing info
2021-06-25 10:47:31.893422 (Thread-1): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_accepted' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
2021-06-25 10:47:31.894813 (Thread-1): 10:47:31 | 1 of 1 ERROR accepted_stg_orders_status__returned__completed__shipped__placed__return_pending [ERROR in 0.01s]
2021-06-25 10:47:31.894897 (Thread-1): Finished running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:47:31.896045 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:47:31.896265 (MainThread): 10:47:31 | 
2021-06-25 10:47:31.896326 (MainThread): 10:47:31 | Finished running 1 test in 0.19s.
2021-06-25 10:47:31.896372 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:47:31.896411 (MainThread): Connection 'test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending' was properly closed.
2021-06-25 10:47:31.954086 (MainThread): 
2021-06-25 10:47:31.954214 (MainThread): Completed with 1 error and 0 warnings:
2021-06-25 10:47:31.954272 (MainThread): 
2021-06-25 10:47:31.954325 (MainThread): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
2021-06-25 10:47:31.954368 (MainThread):   'test_accepted' is undefined
2021-06-25 10:47:31.954415 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-25 10:47:32.936181 (Thread-379): handling poll request
2021-06-25 10:47:32.936529 (Thread-379): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf6b6d0>]}
2021-06-25 10:47:32.937845 (Thread-379): sending response (<Response 19088 bytes [200 OK]>) to 10.0.47.156
2021-06-25 10:47:33.495617 (Thread-380): handling status request
2021-06-25 10:47:33.495950 (Thread-380): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf6b8e0>]}
2021-06-25 10:47:33.496484 (Thread-380): sending response (<Response 1303 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:47:33.605539 (Thread-381): handling status request
2021-06-25 10:47:33.605862 (Thread-381): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf6b820>]}
2021-06-25 10:47:33.606356 (Thread-381): sending response (<Response 1303 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:47:33.676814 (Thread-382): handling status request
2021-06-25 10:47:33.677067 (Thread-382): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf6b940>]}
2021-06-25 10:47:33.677537 (Thread-382): sending response (<Response 1303 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:47:47.723924 (Thread-383): handling status request
2021-06-25 10:47:47.724230 (Thread-383): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf6bb20>]}
2021-06-25 10:47:47.724756 (Thread-383): sending response (<Response 1303 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:47:48.085834 (Thread-384): handling run_sql request
2021-06-25 10:47:48.086141 (Thread-384): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf6bd60>]}
2021-06-25 10:47:49.900762 (Thread-384): sending response (<Response 138 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:47:49.912603 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 10:47:49.923213 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a131684-8a36-4c0c-89cc-dab2e131ceba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec9defc7f0>]}
2021-06-25 10:47:49.923466 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:47:49.923870 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 10:47:49.923980 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 10:47:49.925042 (Thread-1): finished collecting timing info
2021-06-25 10:47:49.925170 (Thread-1): Opening a new connection, currently in state init
2021-06-25 10:47:49.929691 (Thread-1): On rpc.jaffle_shop.request: with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 10:47:50.180871 (Thread-385): handling poll request
2021-06-25 10:47:50.181206 (Thread-385): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaef84c0>]}
2021-06-25 10:47:50.182263 (Thread-385): sending response (<Response 3284 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:47:51.150222 (Thread-1): finished collecting timing info
2021-06-25 10:47:51.617199 (Thread-386): handling poll request
2021-06-25 10:47:51.617487 (Thread-386): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaee5130>]}
2021-06-25 10:47:51.618927 (Thread-386): sending response (<Response 7497 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:49:43.370604 (Thread-387): Got an acceptable cached parse result
2021-06-25 10:49:43.663370 (Thread-387): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:49:43.663901 (Thread-387): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a3820>]}
2021-06-25 10:49:44.027065 (Thread-388): handling status request
2021-06-25 10:49:44.027363 (Thread-388): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a35b0>]}
2021-06-25 10:49:44.027944 (Thread-388): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:49:44.061608 (Thread-389): handling status request
2021-06-25 10:49:44.061928 (Thread-389): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a3670>]}
2021-06-25 10:49:44.062417 (Thread-389): sending response (<Response 1303 bytes [200 OK]>) to 10.0.21.203
2021-06-25 10:49:44.095936 (Thread-390): handling status request
2021-06-25 10:49:44.096266 (Thread-390): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a3490>]}
2021-06-25 10:49:44.096770 (Thread-390): sending response (<Response 1303 bytes [200 OK]>) to 10.0.31.198
2021-06-25 10:49:48.683151 (Thread-391): handling status request
2021-06-25 10:49:48.683442 (Thread-391): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a3d00>]}
2021-06-25 10:49:48.683953 (Thread-391): sending response (<Response 1303 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:49:48.786026 (Thread-392): handling status request
2021-06-25 10:49:48.786317 (Thread-392): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a3b50>]}
2021-06-25 10:49:48.786828 (Thread-392): sending response (<Response 1303 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:49:48.979236 (Thread-393): handling cli_args request
2021-06-25 10:49:48.979521 (Thread-393): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a3310>]}
2021-06-25 10:49:50.771718 (Thread-393): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:49:50.807275 (MainThread): Partial parsing not enabled
2021-06-25 10:49:50.809955 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:49:50.830963 (MainThread): Parsing macros/etc.sql
2021-06-25 10:49:50.833214 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:49:50.839715 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:49:50.844271 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:49:50.854124 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:49:50.867120 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:49:50.870071 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:49:50.872065 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:49:50.875889 (MainThread): Parsing macros/core.sql
2021-06-25 10:49:50.880108 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:49:50.889977 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:49:50.905004 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:49:50.907072 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:49:50.925940 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:49:50.959165 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:49:50.964380 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:49:50.970617 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:49:50.990773 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:49:50.997260 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:49:50.999197 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:49:51.005103 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:49:51.006791 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:49:51.007877 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:49:51.016787 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:49:51.017804 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:49:51.019509 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:49:51.021491 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:49:51.023115 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:49:51.025882 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:49:51.027781 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:49:51.029559 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:49:51.079687 (MainThread): Partial parsing not enabled
2021-06-25 10:49:51.113915 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:49:51.125223 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:49:51.130624 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:49:51.136302 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:49:51.142743 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:49:51.252274 (Thread-394): handling poll request
2021-06-25 10:49:51.252583 (Thread-394): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaee5ac0>]}
2021-06-25 10:49:51.253937 (Thread-394): sending response (<Response 11164 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:49:51.279040 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:49:51.279426 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c3bdcbd-d5c6-4fbe-8324-af6a35a8947b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4e4158e0>]}
2021-06-25 10:49:51.313289 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c3bdcbd-d5c6-4fbe-8324-af6a35a8947b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4e662f70>]}
2021-06-25 10:49:51.313538 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:49:51.314197 (MainThread): 
2021-06-25 10:49:51.314460 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:49:51.315808 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:49:51.315905 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 10:49:51.528504 (MainThread): 10:49:51 | Concurrency: 1 threads (target='default')
2021-06-25 10:49:51.528649 (MainThread): 10:49:51 | 
2021-06-25 10:49:51.530761 (Thread-1): Began running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:49:51.530937 (Thread-1): 10:49:51 | 1 of 1 START test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending [RUN]
2021-06-25 10:49:51.531158 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 10:49:51.531240 (Thread-1): Compiling test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:49:51.538906 (Thread-1): finished collecting timing info
2021-06-25 10:49:51.539293 (Thread-1): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_accepted' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
2021-06-25 10:49:51.541114 (Thread-1): 10:49:51 | 1 of 1 ERROR accepted_stg_orders_status__returned__completed__shipped__placed__return_pending [ERROR in 0.01s]
2021-06-25 10:49:51.541216 (Thread-1): Finished running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:49:51.542918 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:49:51.543250 (MainThread): 10:49:51 | 
2021-06-25 10:49:51.543346 (MainThread): 10:49:51 | Finished running 1 test in 0.23s.
2021-06-25 10:49:51.543415 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:49:51.543470 (MainThread): Connection 'test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending' was properly closed.
2021-06-25 10:49:51.615500 (MainThread): 
2021-06-25 10:49:51.615654 (MainThread): Completed with 1 error and 0 warnings:
2021-06-25 10:49:51.615714 (MainThread): 
2021-06-25 10:49:51.615770 (MainThread): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
2021-06-25 10:49:51.615815 (MainThread):   'test_accepted' is undefined
2021-06-25 10:49:51.615863 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-25 10:49:52.512850 (Thread-395): handling poll request
2021-06-25 10:49:52.513145 (Thread-395): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaae94eb0>]}
2021-06-25 10:49:52.539177 (Thread-395): sending response (<Response 17315 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:49:53.401914 (Thread-396): handling status request
2021-06-25 10:49:53.402269 (Thread-396): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaae94d90>]}
2021-06-25 10:49:53.402840 (Thread-396): sending response (<Response 1303 bytes [200 OK]>) to 10.0.45.5
2021-06-25 10:49:53.533410 (Thread-397): handling status request
2021-06-25 10:49:53.533734 (Thread-397): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a3250>]}
2021-06-25 10:49:53.534266 (Thread-397): sending response (<Response 1303 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:49:53.545584 (Thread-398): handling status request
2021-06-25 10:49:53.545816 (Thread-398): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a3640>]}
2021-06-25 10:49:53.546259 (Thread-398): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:53:50.899039 (Thread-399): handling status request
2021-06-25 10:53:50.900790 (Thread-399): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a3c10>]}
2021-06-25 10:53:50.901381 (Thread-399): sending response (<Response 1303 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:53:50.931656 (Thread-400): handling status request
2021-06-25 10:53:50.931872 (Thread-400): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaea1af0>]}
2021-06-25 10:53:50.932319 (Thread-400): sending response (<Response 1303 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:53:51.135030 (Thread-401): handling cli_args request
2021-06-25 10:53:51.135321 (Thread-401): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaea10d0>]}
2021-06-25 10:53:52.964014 (Thread-401): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:53:53.000701 (MainThread): Partial parsing not enabled
2021-06-25 10:53:53.003593 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:53:53.023823 (MainThread): Parsing macros/etc.sql
2021-06-25 10:53:53.025971 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:53:53.032021 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:53:53.036543 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:53:53.046612 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:53:53.058900 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:53:53.061644 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:53:53.063502 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:53:53.066982 (MainThread): Parsing macros/core.sql
2021-06-25 10:53:53.070933 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:53:53.079820 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:53:53.093580 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:53:53.095411 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:53:53.112588 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:53:53.143069 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:53:53.148327 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:53:53.154667 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:53:53.175359 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:53:53.181870 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:53:53.183694 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:53:53.189541 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:53:53.191186 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:53:53.192278 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:53:53.200974 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:53:53.201977 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:53:53.203685 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:53:53.205653 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:53:53.207214 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:53:53.209910 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:53:53.211800 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:53:53.213565 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:53:53.262890 (MainThread): Partial parsing not enabled
2021-06-25 10:53:53.299265 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:53:53.310219 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:53:53.315153 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:53:53.319941 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:53:53.326311 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:53:53.394353 (Thread-402): handling poll request
2021-06-25 10:53:53.394680 (Thread-402): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b8bcd0>]}
2021-06-25 10:53:53.396053 (Thread-402): sending response (<Response 11164 bytes [200 OK]>) to 10.0.47.156
2021-06-25 10:53:53.472791 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:53:53.473169 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce4f5a81-4856-4c8e-bc19-96b28decbb25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ffed27940>]}
2021-06-25 10:53:53.508830 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce4f5a81-4856-4c8e-bc19-96b28decbb25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1fff7cec70>]}
2021-06-25 10:53:53.509078 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:53:53.509656 (MainThread): 
2021-06-25 10:53:53.509935 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:53:53.511063 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:53:53.511159 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 10:53:53.707695 (MainThread): 10:53:53 | Concurrency: 1 threads (target='default')
2021-06-25 10:53:53.707826 (MainThread): 10:53:53 | 
2021-06-25 10:53:53.709944 (Thread-1): Began running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:53:53.710115 (Thread-1): 10:53:53 | 1 of 1 START test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending [RUN]
2021-06-25 10:53:53.710334 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 10:53:53.710418 (Thread-1): Compiling test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:53:53.716136 (Thread-1): finished collecting timing info
2021-06-25 10:53:53.716420 (Thread-1): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_accepted' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
2021-06-25 10:53:53.717848 (Thread-1): 10:53:53 | 1 of 1 ERROR accepted_stg_orders_status__returned__completed__shipped__placed__return_pending [ERROR in 0.01s]
2021-06-25 10:53:53.717930 (Thread-1): Finished running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:53:53.719089 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:53:53.719305 (MainThread): 10:53:53 | 
2021-06-25 10:53:53.719367 (MainThread): 10:53:53 | Finished running 1 test in 0.21s.
2021-06-25 10:53:53.719414 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:53:53.719452 (MainThread): Connection 'test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending' was properly closed.
2021-06-25 10:53:53.779027 (MainThread): 
2021-06-25 10:53:53.779183 (MainThread): Completed with 1 error and 0 warnings:
2021-06-25 10:53:53.779241 (MainThread): 
2021-06-25 10:53:53.779296 (MainThread): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
2021-06-25 10:53:53.779339 (MainThread):   'test_accepted' is undefined
2021-06-25 10:53:53.779386 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-06-25 10:53:54.890724 (Thread-403): handling poll request
2021-06-25 10:53:54.891019 (Thread-403): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaed8b20>]}
2021-06-25 10:53:54.892229 (Thread-403): sending response (<Response 17315 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:53:55.335811 (Thread-404): handling status request
2021-06-25 10:53:55.336099 (Thread-404): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaed8400>]}
2021-06-25 10:53:55.336626 (Thread-404): sending response (<Response 1303 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:53:55.344076 (Thread-405): handling status request
2021-06-25 10:53:55.344276 (Thread-405): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c6cc40>]}
2021-06-25 10:53:55.344685 (Thread-405): sending response (<Response 1303 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:53:55.404458 (Thread-406): handling status request
2021-06-25 10:53:55.404730 (Thread-406): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8ae93d0>]}
2021-06-25 10:53:55.405238 (Thread-406): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:55:26.819968 (Thread-407): Got an acceptable cached parse result
2021-06-25 10:55:26.993933 (Thread-407): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:55:26.997564 (Thread-407): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb810a190>]}
2021-06-25 10:55:27.316496 (Thread-408): handling status request
2021-06-25 10:55:27.317374 (Thread-409): handling status request
2021-06-25 10:55:27.317541 (Thread-408): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb810a5e0>]}
2021-06-25 10:55:27.317796 (Thread-409): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab1892b0>]}
2021-06-25 10:55:27.318353 (Thread-408): sending response (<Response 1303 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:55:27.318842 (Thread-409): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.7
2021-06-25 10:55:27.352819 (Thread-410): handling status request
2021-06-25 10:55:27.353072 (Thread-410): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb810ae20>]}
2021-06-25 10:55:27.353532 (Thread-410): sending response (<Response 1303 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:55:37.565994 (Thread-411): handling status request
2021-06-25 10:55:37.566284 (Thread-411): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab11a8b0>]}
2021-06-25 10:55:37.566779 (Thread-411): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.45
2021-06-25 10:55:37.623884 (Thread-412): handling status request
2021-06-25 10:55:37.624136 (Thread-412): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf71e20>]}
2021-06-25 10:55:37.624620 (Thread-412): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.72
2021-06-25 10:55:37.848664 (Thread-413): handling cli_args request
2021-06-25 10:55:37.848971 (Thread-413): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf71880>]}
2021-06-25 10:55:39.646281 (Thread-413): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:55:39.681582 (MainThread): Partial parsing not enabled
2021-06-25 10:55:39.684053 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:55:39.709294 (MainThread): Parsing macros/etc.sql
2021-06-25 10:55:39.711468 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:55:39.717443 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:55:39.721956 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:55:39.731621 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:55:39.743911 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:55:39.746667 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:55:39.748576 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:55:39.752186 (MainThread): Parsing macros/core.sql
2021-06-25 10:55:39.756511 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:55:39.766193 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:55:39.780100 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:55:39.782098 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:55:39.799855 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:55:39.831564 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:55:39.836750 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:55:39.843390 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:55:39.864259 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:55:39.871090 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:55:39.873157 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:55:39.879743 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:55:39.882022 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:55:39.883368 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:55:39.893561 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:55:39.894883 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:55:39.896822 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:55:39.899102 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:55:39.900801 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:55:39.903866 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:55:39.906020 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:55:39.907914 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:55:39.959018 (MainThread): Partial parsing not enabled
2021-06-25 10:55:39.993118 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:55:40.004609 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:55:40.009296 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:55:40.014009 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:55:40.020251 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:55:40.087650 (Thread-414): handling poll request
2021-06-25 10:55:40.088000 (Thread-414): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a998b0>]}
2021-06-25 10:55:40.089481 (Thread-414): sending response (<Response 11149 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:55:40.155169 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:55:40.155562 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '806e66d1-4336-408d-b0ff-061a707b9382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0e57970>]}
2021-06-25 10:55:40.187054 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '806e66d1-4336-408d-b0ff-061a707b9382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0f83940>]}
2021-06-25 10:55:40.187373 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:55:40.188121 (MainThread): 
2021-06-25 10:55:40.188395 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:55:40.189416 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 10:55:40.189544 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 10:55:40.365234 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:55:40.365379 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 10:55:40.563973 (MainThread): 10:55:40 | Concurrency: 1 threads (target='default')
2021-06-25 10:55:40.564108 (MainThread): 10:55:40 | 
2021-06-25 10:55:40.566082 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 10:55:40.566348 (Thread-1): 10:55:40 | 1 of 5 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 10:55:40.566562 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:55:40.566638 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 10:55:40.567960 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 10:55:40.583879 (Thread-1): finished collecting timing info
2021-06-25 10:55:40.610563 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 10:55:40.629778 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:55:40.634245 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 10:55:41.514742 (Thread-415): handling poll request
2021-06-25 10:55:41.515050 (Thread-415): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8083730>]}
2021-06-25 10:55:41.515859 (Thread-415): sending response (<Response 8187 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:55:41.561306 (Thread-1): finished collecting timing info
2021-06-25 10:55:41.561680 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806e66d1-4336-408d-b0ff-061a707b9382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0e99190>]}
2021-06-25 10:55:41.562110 (Thread-1): 10:55:41 | 1 of 5 OK created view model dbt_mskonberg.stg_orders................ [OK in 1.00s]
2021-06-25 10:55:41.562184 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 10:55:41.562282 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 10:55:41.562414 (Thread-1): 10:55:41 | 2 of 5 START view model dbt_mskonberg.stg_payments................... [RUN]
2021-06-25 10:55:41.562587 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:55:41.562651 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 10:55:41.563675 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 10:55:41.580699 (Thread-1): finished collecting timing info
2021-06-25 10:55:41.582397 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 10:55:41.600676 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:55:41.604938 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
  OPTIONS()
  as with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial.stripe.payment`

)

select * from payments;


2021-06-25 10:55:42.543002 (Thread-1): finished collecting timing info
2021-06-25 10:55:42.543376 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806e66d1-4336-408d-b0ff-061a707b9382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0ee2490>]}
2021-06-25 10:55:42.543667 (Thread-1): 10:55:42 | 2 of 5 OK created view model dbt_mskonberg.stg_payments.............. [OK in 0.98s]
2021-06-25 10:55:42.543755 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 10:55:42.543855 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 10:55:42.543998 (Thread-1): 10:55:42 | 3 of 5 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 10:55:42.544198 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:55:42.544265 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 10:55:42.545361 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 10:55:42.564060 (Thread-1): finished collecting timing info
2021-06-25 10:55:42.565909 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 10:55:42.583241 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:55:42.587540 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 10:55:42.922186 (Thread-416): handling poll request
2021-06-25 10:55:42.922481 (Thread-416): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb810a610>]}
2021-06-25 10:55:42.923338 (Thread-416): sending response (<Response 11815 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:55:43.444841 (Thread-1): finished collecting timing info
2021-06-25 10:55:43.445222 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806e66d1-4336-408d-b0ff-061a707b9382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0e99190>]}
2021-06-25 10:55:43.445510 (Thread-1): 10:55:43 | 3 of 5 OK created view model dbt_mskonberg.stg_customers............. [OK in 0.90s]
2021-06-25 10:55:43.445582 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 10:55:43.445701 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 10:55:43.445839 (Thread-1): 10:55:43 | 4 of 5 START table model dbt_mskonberg.fct_orders.................... [RUN]
2021-06-25 10:55:43.446028 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:55:43.446097 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 10:55:43.452019 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 10:55:43.469945 (Thread-1): finished collecting timing info
2021-06-25 10:55:43.483678 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:55:43.834785 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 10:55:43.850922 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`
  
  
  OPTIONS()
  as (
    --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
    
2021-06-25 10:55:44.173317 (Thread-417): handling poll request
2021-06-25 10:55:44.173600 (Thread-417): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80b3160>]}
2021-06-25 10:55:44.174304 (Thread-417): sending response (<Response 6453 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:55:45.449913 (Thread-418): handling poll request
2021-06-25 10:55:45.450239 (Thread-418): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a6d3d0>]}
2021-06-25 10:55:45.450773 (Thread-418): sending response (<Response 285 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:55:46.739701 (Thread-419): handling poll request
2021-06-25 10:55:46.740033 (Thread-419): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a6d730>]}
2021-06-25 10:55:46.740607 (Thread-419): sending response (<Response 285 bytes [200 OK]>) to 10.0.40.72
2021-06-25 10:55:47.925365 (Thread-1): finished collecting timing info
2021-06-25 10:55:47.925786 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806e66d1-4336-408d-b0ff-061a707b9382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0ef77c0>]}
2021-06-25 10:55:47.926146 (Thread-1): 10:55:47 | 4 of 5 OK created table model dbt_mskonberg.fct_orders............... [CREATE TABLE (99.0 rows, 5.2 KB processed) in 4.48s]
2021-06-25 10:55:47.926271 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 10:55:47.927162 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 10:55:47.927458 (Thread-1): 10:55:47 | 5 of 5 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-25 10:55:47.927769 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:55:47.927892 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 10:55:47.931966 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 10:55:47.948244 (Thread-1): finished collecting timing info
2021-06-25 10:55:47.950288 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:55:48.111862 (Thread-420): handling poll request
2021-06-25 10:55:48.112151 (Thread-420): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8041370>]}
2021-06-25 10:55:48.112856 (Thread-420): sending response (<Response 4941 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:55:48.162183 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 10:55:48.180463 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders
    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 10:55:49.407032 (Thread-421): handling poll request
2021-06-25 10:55:49.407320 (Thread-421): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8083670>]}
2021-06-25 10:55:49.407874 (Thread-421): sending response (<Response 2206 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:55:50.729190 (Thread-422): handling poll request
2021-06-25 10:55:50.729479 (Thread-422): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8083ee0>]}
2021-06-25 10:55:50.730046 (Thread-422): sending response (<Response 286 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:55:51.321577 (Thread-1): finished collecting timing info
2021-06-25 10:55:51.322007 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '806e66d1-4336-408d-b0ff-061a707b9382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7c0f033d0>]}
2021-06-25 10:55:51.322297 (Thread-1): 10:55:51 | 5 of 5 OK created table model dbt_mskonberg.dim_customers............ [CREATE TABLE (100.0 rows, 5.0 KB processed) in 3.39s]
2021-06-25 10:55:51.322369 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 10:55:51.323710 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:55:51.323988 (MainThread): 10:55:51 | 
2021-06-25 10:55:51.324051 (MainThread): 10:55:51 | Finished running 3 view models, 2 table models in 11.14s.
2021-06-25 10:55:51.324097 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:55:51.324135 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 10:55:51.382598 (MainThread): 
2021-06-25 10:55:51.382755 (MainThread): Completed successfully
2021-06-25 10:55:51.382828 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-06-25 10:55:52.163026 (Thread-423): handling poll request
2021-06-25 10:55:52.163313 (Thread-423): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b8a6a0>]}
2021-06-25 10:55:52.164626 (Thread-423): sending response (<Response 19498 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:55:52.889004 (Thread-424): handling status request
2021-06-25 10:55:52.889295 (Thread-424): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b8a340>]}
2021-06-25 10:55:52.889862 (Thread-424): sending response (<Response 1303 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:55:52.948863 (Thread-425): handling status request
2021-06-25 10:55:52.949141 (Thread-425): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b8a430>]}
2021-06-25 10:55:52.952503 (Thread-426): handling status request
2021-06-25 10:55:52.952771 (Thread-426): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a6d760>]}
2021-06-25 10:55:52.977837 (Thread-425): sending response (<Response 1303 bytes [200 OK]>) to 10.0.45.5
2021-06-25 10:55:52.978353 (Thread-426): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.7
2021-06-25 10:55:58.026535 (Thread-427): handling status request
2021-06-25 10:55:58.026828 (Thread-427): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b8a1f0>]}
2021-06-25 10:55:58.027337 (Thread-427): sending response (<Response 1303 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:55:58.116806 (Thread-428): handling status request
2021-06-25 10:55:58.117087 (Thread-428): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b8acd0>]}
2021-06-25 10:55:58.117575 (Thread-428): sending response (<Response 1303 bytes [200 OK]>) to 10.0.10.110
2021-06-25 10:55:58.251571 (Thread-429): handling cli_args request
2021-06-25 10:55:58.251876 (Thread-429): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b8a610>]}
2021-06-25 10:56:00.114908 (Thread-429): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.22
2021-06-25 10:56:00.151242 (MainThread): Partial parsing not enabled
2021-06-25 10:56:00.153743 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:56:00.174024 (MainThread): Parsing macros/etc.sql
2021-06-25 10:56:00.176108 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:56:00.182153 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:56:00.186655 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:56:00.196348 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:56:00.208492 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:56:00.211209 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:56:00.213006 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:56:00.216456 (MainThread): Parsing macros/core.sql
2021-06-25 10:56:00.220332 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:56:00.229196 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:56:00.243403 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:56:00.245204 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:56:00.262348 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:56:00.292734 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:56:00.297535 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:56:00.303604 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:56:00.315616 (Thread-430): handling poll request
2021-06-25 10:56:00.315879 (Thread-430): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb816d9d0>]}
2021-06-25 10:56:00.316885 (Thread-430): sending response (<Response 5518 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:56:00.323961 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:56:00.330589 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:56:00.332400 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:56:00.338456 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:56:00.340795 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:56:00.342216 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:56:00.351140 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:56:00.352132 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:56:00.353835 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:56:00.355821 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:56:00.357375 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:56:00.360120 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:56:00.362088 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:56:00.363930 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:56:00.414100 (MainThread): Partial parsing not enabled
2021-06-25 10:56:00.447632 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:56:00.459032 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:56:00.463621 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:56:00.468455 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:56:00.474907 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:56:00.606656 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:56:00.607019 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '585c2354-c277-4388-92aa-1ddb3733daa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edd340940>]}
2021-06-25 10:56:00.633623 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '585c2354-c277-4388-92aa-1ddb3733daa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edd44ebe0>]}
2021-06-25 10:56:00.633878 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:56:00.634553 (MainThread): 
2021-06-25 10:56:00.634801 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:56:00.635953 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:56:00.636051 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 10:56:00.820525 (MainThread): 10:56:00 | Concurrency: 1 threads (target='default')
2021-06-25 10:56:00.820662 (MainThread): 10:56:00 | 
2021-06-25 10:56:00.822905 (Thread-1): Began running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:56:00.823068 (Thread-1): 10:56:00 | 1 of 3 START test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending [RUN]
2021-06-25 10:56:00.823298 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 10:56:00.823382 (Thread-1): Compiling test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:56:00.829194 (Thread-1): finished collecting timing info
2021-06-25 10:56:00.829482 (Thread-1): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/dist-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
jinja2.exceptions.UndefinedError: 'test_accepted' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 509, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 410, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 582, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 533, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 506, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
  'test_accepted' is undefined
2021-06-25 10:56:00.830921 (Thread-1): 10:56:00 | 1 of 3 ERROR accepted_stg_orders_status__returned__completed__shipped__placed__return_pending [ERROR in 0.01s]
2021-06-25 10:56:00.830995 (Thread-1): Finished running node test.jaffle_shop.accepted_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:56:00.831096 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 10:56:00.831172 (Thread-1): 10:56:00 | 2 of 3 START test not_null_stg_customers_customer_id................. [RUN]
2021-06-25 10:56:00.831356 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-06-25 10:56:00.831426 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 10:56:00.837703 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-06-25 10:56:00.854895 (Thread-1): finished collecting timing info
2021-06-25 10:56:00.855058 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:56:00.859320 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
where customer_id is null



2021-06-25 10:56:01.540663 (Thread-431): handling poll request
2021-06-25 10:56:01.540954 (Thread-431): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80411c0>]}
2021-06-25 10:56:01.542055 (Thread-431): sending response (<Response 20512 bytes [200 OK]>) to 10.0.24.126
2021-06-25 10:56:02.116325 (Thread-1): finished collecting timing info
2021-06-25 10:56:02.116981 (Thread-1): 10:56:02 | 2 of 3 PASS not_null_stg_customers_customer_id....................... [PASS in 1.29s]
2021-06-25 10:56:02.117075 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 10:56:02.117181 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 10:56:02.117261 (Thread-1): 10:56:02 | 3 of 3 START test unique_stg_customers_customer_id................... [RUN]
2021-06-25 10:56:02.117430 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-06-25 10:56:02.117500 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 10:56:02.124321 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-06-25 10:56:02.142066 (Thread-1): finished collecting timing info
2021-06-25 10:56:02.142235 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:56:02.146657 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-06-25 10:56:02.847317 (Thread-432): handling poll request
2021-06-25 10:56:02.847606 (Thread-432): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab583910>]}
2021-06-25 10:56:02.848275 (Thread-432): sending response (<Response 5540 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:56:03.717501 (Thread-1): finished collecting timing info
2021-06-25 10:56:03.717962 (Thread-1): 10:56:03 | 3 of 3 PASS unique_stg_customers_customer_id......................... [PASS in 1.60s]
2021-06-25 10:56:03.718051 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 10:56:03.719471 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:56:03.719767 (MainThread): 10:56:03 | 
2021-06-25 10:56:03.719840 (MainThread): 10:56:03 | Finished running 3 tests in 3.09s.
2021-06-25 10:56:03.719890 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:56:03.719932 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id' was properly closed.
2021-06-25 10:56:03.780301 (MainThread): 
2021-06-25 10:56:03.780453 (MainThread): Completed with 1 error and 0 warnings:
2021-06-25 10:56:03.780512 (MainThread): 
2021-06-25 10:56:03.780566 (MainThread): Compilation Error in test accepted_stg_orders_status__returned__completed__shipped__placed__return_pending (models/staging/jaffle_shop/stg_jaffle_shop.yml)
2021-06-25 10:56:03.780608 (MainThread):   'test_accepted' is undefined
2021-06-25 10:56:03.780660 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2021-06-25 10:56:04.201960 (Thread-433): handling poll request
2021-06-25 10:56:04.202261 (Thread-433): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaafbb7c0>]}
2021-06-25 10:56:04.203555 (Thread-433): sending response (<Response 12396 bytes [200 OK]>) to 10.0.47.156
2021-06-25 10:56:04.802108 (Thread-434): handling status request
2021-06-25 10:56:04.802403 (Thread-434): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab13bf40>]}
2021-06-25 10:56:04.802951 (Thread-434): sending response (<Response 1303 bytes [200 OK]>) to 10.0.12.250
2021-06-25 10:56:04.855510 (Thread-435): handling status request
2021-06-25 10:56:04.855789 (Thread-435): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf3c2e0>]}
2021-06-25 10:56:04.856285 (Thread-435): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.72
2021-06-25 10:56:04.887916 (Thread-436): handling status request
2021-06-25 10:56:04.888148 (Thread-436): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf3c4f0>]}
2021-06-25 10:56:04.888598 (Thread-436): sending response (<Response 1303 bytes [200 OK]>) to 10.0.3.5
2021-06-25 10:57:20.195639 (Thread-437): Got an acceptable cached parse result
2021-06-25 10:57:20.511952 (Thread-437): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:57:20.512515 (Thread-437): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaadae340>]}
2021-06-25 10:57:20.888151 (Thread-438): handling status request
2021-06-25 10:57:20.889239 (Thread-439): handling status request
2021-06-25 10:57:20.889423 (Thread-438): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaadae700>]}
2021-06-25 10:57:20.890332 (Thread-439): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81e2760>]}
2021-06-25 10:57:20.890881 (Thread-438): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:57:20.891657 (Thread-439): sending response (<Response 1303 bytes [200 OK]>) to 10.0.45.5
2021-06-25 10:57:20.904484 (Thread-440): handling status request
2021-06-25 10:57:20.904739 (Thread-440): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaad9fbe0>]}
2021-06-25 10:57:20.905294 (Thread-440): sending response (<Response 1303 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:57:25.754988 (Thread-441): handling status request
2021-06-25 10:57:25.755302 (Thread-441): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaadb2730>]}
2021-06-25 10:57:25.755845 (Thread-441): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:57:25.848975 (Thread-442): handling status request
2021-06-25 10:57:25.849265 (Thread-442): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaadb2820>]}
2021-06-25 10:57:25.849818 (Thread-442): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.7
2021-06-25 10:57:25.973270 (Thread-443): handling cli_args request
2021-06-25 10:57:25.973553 (Thread-443): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaadb2100>]}
2021-06-25 10:57:27.784184 (Thread-443): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.80
2021-06-25 10:57:27.819702 (MainThread): Partial parsing not enabled
2021-06-25 10:57:27.822067 (MainThread): Parsing macros/adapters.sql
2021-06-25 10:57:27.842343 (MainThread): Parsing macros/etc.sql
2021-06-25 10:57:27.844445 (MainThread): Parsing macros/catalog.sql
2021-06-25 10:57:27.850478 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 10:57:27.854953 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 10:57:27.864702 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 10:57:27.876786 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 10:57:27.879482 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 10:57:27.881288 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 10:57:27.884720 (MainThread): Parsing macros/core.sql
2021-06-25 10:57:27.888537 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 10:57:27.897356 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 10:57:27.911214 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 10:57:27.913024 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 10:57:27.930203 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 10:57:27.961681 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 10:57:27.966756 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 10:57:27.972844 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 10:57:27.993017 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 10:57:27.999566 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 10:57:28.001408 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 10:57:28.007284 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 10:57:28.008906 (MainThread): Parsing macros/etc/query.sql
2021-06-25 10:57:28.010003 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 10:57:28.018481 (Thread-444): handling poll request
2021-06-25 10:57:28.018754 (Thread-444): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab13bf10>]}
2021-06-25 10:57:28.019944 (Thread-444): sending response (<Response 7179 bytes [200 OK]>) to 10.0.42.69
2021-06-25 10:57:28.018964 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 10:57:28.019957 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 10:57:28.021674 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 10:57:28.023630 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 10:57:28.025161 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 10:57:28.027877 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 10:57:28.029841 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 10:57:28.031602 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 10:57:28.080576 (MainThread): Partial parsing not enabled
2021-06-25 10:57:28.114770 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 10:57:28.126435 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 10:57:28.131022 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 10:57:28.136426 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 10:57:28.142772 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 10:57:28.276306 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 10:57:28.276675 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70a2157d-fe34-413a-abea-21f86b87ade0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb0ad439d0>]}
2021-06-25 10:57:28.312519 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70a2157d-fe34-413a-abea-21f86b87ade0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb0af93ca0>]}
2021-06-25 10:57:28.312771 (MainThread): Found 5 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 10:57:28.313451 (MainThread): 
2021-06-25 10:57:28.313725 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:57:28.314882 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 10:57:28.314980 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 10:57:28.497800 (MainThread): 10:57:28 | Concurrency: 1 threads (target='default')
2021-06-25 10:57:28.497926 (MainThread): 10:57:28 | 
2021-06-25 10:57:28.500091 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:57:28.500264 (Thread-1): 10:57:28 | 1 of 3 START test accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending [RUN]
2021-06-25 10:57:28.500487 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 10:57:28.500566 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:57:28.510541 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-25 10:57:28.523209 (Thread-1): finished collecting timing info
2021-06-25 10:57:28.523360 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:57:28.527535 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'returned','completed','shipped','placed','return_pending'
    )
)

select count(*) as validation_errors
from validation_errors



2021-06-25 10:57:29.410997 (Thread-445): handling poll request
2021-06-25 10:57:29.411298 (Thread-445): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaadb2220>]}
2021-06-25 10:57:29.412205 (Thread-445): sending response (<Response 12603 bytes [200 OK]>) to 10.0.21.135
2021-06-25 10:57:29.889795 (Thread-1): finished collecting timing info
2021-06-25 10:57:29.890224 (Thread-1): 10:57:29 | 1 of 3 PASS accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending [PASS in 1.39s]
2021-06-25 10:57:29.890310 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 10:57:29.890410 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 10:57:29.890493 (Thread-1): 10:57:29 | 2 of 3 START test not_null_stg_customers_customer_id................. [RUN]
2021-06-25 10:57:29.890667 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-06-25 10:57:29.890734 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 10:57:29.897312 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-06-25 10:57:29.917034 (Thread-1): finished collecting timing info
2021-06-25 10:57:29.917193 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:57:29.921467 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
where customer_id is null



2021-06-25 10:57:30.691217 (Thread-446): handling poll request
2021-06-25 10:57:30.691505 (Thread-446): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaadae7f0>]}
2021-06-25 10:57:30.692180 (Thread-446): sending response (<Response 5683 bytes [200 OK]>) to 10.0.40.72
2021-06-25 10:57:30.954389 (Thread-1): finished collecting timing info
2021-06-25 10:57:30.954811 (Thread-1): 10:57:30 | 2 of 3 PASS not_null_stg_customers_customer_id....................... [PASS in 1.06s]
2021-06-25 10:57:30.954902 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 10:57:30.955000 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 10:57:30.955083 (Thread-1): 10:57:30 | 3 of 3 START test unique_stg_customers_customer_id................... [RUN]
2021-06-25 10:57:30.955258 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-06-25 10:57:30.955328 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 10:57:30.963056 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-06-25 10:57:30.982015 (Thread-1): finished collecting timing info
2021-06-25 10:57:30.982165 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 10:57:30.986427 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-06-25 10:57:31.980912 (Thread-1): finished collecting timing info
2021-06-25 10:57:31.981329 (Thread-1): 10:57:31 | 3 of 3 PASS unique_stg_customers_customer_id......................... [PASS in 1.03s]
2021-06-25 10:57:31.981409 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 10:57:31.982731 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 10:57:31.982990 (MainThread): 10:57:31 | 
2021-06-25 10:57:31.983057 (MainThread): 10:57:31 | Finished running 3 tests in 3.67s.
2021-06-25 10:57:31.983106 (MainThread): Connection 'master' was properly closed.
2021-06-25 10:57:31.983153 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id' was properly closed.
2021-06-25 10:57:32.012556 (Thread-447): handling poll request
2021-06-25 10:57:32.012817 (Thread-447): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaabb7d30>]}
2021-06-25 10:57:32.013559 (Thread-447): sending response (<Response 8288 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:57:32.043998 (MainThread): 
2021-06-25 10:57:32.044153 (MainThread): Completed successfully
2021-06-25 10:57:32.044221 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-06-25 10:57:33.507030 (Thread-448): handling poll request
2021-06-25 10:57:33.507308 (Thread-448): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaac100a0>]}
2021-06-25 10:57:33.508451 (Thread-448): sending response (<Response 9088 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:57:34.289701 (Thread-449): handling status request
2021-06-25 10:57:34.289988 (Thread-449): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaac10730>]}
2021-06-25 10:57:34.290515 (Thread-449): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.142
2021-06-25 10:57:34.351604 (Thread-450): handling status request
2021-06-25 10:57:34.351854 (Thread-450): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaac10700>]}
2021-06-25 10:57:34.352319 (Thread-450): sending response (<Response 1303 bytes [200 OK]>) to 10.0.40.2
2021-06-25 10:57:34.379679 (Thread-451): handling status request
2021-06-25 10:57:34.380151 (Thread-451): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaafe820>]}
2021-06-25 10:57:34.380675 (Thread-451): sending response (<Response 1303 bytes [200 OK]>) to 10.0.26.142
2021-06-25 12:08:09.281725 (Thread-452): Got an acceptable cached parse result
2021-06-25 12:08:09.319849 (Thread-452): Acquiring new bigquery connection "model.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:08:09.441775 (Thread-452): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:08:09.442368 (Thread-452): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf977f0>]}
2021-06-25 12:08:09.697197 (Thread-453): handling status request
2021-06-25 12:08:09.697485 (Thread-453): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf979a0>]}
2021-06-25 12:08:09.698055 (Thread-453): sending response (<Response 1632 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:08:09.750558 (Thread-454): handling status request
2021-06-25 12:08:09.750881 (Thread-454): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf97190>]}
2021-06-25 12:08:09.751391 (Thread-454): sending response (<Response 1632 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:08:09.777516 (Thread-455): handling status request
2021-06-25 12:08:09.777816 (Thread-455): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf971f0>]}
2021-06-25 12:08:09.802957 (Thread-455): sending response (<Response 1632 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:10:56.329289 (Thread-456): handling status request
2021-06-25 12:10:56.331064 (Thread-456): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbb494250>]}
2021-06-25 12:10:56.331621 (Thread-456): sending response (<Response 1632 bytes [200 OK]>) to 10.0.21.203
2021-06-25 12:10:56.669397 (Thread-457): handling run_sql request
2021-06-25 12:10:56.669745 (Thread-457): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf97190>]}
2021-06-25 12:10:56.670886 (Thread-457): Connection 'model.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-06-25 12:10:58.462643 (Thread-457): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:10:58.473937 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:10:58.488598 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '654bfc85-6399-49a5-bca0-2b49ec0ef860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc1964cd0>]}
2021-06-25 12:10:58.488842 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:10:58.489241 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:10:58.489345 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 12:10:58.491273 (Thread-1): finished collecting timing info
2021-06-25 12:10:58.491396 (Thread-1): Opening a new connection, currently in state init
2021-06-25 12:10:58.495835 (Thread-1): On rpc.jaffle_shop.request: select
    order_id,
    sum(amount)
from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
group by 1
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 12:10:58.760474 (Thread-458): handling poll request
2021-06-25 12:10:58.760795 (Thread-458): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab157e20>]}
2021-06-25 12:10:58.761814 (Thread-458): sending response (<Response 3194 bytes [200 OK]>) to 10.0.26.7
2021-06-25 12:10:59.807485 (Thread-1): finished collecting timing info
2021-06-25 12:11:00.015129 (Thread-459): handling poll request
2021-06-25 12:11:00.015430 (Thread-459): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8abee20>]}
2021-06-25 12:11:00.016631 (Thread-459): sending response (<Response 4411 bytes [200 OK]>) to 10.0.45.5
2021-06-25 12:11:19.849729 (Thread-460): handling status request
2021-06-25 12:11:19.850053 (Thread-460): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb80c4e50>]}
2021-06-25 12:11:19.850644 (Thread-460): sending response (<Response 1632 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:11:20.145842 (Thread-461): handling run_sql request
2021-06-25 12:11:20.146190 (Thread-461): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab1572e0>]}
2021-06-25 12:11:21.973272 (Thread-461): sending response (<Response 138 bytes [200 OK]>) to 10.0.10.110
2021-06-25 12:11:21.984650 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:11:21.996248 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '236d6bf8-cc6f-41c8-bd6f-993f7628c43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8722a2fcd0>]}
2021-06-25 12:11:21.996539 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:11:21.996973 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:11:21.997076 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 12:11:21.998983 (Thread-1): finished collecting timing info
2021-06-25 12:11:21.999107 (Thread-1): Opening a new connection, currently in state init
2021-06-25 12:11:22.003637 (Thread-1): On rpc.jaffle_shop.request: select
    order_id,
    sum(amount) as amount_sum
from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
group by 1
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 12:11:22.259081 (Thread-462): handling poll request
2021-06-25 12:11:22.259421 (Thread-462): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7bf2e0>]}
2021-06-25 12:11:22.261042 (Thread-462): sending response (<Response 3208 bytes [200 OK]>) to 10.0.45.5
2021-06-25 12:11:23.585519 (Thread-463): handling poll request
2021-06-25 12:11:23.585846 (Thread-463): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8abe370>]}
2021-06-25 12:11:23.586411 (Thread-463): sending response (<Response 427 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:11:23.800193 (Thread-1): finished collecting timing info
2021-06-25 12:11:24.914886 (Thread-464): handling poll request
2021-06-25 12:11:24.915181 (Thread-464): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f4f190>]}
2021-06-25 12:11:24.916340 (Thread-464): sending response (<Response 4471 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:11:37.901004 (Thread-465): handling status request
2021-06-25 12:11:37.901296 (Thread-465): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f4fc40>]}
2021-06-25 12:11:37.901892 (Thread-465): sending response (<Response 1632 bytes [200 OK]>) to 10.0.47.156
2021-06-25 12:11:38.139083 (Thread-466): handling run_sql request
2021-06-25 12:11:38.139368 (Thread-466): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f4f6d0>]}
2021-06-25 12:11:39.958673 (Thread-466): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:11:39.970019 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:11:39.981257 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a77861f-2fcd-4674-9db4-15b8e6028bf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe1eec0d90>]}
2021-06-25 12:11:39.981484 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:11:39.981898 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:11:39.982001 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 12:11:39.984188 (Thread-1): finished collecting timing info
2021-06-25 12:11:39.984306 (Thread-1): Opening a new connection, currently in state init
2021-06-25 12:11:39.989010 (Thread-1): On rpc.jaffle_shop.request: select
    order_id,
    sum(amount) as amount_sum
from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
group by 1
order by amount_sum DESC
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 12:11:40.261341 (Thread-467): handling poll request
2021-06-25 12:11:40.261699 (Thread-467): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8105820>]}
2021-06-25 12:11:40.262721 (Thread-467): sending response (<Response 3234 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:11:41.475031 (Thread-1): finished collecting timing info
2021-06-25 12:11:41.486531 (Thread-468): handling poll request
2021-06-25 12:11:41.486820 (Thread-468): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab77f220>]}
2021-06-25 12:11:41.487389 (Thread-468): sending response (<Response 836 bytes [200 OK]>) to 10.0.26.142
2021-06-25 12:11:42.813263 (Thread-469): handling poll request
2021-06-25 12:11:42.813568 (Thread-469): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab77f190>]}
2021-06-25 12:11:42.814732 (Thread-469): sending response (<Response 4173 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:11:48.952601 (Thread-470): handling status request
2021-06-25 12:11:48.952980 (Thread-470): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab77f130>]}
2021-06-25 12:11:48.953745 (Thread-470): sending response (<Response 1632 bytes [200 OK]>) to 10.0.26.7
2021-06-25 12:11:49.172525 (Thread-471): handling run_sql request
2021-06-25 12:11:49.172816 (Thread-471): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab77feb0>]}
2021-06-25 12:11:50.963767 (Thread-471): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.142
2021-06-25 12:11:50.974218 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:11:50.985469 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7fb2b29-226f-4231-bee1-ab3db3234c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe769ee5c70>]}
2021-06-25 12:11:50.985720 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:11:50.986106 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:11:50.986207 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 12:11:50.988039 (Thread-1): finished collecting timing info
2021-06-25 12:11:50.988160 (Thread-1): Opening a new connection, currently in state init
2021-06-25 12:11:50.992616 (Thread-1): On rpc.jaffle_shop.request: select
    order_id,
    sum(amount) as amount_sum
from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
group by 1
order by amount_sum
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 12:11:51.291600 (Thread-472): handling poll request
2021-06-25 12:11:51.291924 (Thread-472): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8105280>]}
2021-06-25 12:11:51.292910 (Thread-472): sending response (<Response 3229 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:11:52.534617 (Thread-473): handling poll request
2021-06-25 12:11:52.534906 (Thread-473): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f4ff40>]}
2021-06-25 12:11:52.535424 (Thread-473): sending response (<Response 427 bytes [200 OK]>) to 10.0.26.7
2021-06-25 12:11:53.851409 (Thread-474): handling poll request
2021-06-25 12:11:53.851693 (Thread-474): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f4fdc0>]}
2021-06-25 12:11:53.852207 (Thread-474): sending response (<Response 427 bytes [200 OK]>) to 10.0.45.5
2021-06-25 12:11:55.100108 (Thread-1): finished collecting timing info
2021-06-25 12:11:55.105011 (Thread-475): handling poll request
2021-06-25 12:11:55.105269 (Thread-475): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a582b0>]}
2021-06-25 12:11:55.105821 (Thread-475): sending response (<Response 836 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:11:56.357695 (Thread-476): handling poll request
2021-06-25 12:11:56.358033 (Thread-476): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a58190>]}
2021-06-25 12:11:56.359159 (Thread-476): sending response (<Response 4152 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:13:13.901731 (Thread-477): handling status request
2021-06-25 12:13:13.904029 (Thread-477): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6fc8b0>]}
2021-06-25 12:13:13.904597 (Thread-477): sending response (<Response 1632 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:13:14.142679 (Thread-478): handling run_sql request
2021-06-25 12:13:14.142966 (Thread-478): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6fcfd0>]}
2021-06-25 12:13:15.934570 (Thread-478): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:13:15.945485 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:13:15.959522 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52c0026e-e7f9-44be-826a-50bbed6bf16d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b14f92d60>]}
2021-06-25 12:13:15.959749 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:13:15.960146 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:13:15.960249 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 12:13:15.962121 (Thread-1): finished collecting timing info
2021-06-25 12:13:15.962238 (Thread-1): Opening a new connection, currently in state init
2021-06-25 12:13:15.966897 (Thread-1): On rpc.jaffle_shop.request: select
    order_id,
    sum(amount) as total_amount
from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
group by 1
having not(total_amount >= 0)
limit 500
/* limit added automatically by dbt cloud */
2021-06-25 12:13:16.220154 (Thread-479): handling poll request
2021-06-25 12:13:16.220483 (Thread-479): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8c7ff10>]}
2021-06-25 12:13:16.221511 (Thread-479): sending response (<Response 3241 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:13:17.557837 (Thread-1): finished collecting timing info
2021-06-25 12:13:17.575346 (Thread-480): handling poll request
2021-06-25 12:13:17.575639 (Thread-480): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8172040>]}
2021-06-25 12:13:17.576202 (Thread-480): sending response (<Response 836 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:13:18.893795 (Thread-481): handling poll request
2021-06-25 12:13:18.894094 (Thread-481): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8172d60>]}
2021-06-25 12:13:18.894984 (Thread-481): sending response (<Response 2854 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:13:51.047169 (Thread-482): handling status request
2021-06-25 12:13:51.047456 (Thread-482): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8172940>]}
2021-06-25 12:13:51.048034 (Thread-482): sending response (<Response 1632 bytes [200 OK]>) to 10.0.21.203
2021-06-25 12:13:51.321572 (Thread-483): handling status request
2021-06-25 12:13:51.321901 (Thread-483): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8172df0>]}
2021-06-25 12:13:51.322420 (Thread-483): sending response (<Response 1632 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:13:51.366330 (Thread-484): handling cli_args request
2021-06-25 12:13:51.366573 (Thread-484): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8172cd0>]}
2021-06-25 12:13:53.191581 (Thread-484): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.142
2021-06-25 12:13:53.226995 (MainThread): Partial parsing not enabled
2021-06-25 12:13:53.229328 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:13:53.250305 (MainThread): Parsing macros/etc.sql
2021-06-25 12:13:53.252616 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:13:53.258719 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:13:53.263264 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:13:53.273319 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:13:53.285835 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:13:53.288514 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:13:53.290382 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:13:53.293870 (MainThread): Parsing macros/core.sql
2021-06-25 12:13:53.297765 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:13:53.306660 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:13:53.320665 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:13:53.322549 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:13:53.340351 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:13:53.371517 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:13:53.376779 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:13:53.382988 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:13:53.403200 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:13:53.409815 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:13:53.411698 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:13:53.417646 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:13:53.419331 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:13:53.420427 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:13:53.429123 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:13:53.430151 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:13:53.431821 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:13:53.433874 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:13:53.435492 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:13:53.438261 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:13:53.440241 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:13:53.442114 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:13:53.492691 (MainThread): Partial parsing not enabled
2021-06-25 12:13:53.528883 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:13:53.539839 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:13:53.544293 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:13:53.548740 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:13:53.553376 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:13:53.559561 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:13:53.568652 (Thread-485): handling poll request
2021-06-25 12:13:53.568924 (Thread-485): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9f9a0>]}
2021-06-25 12:13:53.594219 (Thread-485): sending response (<Response 11488 bytes [200 OK]>) to 10.0.45.5
2021-06-25 12:13:53.693693 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:13:53.694118 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f04f798-12cc-4725-8c94-717619ed0745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e3b906d30>]}
2021-06-25 12:13:53.725323 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f04f798-12cc-4725-8c94-717619ed0745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e3b8f3df0>]}
2021-06-25 12:13:53.725591 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:13:53.726034 (MainThread): The selector 'None' does not match any nodes and will be ignored
2021-06-25 12:13:53.726382 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-06-25 12:13:55.052933 (Thread-486): handling poll request
2021-06-25 12:13:55.053229 (Thread-486): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8150e50>]}
2021-06-25 12:13:55.053939 (Thread-486): sending response (<Response 2682 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:13:55.572939 (Thread-487): handling status request
2021-06-25 12:13:55.573234 (Thread-487): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4c6d30>]}
2021-06-25 12:13:55.573868 (Thread-487): sending response (<Response 1632 bytes [200 OK]>) to 10.0.47.156
2021-06-25 12:13:55.596121 (Thread-488): handling status request
2021-06-25 12:13:55.596323 (Thread-488): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4c6160>]}
2021-06-25 12:13:55.596759 (Thread-488): sending response (<Response 1632 bytes [200 OK]>) to 10.0.21.203
2021-06-25 12:13:55.665211 (Thread-489): handling status request
2021-06-25 12:13:55.665473 (Thread-489): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6fc3d0>]}
2021-06-25 12:13:55.666028 (Thread-489): sending response (<Response 1632 bytes [200 OK]>) to 10.0.26.7
2021-06-25 12:13:59.779633 (Thread-490): Got an acceptable cached parse result
2021-06-25 12:13:59.817165 (Thread-490): Acquiring new bigquery connection "model.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:13:59.944073 (Thread-490): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:13:59.944678 (Thread-490): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4ef430>]}
2021-06-25 12:14:00.149956 (Thread-491): handling status request
2021-06-25 12:14:00.150239 (Thread-491): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4ef190>]}
2021-06-25 12:14:00.150751 (Thread-491): sending response (<Response 1632 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:14:00.243710 (Thread-492): handling status request
2021-06-25 12:14:00.244024 (Thread-492): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4ef4f0>]}
2021-06-25 12:14:00.244551 (Thread-492): sending response (<Response 1632 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:14:00.256028 (Thread-493): handling status request
2021-06-25 12:14:00.256261 (Thread-493): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4efdf0>]}
2021-06-25 12:14:00.256765 (Thread-493): sending response (<Response 1632 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:14:04.933900 (Thread-494): handling status request
2021-06-25 12:14:04.934190 (Thread-494): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7b5490>]}
2021-06-25 12:14:04.934717 (Thread-494): sending response (<Response 1632 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:14:05.002646 (Thread-495): handling status request
2021-06-25 12:14:05.002931 (Thread-495): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7b5ac0>]}
2021-06-25 12:14:05.003432 (Thread-495): sending response (<Response 1632 bytes [200 OK]>) to 10.0.10.110
2021-06-25 12:14:05.168513 (Thread-496): handling cli_args request
2021-06-25 12:14:05.169170 (Thread-496): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9ec7e20>]}
2021-06-25 12:14:05.180301 (Thread-496): Connection 'model.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-06-25 12:14:06.995310 (Thread-496): sending response (<Response 138 bytes [200 OK]>) to 10.0.10.110
2021-06-25 12:14:07.031208 (MainThread): Partial parsing not enabled
2021-06-25 12:14:07.033632 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:14:07.054769 (MainThread): Parsing macros/etc.sql
2021-06-25 12:14:07.057024 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:14:07.063296 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:14:07.068003 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:14:07.077999 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:14:07.090443 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:14:07.093209 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:14:07.095145 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:14:07.098696 (MainThread): Parsing macros/core.sql
2021-06-25 12:14:07.102720 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:14:07.112047 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:14:07.126255 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:14:07.128114 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:14:07.146162 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:14:07.176645 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:14:07.181592 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:14:07.187874 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:14:07.208317 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:14:07.214926 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:14:07.216772 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:14:07.222756 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:14:07.224400 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:14:07.225491 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:14:07.234293 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:14:07.235313 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:14:07.236978 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:14:07.238961 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:14:07.240509 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:14:07.243266 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:14:07.245162 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:14:07.247004 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:14:07.297716 (MainThread): Partial parsing not enabled
2021-06-25 12:14:07.326985 (Thread-497): handling poll request
2021-06-25 12:14:07.327346 (Thread-497): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab40efd0>]}
2021-06-25 12:14:07.328986 (Thread-497): sending response (<Response 9643 bytes [200 OK]>) to 10.0.42.69
2021-06-25 12:14:07.331356 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:14:07.342391 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:14:07.346979 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:14:07.351544 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:14:07.357170 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:14:07.363473 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:14:07.496554 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:14:07.497098 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dfcfa64-e61f-4e5d-8b6d-cf0537ad7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53b1f4c0d0>]}
2021-06-25 12:14:07.529259 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dfcfa64-e61f-4e5d-8b6d-cf0537ad7a4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53b203f9a0>]}
2021-06-25 12:14:07.529563 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:14:07.530104 (MainThread): The selector 'None' does not match any nodes and will be ignored
2021-06-25 12:14:07.530485 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-06-25 12:14:08.662868 (Thread-498): handling poll request
2021-06-25 12:14:08.663138 (Thread-498): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2e91c0>]}
2021-06-25 12:14:08.664021 (Thread-498): sending response (<Response 4527 bytes [200 OK]>) to 10.0.36.19
2021-06-25 12:14:09.075445 (Thread-499): handling status request
2021-06-25 12:14:09.075735 (Thread-499): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2e9df0>]}
2021-06-25 12:14:09.076288 (Thread-499): sending response (<Response 1632 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:14:09.121294 (Thread-500): handling status request
2021-06-25 12:14:09.121567 (Thread-500): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2e9a30>]}
2021-06-25 12:14:09.122120 (Thread-500): sending response (<Response 1632 bytes [200 OK]>) to 10.0.47.156
2021-06-25 12:14:09.142706 (Thread-501): handling status request
2021-06-25 12:14:09.142972 (Thread-501): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0f95e0>]}
2021-06-25 12:14:09.143450 (Thread-501): sending response (<Response 1632 bytes [200 OK]>) to 10.0.31.198
2021-06-25 12:14:20.026985 (Thread-502): handling status request
2021-06-25 12:14:20.027279 (Thread-502): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3b0eb0>]}
2021-06-25 12:14:20.027785 (Thread-502): sending response (<Response 1632 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:14:20.279165 (Thread-503): handling compile_sql request
2021-06-25 12:14:20.279465 (Thread-503): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3b0e80>]}
2021-06-25 12:14:22.056435 (Thread-503): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.7
2021-06-25 12:14:22.067653 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:14:22.079075 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df5ed958-70ce-4033-bee3-2ee0aea207b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec123ffcd0>]}
2021-06-25 12:14:22.079324 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:14:22.079741 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-25 12:14:22.079849 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-25 12:14:22.081741 (Thread-1): finished collecting timing info
2021-06-25 12:14:22.081860 (Thread-1): finished collecting timing info
2021-06-25 12:14:22.300686 (Thread-504): handling poll request
2021-06-25 12:14:22.301082 (Thread-504): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7b5c40>]}
2021-06-25 12:14:22.302400 (Thread-504): sending response (<Response 5258 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:14:30.170050 (Thread-505): handling status request
2021-06-25 12:14:30.170345 (Thread-505): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab597880>]}
2021-06-25 12:14:30.170899 (Thread-505): sending response (<Response 1632 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:14:30.207247 (Thread-506): handling status request
2021-06-25 12:14:30.207517 (Thread-506): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab15a8e0>]}
2021-06-25 12:14:30.208012 (Thread-506): sending response (<Response 1632 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:14:30.415828 (Thread-507): handling cli_args request
2021-06-25 12:14:30.416111 (Thread-507): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab15a190>]}
2021-06-25 12:14:32.221536 (Thread-507): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:14:32.258268 (MainThread): Partial parsing not enabled
2021-06-25 12:14:32.260746 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:14:32.281617 (MainThread): Parsing macros/etc.sql
2021-06-25 12:14:32.283961 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:14:32.290332 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:14:32.294832 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:14:32.304786 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:14:32.317299 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:14:32.319985 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:14:32.321936 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:14:32.325812 (MainThread): Parsing macros/core.sql
2021-06-25 12:14:32.329881 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:14:32.339391 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:14:32.353440 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:14:32.355382 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:14:32.373235 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:14:32.404280 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:14:32.409244 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:14:32.415459 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:14:32.435941 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:14:32.442615 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:14:32.444495 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:14:32.450482 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:14:32.452113 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:14:32.453200 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:14:32.462342 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:14:32.463396 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:14:32.465184 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:14:32.467211 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:14:32.468747 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:14:32.471502 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:14:32.473544 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:14:32.475432 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:14:32.514842 (Thread-508): handling poll request
2021-06-25 12:14:32.515131 (Thread-508): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab30da90>]}
2021-06-25 12:14:32.516375 (Thread-508): sending response (<Response 9381 bytes [200 OK]>) to 10.0.45.5
2021-06-25 12:14:32.525717 (MainThread): Partial parsing not enabled
2021-06-25 12:14:32.561709 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:14:32.573174 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:14:32.577862 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:14:32.583048 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:14:32.589141 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:14:32.595328 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:14:32.727539 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:14:32.728070 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '743941ab-dbe7-4718-9242-006eaf3330b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f660bacd0a0>]}
2021-06-25 12:14:32.759523 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '743941ab-dbe7-4718-9242-006eaf3330b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f660bb14e20>]}
2021-06-25 12:14:32.759798 (MainThread): Found 6 models, 3 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:14:32.760209 (MainThread): The selector 'None' does not match any nodes and will be ignored
2021-06-25 12:14:32.760539 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-06-25 12:14:33.837248 (Thread-509): handling poll request
2021-06-25 12:14:33.837550 (Thread-509): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8118cd0>]}
2021-06-25 12:14:33.838371 (Thread-509): sending response (<Response 4788 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:14:34.384264 (Thread-510): handling status request
2021-06-25 12:14:34.384558 (Thread-510): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8118820>]}
2021-06-25 12:14:34.385129 (Thread-510): sending response (<Response 1632 bytes [200 OK]>) to 10.0.10.110
2021-06-25 12:14:34.399612 (Thread-511): handling status request
2021-06-25 12:14:34.399857 (Thread-511): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8118bb0>]}
2021-06-25 12:14:34.400356 (Thread-511): sending response (<Response 1632 bytes [200 OK]>) to 10.0.10.110
2021-06-25 12:14:34.507047 (Thread-512): handling status request
2021-06-25 12:14:34.507333 (Thread-512): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8118f10>]}
2021-06-25 12:14:34.507837 (Thread-512): sending response (<Response 1632 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:15:57.140402 (Thread-513): Got an acceptable cached parse result
2021-06-25 12:15:57.196105 (Thread-513): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:15:57.312282 (Thread-513): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:15:57.312911 (Thread-513): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab435e80>]}
2021-06-25 12:15:57.566424 (Thread-514): handling status request
2021-06-25 12:15:57.566707 (Thread-514): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab435ac0>]}
2021-06-25 12:15:57.567273 (Thread-514): sending response (<Response 1631 bytes [200 OK]>) to 10.0.31.198
2021-06-25 12:15:57.647696 (Thread-515): handling status request
2021-06-25 12:15:57.647958 (Thread-515): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab435d00>]}
2021-06-25 12:15:57.673415 (Thread-515): sending response (<Response 1631 bytes [200 OK]>) to 10.0.21.203
2021-06-25 12:15:57.674526 (Thread-516): handling status request
2021-06-25 12:15:57.674857 (Thread-516): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab500790>]}
2021-06-25 12:15:57.675333 (Thread-516): sending response (<Response 1631 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:16:09.654375 (Thread-517): handling status request
2021-06-25 12:16:09.654675 (Thread-517): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab500cd0>]}
2021-06-25 12:16:09.655195 (Thread-517): sending response (<Response 1631 bytes [200 OK]>) to 10.0.26.7
2021-06-25 12:16:09.687843 (Thread-518): handling status request
2021-06-25 12:16:09.688092 (Thread-518): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab5006a0>]}
2021-06-25 12:16:09.688571 (Thread-518): sending response (<Response 1631 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:16:09.913768 (Thread-519): handling cli_args request
2021-06-25 12:16:09.914061 (Thread-519): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab435970>]}
2021-06-25 12:16:09.923741 (Thread-519): Connection 'test.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-06-25 12:16:11.711788 (Thread-519): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:16:11.748110 (MainThread): Partial parsing not enabled
2021-06-25 12:16:11.792543 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:16:11.814560 (MainThread): Parsing macros/etc.sql
2021-06-25 12:16:11.816755 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:16:11.823603 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:16:11.828179 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:16:11.838287 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:16:11.850996 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:16:11.853855 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:16:11.855698 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:16:11.859290 (MainThread): Parsing macros/core.sql
2021-06-25 12:16:11.863294 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:16:11.874486 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:16:11.898771 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:16:11.901886 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:16:11.927450 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:16:11.943564 (Thread-520): handling poll request
2021-06-25 12:16:11.943829 (Thread-520): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3ab6a0>]}
2021-06-25 12:16:11.944919 (Thread-520): sending response (<Response 4670 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:16:11.958831 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:16:11.963713 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:16:11.969889 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:16:11.990479 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:16:11.996944 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:16:11.998822 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:16:12.004996 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:16:12.006746 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:16:12.007925 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:16:12.016908 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:16:12.017949 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:16:12.019651 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:16:12.021610 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:16:12.023166 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:16:12.025857 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:16:12.027858 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:16:12.029645 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:16:12.082650 (MainThread): Partial parsing not enabled
2021-06-25 12:16:12.115932 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:16:12.127641 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:16:12.132446 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:16:12.137078 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:16:12.143435 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:16:12.159773 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:16:12.287973 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:16:12.288560 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90944471-5957-4efa-980c-24da4376679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc35a4220>]}
2021-06-25 12:16:12.323013 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90944471-5957-4efa-980c-24da4376679b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dc36a1280>]}
2021-06-25 12:16:12.323436 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:16:12.324223 (MainThread): 
2021-06-25 12:16:12.324486 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:16:12.325721 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 12:16:12.325817 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 12:16:12.526239 (MainThread): 12:16:12 | Concurrency: 1 threads (target='default')
2021-06-25 12:16:12.526364 (MainThread): 12:16:12 | 
2021-06-25 12:16:12.528277 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:16:12.528463 (Thread-1): 12:16:12 | 1 of 1 START test assert_total_payments_amount_is_positive........... [RUN]
2021-06-25 12:16:12.528946 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:16:12.529052 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:16:12.537956 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-25 12:16:12.556399 (Thread-1): finished collecting timing info
2021-06-25 12:16:12.556553 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:16:12.560869 (Thread-1): On test.jaffle_shop.assert_total_payments_amount_is_positive: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.assert_total_payments_amount_is_positive"} */

with dbt__CTE__INTERNAL_test as (
select
    order_id,
    sum(amount) as total_amount
from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
group by 1
having not(total_amount >= 0)
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-25 12:16:13.175346 (Thread-521): handling poll request
2021-06-25 12:16:13.175642 (Thread-521): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4356a0>]}
2021-06-25 12:16:13.176612 (Thread-521): sending response (<Response 14485 bytes [200 OK]>) to 10.0.10.110
2021-06-25 12:16:14.381083 (Thread-522): handling poll request
2021-06-25 12:16:14.381367 (Thread-522): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4358e0>]}
2021-06-25 12:16:14.381925 (Thread-522): sending response (<Response 293 bytes [200 OK]>) to 10.0.31.198
2021-06-25 12:16:14.404281 (Thread-1): finished collecting timing info
2021-06-25 12:16:14.404866 (Thread-1): 12:16:14 | 1 of 1 PASS assert_total_payments_amount_is_positive................. [PASS in 1.88s]
2021-06-25 12:16:14.405005 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:16:14.406411 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:16:14.406677 (MainThread): 12:16:14 | 
2021-06-25 12:16:14.406749 (MainThread): 12:16:14 | Finished running 1 test in 2.08s.
2021-06-25 12:16:14.406799 (MainThread): Connection 'master' was properly closed.
2021-06-25 12:16:14.406839 (MainThread): Connection 'test.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-06-25 12:16:14.463111 (MainThread): 
2021-06-25 12:16:14.463272 (MainThread): Completed successfully
2021-06-25 12:16:14.463339 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-25 12:16:15.761957 (Thread-523): handling poll request
2021-06-25 12:16:15.762244 (Thread-523): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a7cf70>]}
2021-06-25 12:16:15.763268 (Thread-523): sending response (<Response 6891 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:16:16.187293 (Thread-524): handling status request
2021-06-25 12:16:16.187601 (Thread-524): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a7c520>]}
2021-06-25 12:16:16.188182 (Thread-524): sending response (<Response 1631 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:16:16.228418 (Thread-525): handling status request
2021-06-25 12:16:16.228699 (Thread-525): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb815b730>]}
2021-06-25 12:16:16.229283 (Thread-525): sending response (<Response 1631 bytes [200 OK]>) to 10.0.47.156
2021-06-25 12:16:16.252673 (Thread-526): handling status request
2021-06-25 12:16:16.252901 (Thread-526): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb815b3d0>]}
2021-06-25 12:16:16.253402 (Thread-526): sending response (<Response 1631 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:22:08.784988 (Thread-527): Got an acceptable cached parse result
2021-06-25 12:22:09.131531 (Thread-527): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:22:09.137477 (Thread-527): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:22:09.138008 (Thread-527): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaac5e0a0>]}
2021-06-25 12:22:09.180152 (Thread-528): handling status request
2021-06-25 12:22:09.180409 (Thread-528): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaad46280>]}
2021-06-25 12:22:09.180952 (Thread-528): sending response (<Response 1752 bytes [200 OK]>) to 10.0.26.142
2021-06-25 12:22:09.271213 (Thread-529): handling status request
2021-06-25 12:22:09.271487 (Thread-529): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaad46460>]}
2021-06-25 12:22:09.271989 (Thread-529): sending response (<Response 1752 bytes [200 OK]>) to 10.0.31.198
2021-06-25 12:22:09.282600 (Thread-530): handling status request
2021-06-25 12:22:09.282831 (Thread-530): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab599580>]}
2021-06-25 12:22:09.283280 (Thread-530): sending response (<Response 1752 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:22:31.997615 (Thread-531): handling status request
2021-06-25 12:22:31.997943 (Thread-531): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa79070>]}
2021-06-25 12:22:31.998514 (Thread-531): sending response (<Response 1752 bytes [200 OK]>) to 10.0.36.19
2021-06-25 12:22:32.017653 (Thread-532): handling status request
2021-06-25 12:22:32.017924 (Thread-532): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa6eaf0>]}
2021-06-25 12:22:32.018403 (Thread-532): sending response (<Response 1752 bytes [200 OK]>) to 10.0.21.203
2021-06-25 12:22:32.334243 (Thread-533): handling cli_args request
2021-06-25 12:22:32.334555 (Thread-533): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa6e1f0>]}
2021-06-25 12:22:34.114058 (Thread-533): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:22:34.150153 (MainThread): Partial parsing not enabled
2021-06-25 12:22:34.152824 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:22:34.173424 (MainThread): Parsing macros/etc.sql
2021-06-25 12:22:34.175654 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:22:34.181967 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:22:34.186483 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:22:34.196151 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:22:34.208125 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:22:34.210850 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:22:34.212659 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:22:34.216177 (MainThread): Parsing macros/core.sql
2021-06-25 12:22:34.220059 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:22:34.229151 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:22:34.243275 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:22:34.245226 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:22:34.263209 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:22:34.294342 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:22:34.299208 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:22:34.305391 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:22:34.325990 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:22:34.332451 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:22:34.337583 (Thread-534): handling poll request
2021-06-25 12:22:34.337918 (Thread-534): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaac3f640>]}
2021-06-25 12:22:34.339048 (Thread-534): sending response (<Response 6101 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:22:34.334371 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:22:34.340432 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:22:34.342089 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:22:34.343174 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:22:34.351871 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:22:34.352840 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:22:34.354682 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:22:34.356640 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:22:34.358315 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:22:34.361140 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:22:34.363076 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:22:34.364841 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:22:34.415059 (MainThread): Partial parsing not enabled
2021-06-25 12:22:34.449266 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:22:34.460743 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:22:34.465640 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:22:34.470655 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:22:34.476955 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:22:34.492955 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:22:34.617700 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:22:34.624838 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:22:34.625323 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd99f6ccd-10ef-4ef0-9a1d-f1f6f14c2f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f638888aac0>]}
2021-06-25 12:22:34.659756 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd99f6ccd-10ef-4ef0-9a1d-f1f6f14c2f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63889e45e0>]}
2021-06-25 12:22:34.660055 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:22:34.660708 (MainThread): 
2021-06-25 12:22:34.660976 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:22:34.661849 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 12:22:34.661978 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 12:22:34.895751 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 12:22:34.895891 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 12:22:35.091840 (MainThread): 12:22:35 | Concurrency: 1 threads (target='default')
2021-06-25 12:22:35.091976 (MainThread): 12:22:35 | 
2021-06-25 12:22:35.094158 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 12:22:35.094434 (Thread-1): 12:22:35 | 1 of 1 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 12:22:35.094680 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:22:35.094757 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 12:22:35.096096 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 12:22:35.112831 (Thread-1): finished collecting timing info
2021-06-25 12:22:35.140027 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 12:22:35.157961 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:22:35.162369 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 12:22:35.632390 (Thread-535): handling poll request
2021-06-25 12:22:35.632679 (Thread-535): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab435190>]}
2021-06-25 12:22:35.633790 (Thread-535): sending response (<Response 14045 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:22:36.150943 (Thread-1): finished collecting timing info
2021-06-25 12:22:36.151316 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd99f6ccd-10ef-4ef0-9a1d-f1f6f14c2f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f638897aa60>]}
2021-06-25 12:22:36.151748 (Thread-1): 12:22:36 | 1 of 1 OK created view model dbt_mskonberg.stg_orders................ [OK in 1.06s]
2021-06-25 12:22:36.151829 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 12:22:36.153073 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:22:36.153323 (MainThread): 12:22:36 | 
2021-06-25 12:22:36.153386 (MainThread): 12:22:36 | Finished running 1 view model in 1.49s.
2021-06-25 12:22:36.153435 (MainThread): Connection 'master' was properly closed.
2021-06-25 12:22:36.153475 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-06-25 12:22:36.220674 (MainThread): 
2021-06-25 12:22:36.220808 (MainThread): Completed successfully
2021-06-25 12:22:36.220873 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-25 12:22:36.968710 (Thread-536): handling poll request
2021-06-25 12:22:36.969005 (Thread-536): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2e91c0>]}
2021-06-25 12:22:36.970116 (Thread-536): sending response (<Response 7266 bytes [200 OK]>) to 10.0.42.69
2021-06-25 12:22:37.481511 (Thread-537): handling status request
2021-06-25 12:22:37.481849 (Thread-537): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6afe80>]}
2021-06-25 12:22:37.482448 (Thread-537): sending response (<Response 1752 bytes [200 OK]>) to 10.0.31.198
2021-06-25 12:22:37.555470 (Thread-538): handling status request
2021-06-25 12:22:37.555764 (Thread-538): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6afb20>]}
2021-06-25 12:22:37.556401 (Thread-538): sending response (<Response 1752 bytes [200 OK]>) to 10.0.21.203
2021-06-25 12:22:37.613498 (Thread-539): handling status request
2021-06-25 12:22:37.613799 (Thread-539): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6af5e0>]}
2021-06-25 12:22:37.614322 (Thread-539): sending response (<Response 1752 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:22:43.852215 (Thread-540): handling status request
2021-06-25 12:22:43.852513 (Thread-540): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6afdc0>]}
2021-06-25 12:22:43.853029 (Thread-540): sending response (<Response 1752 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:22:43.928984 (Thread-541): handling status request
2021-06-25 12:22:43.929253 (Thread-541): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6afe50>]}
2021-06-25 12:22:43.929793 (Thread-541): sending response (<Response 1752 bytes [200 OK]>) to 10.0.45.5
2021-06-25 12:22:44.143986 (Thread-542): handling cli_args request
2021-06-25 12:22:44.144275 (Thread-542): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab687880>]}
2021-06-25 12:22:45.933968 (Thread-542): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.142
2021-06-25 12:22:45.971275 (MainThread): Partial parsing not enabled
2021-06-25 12:22:45.974082 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:22:45.994101 (MainThread): Parsing macros/etc.sql
2021-06-25 12:22:45.996266 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:22:46.002372 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:22:46.006940 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:22:46.016629 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:22:46.028683 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:22:46.031381 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:22:46.033183 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:22:46.036627 (MainThread): Parsing macros/core.sql
2021-06-25 12:22:46.041411 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:22:46.053185 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:22:46.066827 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:22:46.068660 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:22:46.085891 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:22:46.116709 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:22:46.121651 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:22:46.127805 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:22:46.149244 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:22:46.155772 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:22:46.157614 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:22:46.163564 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:22:46.165186 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:22:46.166301 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:22:46.175041 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:22:46.176113 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:22:46.177904 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:22:46.179889 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:22:46.181447 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:22:46.184185 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:22:46.186117 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:22:46.191450 (Thread-543): handling poll request
2021-06-25 12:22:46.191722 (Thread-543): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf119a0>]}
2021-06-25 12:22:46.193039 (Thread-543): sending response (<Response 9122 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:22:46.187887 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:22:46.237363 (MainThread): Partial parsing not enabled
2021-06-25 12:22:46.275140 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:22:46.286707 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:22:46.291245 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:22:46.295912 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:22:46.302386 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:22:46.318738 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:22:46.449622 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:22:46.457202 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:22:46.457620 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da0fcf68-2a08-4a72-af36-106ff8968fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6794a2c970>]}
2021-06-25 12:22:46.489791 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da0fcf68-2a08-4a72-af36-106ff8968fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6794b2b250>]}
2021-06-25 12:22:46.490180 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:22:46.490829 (MainThread): 
2021-06-25 12:22:46.491092 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:22:46.492315 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 12:22:46.492430 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 12:22:46.668314 (MainThread): 12:22:46 | Concurrency: 1 threads (target='default')
2021-06-25 12:22:46.668440 (MainThread): 12:22:46 | 
2021-06-25 12:22:46.670391 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:22:46.670561 (Thread-1): 12:22:46 | 1 of 1 START test accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending [RUN]
2021-06-25 12:22:46.670774 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 12:22:46.670854 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:22:46.681209 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-25 12:22:46.697562 (Thread-1): finished collecting timing info
2021-06-25 12:22:46.697756 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:22:46.702208 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'returned','completed','shipped','placed','return_pending'
    )
)

select count(*) as validation_errors
from validation_errors



2021-06-25 12:22:47.470012 (Thread-544): handling poll request
2021-06-25 12:22:47.470308 (Thread-544): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab23f850>]}
2021-06-25 12:22:47.471143 (Thread-544): sending response (<Response 11469 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:22:48.179851 (Thread-1): finished collecting timing info
2021-06-25 12:22:48.180266 (Thread-1): 12:22:48 | 1 of 1 PASS accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending [PASS in 1.51s]
2021-06-25 12:22:48.180346 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:22:48.181691 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:22:48.181943 (MainThread): 12:22:48 | 
2021-06-25 12:22:48.182004 (MainThread): 12:22:48 | Finished running 1 test in 1.69s.
2021-06-25 12:22:48.182050 (MainThread): Connection 'master' was properly closed.
2021-06-25 12:22:48.182089 (MainThread): Connection 'test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending' was properly closed.
2021-06-25 12:22:48.244745 (MainThread): 
2021-06-25 12:22:48.244914 (MainThread): Completed successfully
2021-06-25 12:22:48.244999 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-06-25 12:22:48.747728 (Thread-545): handling poll request
2021-06-25 12:22:48.748018 (Thread-545): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab014cd0>]}
2021-06-25 12:22:48.775505 (Thread-545): sending response (<Response 7562 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:22:49.194565 (Thread-546): handling status request
2021-06-25 12:22:49.194850 (Thread-546): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf21310>]}
2021-06-25 12:22:49.195431 (Thread-546): sending response (<Response 1752 bytes [200 OK]>) to 10.0.36.19
2021-06-25 12:22:49.251450 (Thread-547): handling status request
2021-06-25 12:22:49.251730 (Thread-547): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf212e0>]}
2021-06-25 12:22:49.252235 (Thread-547): sending response (<Response 1752 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:22:49.262574 (Thread-548): handling status request
2021-06-25 12:22:49.262800 (Thread-548): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf21c40>]}
2021-06-25 12:22:49.263255 (Thread-548): sending response (<Response 1752 bytes [200 OK]>) to 10.0.42.69
2021-06-25 12:23:28.622628 (Thread-549): handling status request
2021-06-25 12:23:28.622913 (Thread-549): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf21d60>]}
2021-06-25 12:23:28.623407 (Thread-549): sending response (<Response 1752 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:23:28.785569 (Thread-550): handling status request
2021-06-25 12:23:28.785880 (Thread-550): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0bda90>]}
2021-06-25 12:23:28.786413 (Thread-550): sending response (<Response 1752 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:23:28.873215 (Thread-551): handling cli_args request
2021-06-25 12:23:28.873493 (Thread-551): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0bd1f0>]}
2021-06-25 12:23:30.678149 (Thread-551): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.142
2021-06-25 12:23:30.713064 (MainThread): Partial parsing not enabled
2021-06-25 12:23:30.715386 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:23:30.735694 (MainThread): Parsing macros/etc.sql
2021-06-25 12:23:30.737788 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:23:30.743873 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:23:30.748354 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:23:30.758030 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:23:30.770247 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:23:30.772895 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:23:30.774737 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:23:30.778171 (MainThread): Parsing macros/core.sql
2021-06-25 12:23:30.782006 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:23:30.790912 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:23:30.804653 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:23:30.806526 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:23:30.828425 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:23:30.859714 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:23:30.864863 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:23:30.871140 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:23:30.891433 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:23:30.898063 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:23:30.899927 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:23:30.905816 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:23:30.907421 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:23:30.908578 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:23:30.917286 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:23:30.918296 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:23:30.919965 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:23:30.921954 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:23:30.923484 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:23:30.926158 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:23:30.928033 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:23:30.929818 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:23:30.969111 (Thread-552): handling poll request
2021-06-25 12:23:30.969400 (Thread-552): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab265f70>]}
2021-06-25 12:23:30.970690 (Thread-552): sending response (<Response 9375 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:23:30.979044 (MainThread): Partial parsing not enabled
2021-06-25 12:23:31.012298 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:23:31.025771 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:23:31.031504 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:23:31.037368 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:23:31.044829 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:23:31.062617 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:23:31.191681 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:23:31.198649 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:23:31.199033 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '103424cd-7b9c-4d65-970e-dfa07835debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35173f6820>]}
2021-06-25 12:23:31.236249 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '103424cd-7b9c-4d65-970e-dfa07835debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3517511df0>]}
2021-06-25 12:23:31.236522 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:23:31.237264 (MainThread): 
2021-06-25 12:23:31.237529 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:23:31.238569 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 12:23:31.238694 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 12:23:31.439536 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 12:23:31.439675 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 12:23:31.603706 (MainThread): 12:23:31 | Concurrency: 1 threads (target='default')
2021-06-25 12:23:31.603833 (MainThread): 12:23:31 | 
2021-06-25 12:23:31.606083 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 12:23:31.606355 (Thread-1): 12:23:31 | 1 of 5 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 12:23:31.606569 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:23:31.606647 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 12:23:31.608039 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 12:23:31.625776 (Thread-1): finished collecting timing info
2021-06-25 12:23:31.652993 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 12:23:31.671292 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:23:31.675597 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 12:23:32.270296 (Thread-553): handling poll request
2021-06-25 12:23:32.270605 (Thread-553): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3908e0>]}
2021-06-25 12:23:32.271500 (Thread-553): sending response (<Response 10743 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:23:32.549073 (Thread-1): finished collecting timing info
2021-06-25 12:23:32.549450 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '103424cd-7b9c-4d65-970e-dfa07835debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f351746f130>]}
2021-06-25 12:23:32.549913 (Thread-1): 12:23:32 | 1 of 5 OK created view model dbt_mskonberg.stg_orders................ [OK in 0.94s]
2021-06-25 12:23:32.549999 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 12:23:32.550100 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 12:23:32.550234 (Thread-1): 12:23:32 | 2 of 5 START view model dbt_mskonberg.stg_payments................... [RUN]
2021-06-25 12:23:32.550419 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:23:32.550486 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 12:23:32.552525 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 12:23:32.570475 (Thread-1): finished collecting timing info
2021-06-25 12:23:32.572174 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 12:23:32.589577 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:23:32.593807 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
  OPTIONS()
  as with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial.stripe.payment`

)

select * from payments;


2021-06-25 12:23:33.370384 (Thread-1): finished collecting timing info
2021-06-25 12:23:33.370777 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '103424cd-7b9c-4d65-970e-dfa07835debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35173eb640>]}
2021-06-25 12:23:33.371227 (Thread-1): 12:23:33 | 2 of 5 OK created view model dbt_mskonberg.stg_payments.............. [OK in 0.82s]
2021-06-25 12:23:33.371309 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 12:23:33.371413 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 12:23:33.371546 (Thread-1): 12:23:33 | 3 of 5 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 12:23:33.371741 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:23:33.371808 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 12:23:33.372926 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 12:23:33.392070 (Thread-1): finished collecting timing info
2021-06-25 12:23:33.397822 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 12:23:33.419959 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:23:33.424327 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 12:23:33.512044 (Thread-554): handling poll request
2021-06-25 12:23:33.512329 (Thread-554): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab014340>]}
2021-06-25 12:23:33.513253 (Thread-554): sending response (<Response 11815 bytes [200 OK]>) to 10.0.42.69
2021-06-25 12:23:34.381493 (Thread-1): finished collecting timing info
2021-06-25 12:23:34.381892 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '103424cd-7b9c-4d65-970e-dfa07835debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f351743dee0>]}
2021-06-25 12:23:34.382186 (Thread-1): 12:23:34 | 3 of 5 OK created view model dbt_mskonberg.stg_customers............. [OK in 1.01s]
2021-06-25 12:23:34.382261 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 12:23:34.382359 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 12:23:34.382490 (Thread-1): 12:23:34 | 4 of 5 START table model dbt_mskonberg.fct_orders.................... [RUN]
2021-06-25 12:23:34.382679 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:23:34.382746 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 12:23:34.385702 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 12:23:34.401974 (Thread-1): finished collecting timing info
2021-06-25 12:23:34.415790 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:23:34.613960 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 12:23:34.632682 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`
  
  
  OPTIONS()
  as (
    --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
    
2021-06-25 12:23:34.835446 (Thread-555): handling poll request
2021-06-25 12:23:34.835733 (Thread-555): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab014fa0>]}
2021-06-25 12:23:34.836480 (Thread-555): sending response (<Response 6454 bytes [200 OK]>) to 10.0.36.19
2021-06-25 12:23:36.138909 (Thread-556): handling poll request
2021-06-25 12:23:36.139210 (Thread-556): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab23fd60>]}
2021-06-25 12:23:36.139733 (Thread-556): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:23:37.507632 (Thread-557): handling poll request
2021-06-25 12:23:37.507924 (Thread-557): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab23fb20>]}
2021-06-25 12:23:37.508446 (Thread-557): sending response (<Response 285 bytes [200 OK]>) to 10.0.42.69
2021-06-25 12:23:37.887180 (Thread-1): finished collecting timing info
2021-06-25 12:23:37.887570 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '103424cd-7b9c-4d65-970e-dfa07835debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35173eb640>]}
2021-06-25 12:23:37.888011 (Thread-1): 12:23:37 | 4 of 5 OK created table model dbt_mskonberg.fct_orders............... [CREATE TABLE (99.0 rows, 5.2 KB processed) in 3.50s]
2021-06-25 12:23:37.888088 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 12:23:37.888938 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 12:23:37.889119 (Thread-1): 12:23:37 | 5 of 5 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-25 12:23:37.889328 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:23:37.889404 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 12:23:37.892470 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 12:23:37.910927 (Thread-1): finished collecting timing info
2021-06-25 12:23:37.912302 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:23:38.096852 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 12:23:38.113468 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders
    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 12:23:38.851515 (Thread-558): handling poll request
2021-06-25 12:23:38.851803 (Thread-558): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0bde80>]}
2021-06-25 12:23:38.852522 (Thread-558): sending response (<Response 6864 bytes [200 OK]>) to 10.0.26.142
2021-06-25 12:23:40.146383 (Thread-559): handling poll request
2021-06-25 12:23:40.146671 (Thread-559): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0bd9a0>]}
2021-06-25 12:23:40.147175 (Thread-559): sending response (<Response 286 bytes [200 OK]>) to 10.0.10.110
2021-06-25 12:23:41.086679 (Thread-1): finished collecting timing info
2021-06-25 12:23:41.087083 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '103424cd-7b9c-4d65-970e-dfa07835debc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35173ebf70>]}
2021-06-25 12:23:41.087549 (Thread-1): 12:23:41 | 5 of 5 OK created table model dbt_mskonberg.dim_customers............ [CREATE TABLE (100.0 rows, 5.0 KB processed) in 3.20s]
2021-06-25 12:23:41.087632 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 12:23:41.089017 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:23:41.089290 (MainThread): 12:23:41 | 
2021-06-25 12:23:41.089353 (MainThread): 12:23:41 | Finished running 3 view models, 2 table models in 9.85s.
2021-06-25 12:23:41.089401 (MainThread): Connection 'master' was properly closed.
2021-06-25 12:23:41.089440 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 12:23:41.143366 (MainThread): 
2021-06-25 12:23:41.143510 (MainThread): Completed successfully
2021-06-25 12:23:41.143578 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-06-25 12:23:41.505943 (Thread-560): handling poll request
2021-06-25 12:23:41.506228 (Thread-560): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab23f220>]}
2021-06-25 12:23:41.507625 (Thread-560): sending response (<Response 19615 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:23:42.097836 (Thread-561): handling status request
2021-06-25 12:23:42.098127 (Thread-561): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0145e0>]}
2021-06-25 12:23:42.098687 (Thread-561): sending response (<Response 1752 bytes [200 OK]>) to 10.0.45.5
2021-06-25 12:23:42.148446 (Thread-562): handling status request
2021-06-25 12:23:42.148830 (Thread-562): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab014940>]}
2021-06-25 12:23:42.149525 (Thread-562): sending response (<Response 1752 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:23:42.154541 (Thread-563): handling status request
2021-06-25 12:23:42.154727 (Thread-563): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab014280>]}
2021-06-25 12:23:42.155131 (Thread-563): sending response (<Response 1752 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:23:50.614472 (Thread-564): handling status request
2021-06-25 12:23:50.614806 (Thread-564): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3906a0>]}
2021-06-25 12:23:50.615382 (Thread-564): sending response (<Response 1752 bytes [200 OK]>) to 10.0.31.198
2021-06-25 12:23:50.748800 (Thread-565): handling status request
2021-06-25 12:23:50.749107 (Thread-565): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3906a0>]}
2021-06-25 12:23:50.749626 (Thread-565): sending response (<Response 1752 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:23:50.834046 (Thread-566): handling cli_args request
2021-06-25 12:23:50.834350 (Thread-566): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf9e970>]}
2021-06-25 12:23:52.651817 (Thread-566): sending response (<Response 138 bytes [200 OK]>) to 10.0.42.69
2021-06-25 12:23:52.688135 (MainThread): Partial parsing not enabled
2021-06-25 12:23:52.690808 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:23:52.711016 (MainThread): Parsing macros/etc.sql
2021-06-25 12:23:52.713096 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:23:52.719303 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:23:52.724022 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:23:52.735208 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:23:52.748498 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:23:52.751307 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:23:52.753210 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:23:52.756801 (MainThread): Parsing macros/core.sql
2021-06-25 12:23:52.760779 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:23:52.770080 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:23:52.784503 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:23:52.786396 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:23:52.804400 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:23:52.835985 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:23:52.841181 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:23:52.847997 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:23:52.869169 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:23:52.875876 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:23:52.877865 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:23:52.884120 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:23:52.885909 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:23:52.887122 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:23:52.896098 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:23:52.897105 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:23:52.898922 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:23:52.901013 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:23:52.902758 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:23:52.905571 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:23:52.907705 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:23:52.909592 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:23:52.925942 (Thread-567): handling poll request
2021-06-25 12:23:52.926233 (Thread-567): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6afb50>]}
2021-06-25 12:23:52.927519 (Thread-567): sending response (<Response 9376 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:23:52.961789 (MainThread): Partial parsing not enabled
2021-06-25 12:23:52.997818 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:23:53.009734 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:23:53.014800 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:23:53.020569 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:23:53.027554 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:23:53.044421 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:23:53.169728 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:23:53.176655 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:23:53.177026 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '919045e8-ab81-4ece-9245-e85a6aedef8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc592e4ac0>]}
2021-06-25 12:23:53.207218 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '919045e8-ab81-4ece-9245-e85a6aedef8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc594455e0>]}
2021-06-25 12:23:53.207513 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:23:53.208300 (MainThread): 
2021-06-25 12:23:53.208571 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:23:53.209947 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 12:23:53.210046 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 12:23:53.387010 (MainThread): 12:23:53 | Concurrency: 1 threads (target='default')
2021-06-25 12:23:53.387137 (MainThread): 12:23:53 | 
2021-06-25 12:23:53.389088 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:23:53.389265 (Thread-1): 12:23:53 | 1 of 4 START test accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending [RUN]
2021-06-25 12:23:53.389477 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 12:23:53.389555 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:23:53.399687 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-25 12:23:53.418502 (Thread-1): finished collecting timing info
2021-06-25 12:23:53.418740 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:23:53.423177 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'returned','completed','shipped','placed','return_pending'
    )
)

select count(*) as validation_errors
from validation_errors



2021-06-25 12:23:54.189169 (Thread-568): handling poll request
2021-06-25 12:23:54.189469 (Thread-568): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6876a0>]}
2021-06-25 12:23:54.190325 (Thread-568): sending response (<Response 11187 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:23:55.067103 (Thread-1): finished collecting timing info
2021-06-25 12:23:55.067524 (Thread-1): 12:23:55 | 1 of 4 PASS accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending [PASS in 1.68s]
2021-06-25 12:23:55.067606 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:23:55.067709 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:23:55.067800 (Thread-1): 12:23:55 | 2 of 4 START test assert_total_payments_amount_is_positive........... [RUN]
2021-06-25 12:23:55.067981 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:23:55.068053 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:23:55.077575 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-25 12:23:55.095792 (Thread-1): finished collecting timing info
2021-06-25 12:23:55.095986 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:23:55.100315 (Thread-1): On test.jaffle_shop.assert_total_payments_amount_is_positive: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.assert_total_payments_amount_is_positive"} */

with dbt__CTE__INTERNAL_test as (
select
    order_id,
    sum(amount) as total_amount
from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
group by 1
having not(total_amount >= 0)
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-25 12:23:55.549541 (Thread-569): handling poll request
2021-06-25 12:23:55.549856 (Thread-569): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9f43d00>]}
2021-06-25 12:23:55.550549 (Thread-569): sending response (<Response 5873 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:23:56.637144 (Thread-1): finished collecting timing info
2021-06-25 12:23:56.637557 (Thread-1): 12:23:56 | 2 of 4 PASS assert_total_payments_amount_is_positive................. [PASS in 1.57s]
2021-06-25 12:23:56.637638 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:23:56.637765 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:23:56.637852 (Thread-1): 12:23:56 | 3 of 4 START test not_null_stg_customers_customer_id................. [RUN]
2021-06-25 12:23:56.638034 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-06-25 12:23:56.638102 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:23:56.645943 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-06-25 12:23:56.662664 (Thread-1): finished collecting timing info
2021-06-25 12:23:56.662822 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:23:56.667265 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
where customer_id is null



2021-06-25 12:23:56.866243 (Thread-570): handling poll request
2021-06-25 12:23:56.866537 (Thread-570): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3f9a00>]}
2021-06-25 12:23:56.867217 (Thread-570): sending response (<Response 5465 bytes [200 OK]>) to 10.0.10.110
2021-06-25 12:23:57.963853 (Thread-1): finished collecting timing info
2021-06-25 12:23:57.964285 (Thread-1): 12:23:57 | 3 of 4 PASS not_null_stg_customers_customer_id....................... [PASS in 1.33s]
2021-06-25 12:23:57.964375 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:23:57.964482 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:23:57.964567 (Thread-1): 12:23:57 | 4 of 4 START test unique_stg_customers_customer_id................... [RUN]
2021-06-25 12:23:57.964742 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-06-25 12:23:57.964811 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:23:57.971780 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-06-25 12:23:57.988415 (Thread-1): finished collecting timing info
2021-06-25 12:23:57.988581 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:23:57.992878 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-06-25 12:23:58.129004 (Thread-571): handling poll request
2021-06-25 12:23:58.129290 (Thread-571): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3f95b0>]}
2021-06-25 12:23:58.129991 (Thread-571): sending response (<Response 5540 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:23:59.161250 (Thread-1): finished collecting timing info
2021-06-25 12:23:59.161698 (Thread-1): 12:23:59 | 4 of 4 PASS unique_stg_customers_customer_id......................... [PASS in 1.20s]
2021-06-25 12:23:59.161796 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:23:59.163103 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:23:59.163371 (MainThread): 12:23:59 | 
2021-06-25 12:23:59.163435 (MainThread): 12:23:59 | Finished running 4 tests in 5.95s.
2021-06-25 12:23:59.163489 (MainThread): Connection 'master' was properly closed.
2021-06-25 12:23:59.163531 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id' was properly closed.
2021-06-25 12:23:59.227936 (MainThread): 
2021-06-25 12:23:59.228080 (MainThread): Completed successfully
2021-06-25 12:23:59.228152 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-25 12:23:59.440240 (Thread-572): handling poll request
2021-06-25 12:23:59.440610 (Thread-572): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3bdcd0>]}
2021-06-25 12:23:59.442415 (Thread-572): sending response (<Response 14296 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:24:00.088362 (Thread-573): handling status request
2021-06-25 12:24:00.088650 (Thread-573): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7ef9a0>]}
2021-06-25 12:24:00.089209 (Thread-573): sending response (<Response 1752 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:24:00.113361 (Thread-574): handling status request
2021-06-25 12:24:00.113621 (Thread-574): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab687430>]}
2021-06-25 12:24:00.114150 (Thread-574): sending response (<Response 1752 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:24:00.118742 (Thread-575): handling status request
2021-06-25 12:24:00.118934 (Thread-575): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab272550>]}
2021-06-25 12:24:00.143853 (Thread-575): sending response (<Response 1752 bytes [200 OK]>) to 10.0.36.19
2021-06-25 12:27:21.733453 (Thread-576): Got an acceptable cached parse result
2021-06-25 12:27:21.924126 (Thread-576): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:27:21.929678 (Thread-576): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:27:21.930201 (Thread-576): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2bacd0>]}
2021-06-25 12:27:22.420688 (Thread-577): handling status request
2021-06-25 12:27:22.420983 (Thread-577): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab415310>]}
2021-06-25 12:27:22.421537 (Thread-577): sending response (<Response 1761 bytes [200 OK]>) to 10.0.10.110
2021-06-25 12:27:22.519184 (Thread-578): handling status request
2021-06-25 12:27:22.519469 (Thread-578): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab415ca0>]}
2021-06-25 12:27:22.519992 (Thread-578): sending response (<Response 1761 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:27:22.561387 (Thread-579): handling status request
2021-06-25 12:27:22.561628 (Thread-579): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab415520>]}
2021-06-25 12:27:22.562173 (Thread-579): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:27:25.222436 (Thread-580): handling status request
2021-06-25 12:27:25.222733 (Thread-580): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7a3f70>]}
2021-06-25 12:27:25.223246 (Thread-580): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.19
2021-06-25 12:27:25.297902 (Thread-581): handling status request
2021-06-25 12:27:25.298175 (Thread-581): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7d69d0>]}
2021-06-25 12:27:25.298676 (Thread-581): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:27:25.478586 (Thread-582): handling cli_args request
2021-06-25 12:27:25.478884 (Thread-582): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab7d6700>]}
2021-06-25 12:27:27.267765 (Thread-582): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:27:27.303710 (MainThread): Partial parsing not enabled
2021-06-25 12:27:27.306133 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:27:27.326390 (MainThread): Parsing macros/etc.sql
2021-06-25 12:27:27.328500 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:27:27.334659 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:27:27.339096 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:27:27.349051 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:27:27.362719 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:27:27.366230 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:27:27.368632 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:27:27.373202 (MainThread): Parsing macros/core.sql
2021-06-25 12:27:27.378296 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:27:27.390228 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:27:27.404899 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:27:27.406759 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:27:27.424147 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:27:27.454870 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:27:27.459823 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:27:27.466027 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:27:27.486825 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:27:27.493371 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:27:27.495257 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:27:27.501149 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:27:27.502855 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:27:27.504002 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:27:27.512653 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:27:27.513676 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:27:27.515355 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:27:27.517324 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:27:27.518946 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:27:27.521612 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:27:27.523635 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:27:27.525401 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:27:27.575087 (MainThread): Partial parsing not enabled
2021-06-25 12:27:27.593990 (Thread-583): handling poll request
2021-06-25 12:27:27.594296 (Thread-583): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab244580>]}
2021-06-25 12:27:27.595701 (Thread-583): sending response (<Response 9637 bytes [200 OK]>) to 10.0.26.7
2021-06-25 12:27:27.609264 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:27:27.620328 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:27:27.624921 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:27:27.629536 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:27:27.635809 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:27:27.652817 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:27:27.783014 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:27:27.790234 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:27:27.790599 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74eeca17-ffab-4df7-aa52-25ba34d2c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c159da60>]}
2021-06-25 12:27:27.828053 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74eeca17-ffab-4df7-aa52-25ba34d2c20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c16b8e20>]}
2021-06-25 12:27:27.828336 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:27:27.829127 (MainThread): 
2021-06-25 12:27:27.829402 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:27:27.830811 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 12:27:27.830925 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 12:27:28.014317 (MainThread): 12:27:28 | Concurrency: 1 threads (target='default')
2021-06-25 12:27:28.014488 (MainThread): 12:27:28 | 
2021-06-25 12:27:28.016901 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:27:28.017086 (Thread-1): 12:27:28 | 1 of 4 START test accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending [RUN]
2021-06-25 12:27:28.017311 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 12:27:28.017391 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:27:28.027782 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-25 12:27:28.046776 (Thread-1): finished collecting timing info
2021-06-25 12:27:28.046942 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:27:28.051286 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'returned','completed','shipped','placed','return_pending'
    )
)

select count(*) as validation_errors
from validation_errors



2021-06-25 12:27:28.997552 (Thread-584): handling poll request
2021-06-25 12:27:28.997886 (Thread-584): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2b8fa0>]}
2021-06-25 12:27:28.998758 (Thread-584): sending response (<Response 10935 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:27:29.624229 (Thread-1): finished collecting timing info
2021-06-25 12:27:29.624658 (Thread-1): 12:27:29 | 1 of 4 PASS accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending [PASS in 1.61s]
2021-06-25 12:27:29.624744 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:27:29.624846 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:27:29.624934 (Thread-1): 12:27:29 | 2 of 4 START test assert_total_payments_amount_is_positive........... [RUN]
2021-06-25 12:27:29.625119 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:27:29.625189 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:27:29.634712 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-25 12:27:29.651730 (Thread-1): finished collecting timing info
2021-06-25 12:27:29.651898 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:27:29.656885 (Thread-1): On test.jaffle_shop.assert_total_payments_amount_is_positive: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.assert_total_payments_amount_is_positive"} */

with dbt__CTE__INTERNAL_test as (
select
    order_id,
    sum(amount) as total_amount
from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
group by 1
having not(total_amount >= 0)
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-25 12:27:30.337406 (Thread-585): handling poll request
2021-06-25 12:27:30.337718 (Thread-585): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaf98fa0>]}
2021-06-25 12:27:30.338406 (Thread-585): sending response (<Response 5873 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:27:30.957875 (Thread-1): finished collecting timing info
2021-06-25 12:27:30.958286 (Thread-1): 12:27:30 | 2 of 4 PASS assert_total_payments_amount_is_positive................. [PASS in 1.33s]
2021-06-25 12:27:30.958370 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:27:30.958471 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:27:30.958558 (Thread-1): 12:27:30 | 3 of 4 START test not_null_stg_customers_customer_id................. [RUN]
2021-06-25 12:27:30.958747 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-06-25 12:27:30.958817 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:27:30.966354 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-06-25 12:27:30.988575 (Thread-1): finished collecting timing info
2021-06-25 12:27:30.988732 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:27:30.993212 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
where customer_id is null



2021-06-25 12:27:31.672768 (Thread-586): handling poll request
2021-06-25 12:27:31.673056 (Thread-586): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81a35b0>]}
2021-06-25 12:27:31.673756 (Thread-586): sending response (<Response 5465 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:27:31.894264 (Thread-1): finished collecting timing info
2021-06-25 12:27:31.894668 (Thread-1): 12:27:31 | 3 of 4 PASS not_null_stg_customers_customer_id....................... [PASS in 0.94s]
2021-06-25 12:27:31.894752 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:27:31.894854 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:27:31.894940 (Thread-1): 12:27:31 | 4 of 4 START test unique_stg_customers_customer_id................... [RUN]
2021-06-25 12:27:31.895108 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-06-25 12:27:31.895180 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:27:31.901818 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-06-25 12:27:31.918473 (Thread-1): finished collecting timing info
2021-06-25 12:27:31.918630 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:27:31.922913 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-06-25 12:27:32.989858 (Thread-1): finished collecting timing info
2021-06-25 12:27:32.990286 (Thread-1): 12:27:32 | 4 of 4 PASS unique_stg_customers_customer_id......................... [PASS in 1.10s]
2021-06-25 12:27:32.990374 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:27:32.992095 (Thread-587): handling poll request
2021-06-25 12:27:32.992328 (Thread-587): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2ba640>]}
2021-06-25 12:27:32.993035 (Thread-587): sending response (<Response 6872 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:27:32.991840 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:27:32.992113 (MainThread): 12:27:32 | 
2021-06-25 12:27:32.992177 (MainThread): 12:27:32 | Finished running 4 tests in 5.16s.
2021-06-25 12:27:32.992228 (MainThread): Connection 'master' was properly closed.
2021-06-25 12:27:32.992269 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id' was properly closed.
2021-06-25 12:27:33.069715 (MainThread): 
2021-06-25 12:27:33.069877 (MainThread): Completed successfully
2021-06-25 12:27:33.069947 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-25 12:27:34.326759 (Thread-588): handling poll request
2021-06-25 12:27:34.327043 (Thread-588): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab71efa0>]}
2021-06-25 12:27:34.328355 (Thread-588): sending response (<Response 12964 bytes [200 OK]>) to 10.0.36.19
2021-06-25 12:27:34.947798 (Thread-589): handling status request
2021-06-25 12:27:34.948102 (Thread-589): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab71eb80>]}
2021-06-25 12:27:34.948663 (Thread-589): sending response (<Response 1761 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:27:35.071520 (Thread-590): handling status request
2021-06-25 12:27:35.071814 (Thread-590): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab71e400>]}
2021-06-25 12:27:35.072317 (Thread-590): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:27:35.106148 (Thread-591): handling status request
2021-06-25 12:27:35.106441 (Thread-591): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab71e130>]}
2021-06-25 12:27:35.106947 (Thread-591): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.19
2021-06-25 12:27:47.790475 (Thread-592): handling status request
2021-06-25 12:27:47.790777 (Thread-592): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab71edc0>]}
2021-06-25 12:27:47.791316 (Thread-592): sending response (<Response 1761 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:27:47.808172 (Thread-593): handling status request
2021-06-25 12:27:47.808397 (Thread-593): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab71eee0>]}
2021-06-25 12:27:47.808872 (Thread-593): sending response (<Response 1761 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:27:48.066688 (Thread-594): handling cli_args request
2021-06-25 12:27:48.066981 (Thread-594): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab71e460>]}
2021-06-25 12:27:49.859800 (Thread-594): sending response (<Response 138 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:27:49.897557 (MainThread): Partial parsing not enabled
2021-06-25 12:27:49.900108 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:27:49.920413 (MainThread): Parsing macros/etc.sql
2021-06-25 12:27:49.922589 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:27:49.928628 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:27:49.933160 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:27:49.942815 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:27:49.954836 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:27:49.957505 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:27:49.959361 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:27:49.962813 (MainThread): Parsing macros/core.sql
2021-06-25 12:27:49.966632 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:27:49.975450 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:27:49.989291 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:27:49.991115 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:27:50.008305 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:27:50.039194 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:27:50.044118 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:27:50.050258 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:27:50.070510 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:27:50.077087 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:27:50.078977 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:27:50.084852 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:27:50.086505 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:27:50.087586 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:27:50.096229 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:27:50.097215 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:27:50.098917 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:27:50.100889 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:27:50.102457 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:27:50.105105 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:27:50.107012 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:27:50.108778 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:27:50.121360 (Thread-595): handling poll request
2021-06-25 12:27:50.121645 (Thread-595): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8146130>]}
2021-06-25 12:27:50.123000 (Thread-595): sending response (<Response 9375 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:27:50.159284 (MainThread): Partial parsing not enabled
2021-06-25 12:27:50.193634 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:27:50.205275 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:27:50.210627 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:27:50.215627 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:27:50.222036 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:27:50.239876 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:27:50.363673 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:27:50.370569 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:27:50.370942 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25bb58b8-94f4-46b4-8bde-5bc292c147cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa541b55a00>]}
2021-06-25 12:27:50.406654 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25bb58b8-94f4-46b4-8bde-5bc292c147cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa541c70e50>]}
2021-06-25 12:27:50.406904 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:27:50.407700 (MainThread): 
2021-06-25 12:27:50.407975 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:27:50.409118 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 12:27:50.409250 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 12:27:50.599948 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 12:27:50.600084 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 12:27:50.769076 (MainThread): 12:27:50 | Concurrency: 1 threads (target='default')
2021-06-25 12:27:50.769205 (MainThread): 12:27:50 | 
2021-06-25 12:27:50.771778 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 12:27:50.772048 (Thread-1): 12:27:50 | 1 of 5 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 12:27:50.772262 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:27:50.772346 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 12:27:50.773748 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 12:27:50.792052 (Thread-1): finished collecting timing info
2021-06-25 12:27:50.819384 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 12:27:50.836984 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:27:50.841382 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 12:27:51.329861 (Thread-596): handling poll request
2021-06-25 12:27:51.330143 (Thread-596): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab37a0a0>]}
2021-06-25 12:27:51.331021 (Thread-596): sending response (<Response 10752 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:27:51.715860 (Thread-1): finished collecting timing info
2021-06-25 12:27:51.716228 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25bb58b8-94f4-46b4-8bde-5bc292c147cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa541b93550>]}
2021-06-25 12:27:51.716520 (Thread-1): 12:27:51 | 1 of 5 OK created view model dbt_mskonberg.stg_orders................ [OK in 0.94s]
2021-06-25 12:27:51.716596 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 12:27:51.716697 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 12:27:51.716830 (Thread-1): 12:27:51 | 2 of 5 START view model dbt_mskonberg.stg_payments................... [RUN]
2021-06-25 12:27:51.717013 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:27:51.717080 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 12:27:51.719189 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 12:27:51.736290 (Thread-1): finished collecting timing info
2021-06-25 12:27:51.738528 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 12:27:51.756786 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:27:51.761205 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
  OPTIONS()
  as with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial.stripe.payment`

)

select * from payments;


2021-06-25 12:27:52.625857 (Thread-1): finished collecting timing info
2021-06-25 12:27:52.626242 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25bb58b8-94f4-46b4-8bde-5bc292c147cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa541cb4670>]}
2021-06-25 12:27:52.626528 (Thread-1): 12:27:52 | 2 of 5 OK created view model dbt_mskonberg.stg_payments.............. [OK in 0.91s]
2021-06-25 12:27:52.626601 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 12:27:52.626702 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 12:27:52.626833 (Thread-1): 12:27:52 | 3 of 5 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 12:27:52.627018 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:27:52.627088 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 12:27:52.628178 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 12:27:52.640751 (Thread-597): handling poll request
2021-06-25 12:27:52.641009 (Thread-597): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab37ae80>]}
2021-06-25 12:27:52.641858 (Thread-597): sending response (<Response 9892 bytes [200 OK]>) to 10.0.21.203
2021-06-25 12:27:52.645327 (Thread-1): finished collecting timing info
2021-06-25 12:27:52.651075 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 12:27:52.665651 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:27:52.669969 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 12:27:53.536529 (Thread-1): finished collecting timing info
2021-06-25 12:27:53.536908 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25bb58b8-94f4-46b4-8bde-5bc292c147cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa541c59dc0>]}
2021-06-25 12:27:53.537200 (Thread-1): 12:27:53 | 3 of 5 OK created view model dbt_mskonberg.stg_customers............. [OK in 0.91s]
2021-06-25 12:27:53.537274 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 12:27:53.537373 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 12:27:53.537508 (Thread-1): 12:27:53 | 4 of 5 START table model dbt_mskonberg.fct_orders.................... [RUN]
2021-06-25 12:27:53.537712 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:27:53.537784 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 12:27:53.540730 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 12:27:53.558849 (Thread-1): finished collecting timing info
2021-06-25 12:27:53.572532 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:27:53.755255 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 12:27:53.772675 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`
  
  
  OPTIONS()
  as (
    --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
    
2021-06-25 12:27:53.919232 (Thread-598): handling poll request
2021-06-25 12:27:53.919514 (Thread-598): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81468e0>]}
2021-06-25 12:27:53.920281 (Thread-598): sending response (<Response 8377 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:27:55.258576 (Thread-599): handling poll request
2021-06-25 12:27:55.258883 (Thread-599): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab71efa0>]}
2021-06-25 12:27:55.259438 (Thread-599): sending response (<Response 285 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:27:56.556727 (Thread-600): handling poll request
2021-06-25 12:27:56.557009 (Thread-600): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab71e310>]}
2021-06-25 12:27:56.557512 (Thread-600): sending response (<Response 285 bytes [200 OK]>) to 10.0.21.203
2021-06-25 12:27:56.645544 (Thread-1): finished collecting timing info
2021-06-25 12:27:56.645956 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25bb58b8-94f4-46b4-8bde-5bc292c147cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa541cb46a0>]}
2021-06-25 12:27:56.646254 (Thread-1): 12:27:56 | 4 of 5 OK created table model dbt_mskonberg.fct_orders............... [CREATE TABLE (99.0 rows, 5.2 KB processed) in 3.11s]
2021-06-25 12:27:56.646328 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 12:27:56.647219 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 12:27:56.647434 (Thread-1): 12:27:56 | 5 of 5 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-25 12:27:56.647644 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:27:56.647718 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 12:27:56.650692 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 12:27:56.667930 (Thread-1): finished collecting timing info
2021-06-25 12:27:56.669194 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:27:56.842808 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 12:27:56.860051 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders
    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 12:27:57.902255 (Thread-601): handling poll request
2021-06-25 12:27:57.902547 (Thread-601): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab353850>]}
2021-06-25 12:27:57.903268 (Thread-601): sending response (<Response 6864 bytes [200 OK]>) to 10.0.26.142
2021-06-25 12:27:59.233181 (Thread-602): handling poll request
2021-06-25 12:27:59.233479 (Thread-602): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab353bb0>]}
2021-06-25 12:27:59.234102 (Thread-602): sending response (<Response 286 bytes [200 OK]>) to 10.0.42.69
2021-06-25 12:27:59.634896 (Thread-1): finished collecting timing info
2021-06-25 12:27:59.635330 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25bb58b8-94f4-46b4-8bde-5bc292c147cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa541cb4670>]}
2021-06-25 12:27:59.635641 (Thread-1): 12:27:59 | 5 of 5 OK created table model dbt_mskonberg.dim_customers............ [CREATE TABLE (100.0 rows, 5.0 KB processed) in 2.99s]
2021-06-25 12:27:59.635716 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 12:27:59.637067 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:27:59.637341 (MainThread): 12:27:59 | 
2021-06-25 12:27:59.637405 (MainThread): 12:27:59 | Finished running 3 view models, 2 table models in 9.23s.
2021-06-25 12:27:59.637454 (MainThread): Connection 'master' was properly closed.
2021-06-25 12:27:59.637494 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 12:27:59.697482 (MainThread): 
2021-06-25 12:27:59.697620 (MainThread): Completed successfully
2021-06-25 12:27:59.697722 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-06-25 12:28:00.583776 (Thread-603): handling poll request
2021-06-25 12:28:00.584065 (Thread-603): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab248160>]}
2021-06-25 12:28:00.585456 (Thread-603): sending response (<Response 19615 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:28:01.200424 (Thread-604): handling status request
2021-06-25 12:28:01.200718 (Thread-604): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2486d0>]}
2021-06-25 12:28:01.201289 (Thread-604): sending response (<Response 1761 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:28:01.286449 (Thread-605): handling status request
2021-06-25 12:28:01.286741 (Thread-605): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab248730>]}
2021-06-25 12:28:01.310064 (Thread-606): handling status request
2021-06-25 12:28:01.310312 (Thread-606): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab67d310>]}
2021-06-25 12:28:01.327333 (Thread-605): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:28:01.327800 (Thread-606): sending response (<Response 1761 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:28:08.188538 (Thread-607): handling status request
2021-06-25 12:28:08.188846 (Thread-607): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab67d4c0>]}
2021-06-25 12:28:08.189466 (Thread-607): sending response (<Response 1761 bytes [200 OK]>) to 10.0.26.7
2021-06-25 12:28:08.191607 (Thread-608): handling status request
2021-06-25 12:28:08.191842 (Thread-608): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab415520>]}
2021-06-25 12:28:08.192241 (Thread-608): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:28:08.424888 (Thread-609): handling cli_args request
2021-06-25 12:28:08.425178 (Thread-609): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab67d5e0>]}
2021-06-25 12:28:10.205154 (Thread-609): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:28:10.241831 (MainThread): Partial parsing not enabled
2021-06-25 12:28:10.244228 (MainThread): Parsing macros/adapters.sql
2021-06-25 12:28:10.264734 (MainThread): Parsing macros/etc.sql
2021-06-25 12:28:10.266906 (MainThread): Parsing macros/catalog.sql
2021-06-25 12:28:10.273002 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 12:28:10.277535 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 12:28:10.287281 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 12:28:10.299339 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 12:28:10.302170 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 12:28:10.303988 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 12:28:10.307483 (MainThread): Parsing macros/core.sql
2021-06-25 12:28:10.311584 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 12:28:10.320666 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 12:28:10.334571 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 12:28:10.336392 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 12:28:10.353733 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 12:28:10.385132 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 12:28:10.390205 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 12:28:10.396477 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 12:28:10.419426 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 12:28:10.427388 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 12:28:10.430122 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 12:28:10.438846 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 12:28:10.440760 (MainThread): Parsing macros/etc/query.sql
2021-06-25 12:28:10.442280 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 12:28:10.453081 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 12:28:10.454141 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 12:28:10.455841 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 12:28:10.457822 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 12:28:10.459381 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 12:28:10.462055 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 12:28:10.464014 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 12:28:10.465973 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 12:28:10.509193 (Thread-610): handling poll request
2021-06-25 12:28:10.509486 (Thread-610): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b29490>]}
2021-06-25 12:28:10.510780 (Thread-610): sending response (<Response 9376 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:28:10.516102 (MainThread): Partial parsing not enabled
2021-06-25 12:28:10.549976 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:28:10.562056 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:28:10.567158 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:28:10.571855 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:28:10.581053 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:28:10.597493 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:28:10.721609 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:28:10.728431 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:28:10.728794 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6ba6fbf-83cc-4d30-8d7e-32c428ab46ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74291f79a0>]}
2021-06-25 12:28:10.770305 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6ba6fbf-83cc-4d30-8d7e-32c428ab46ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f742943b1f0>]}
2021-06-25 12:28:10.770561 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:28:10.771303 (MainThread): 
2021-06-25 12:28:10.771561 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:28:10.772867 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 12:28:10.772979 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 12:28:10.941477 (MainThread): 12:28:10 | Concurrency: 1 threads (target='default')
2021-06-25 12:28:10.941615 (MainThread): 12:28:10 | 
2021-06-25 12:28:10.943628 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:28:10.943818 (Thread-1): 12:28:10 | 1 of 4 START test accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending [RUN]
2021-06-25 12:28:10.944044 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 12:28:10.944134 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:28:10.954960 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-25 12:28:10.971932 (Thread-1): finished collecting timing info
2021-06-25 12:28:10.972105 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:28:10.976506 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'returned','completed','shipped','placed','return_pending'
    )
)

select count(*) as validation_errors
from validation_errors



2021-06-25 12:28:11.822155 (Thread-611): handling poll request
2021-06-25 12:28:11.822456 (Thread-611): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab67d4c0>]}
2021-06-25 12:28:11.823245 (Thread-611): sending response (<Response 11196 bytes [200 OK]>) to 10.0.42.69
2021-06-25 12:28:12.592502 (Thread-1): finished collecting timing info
2021-06-25 12:28:12.592927 (Thread-1): 12:28:12 | 1 of 4 PASS accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending [PASS in 1.65s]
2021-06-25 12:28:12.593010 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:28:12.593113 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:28:12.593199 (Thread-1): 12:28:12 | 2 of 4 START test assert_total_payments_amount_is_positive........... [RUN]
2021-06-25 12:28:12.593373 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:28:12.593442 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:28:12.602926 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-25 12:28:12.629764 (Thread-1): finished collecting timing info
2021-06-25 12:28:12.629982 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:28:12.635852 (Thread-1): On test.jaffle_shop.assert_total_payments_amount_is_positive: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.assert_total_payments_amount_is_positive"} */

with dbt__CTE__INTERNAL_test as (
select
    order_id,
    sum(amount) as total_amount
from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
group by 1
having not(total_amount >= 0)
)select count(*) from dbt__CTE__INTERNAL_test
2021-06-25 12:28:13.155452 (Thread-612): handling poll request
2021-06-25 12:28:13.155743 (Thread-612): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab04b790>]}
2021-06-25 12:28:13.156414 (Thread-612): sending response (<Response 5873 bytes [200 OK]>) to 10.0.45.5
2021-06-25 12:28:13.846152 (Thread-1): finished collecting timing info
2021-06-25 12:28:13.846595 (Thread-1): 12:28:13 | 2 of 4 PASS assert_total_payments_amount_is_positive................. [PASS in 1.25s]
2021-06-25 12:28:13.846679 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:28:13.846780 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:28:13.846863 (Thread-1): 12:28:13 | 3 of 4 START test not_null_stg_customers_customer_id................. [RUN]
2021-06-25 12:28:13.847041 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-06-25 12:28:13.847111 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:28:13.854565 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-06-25 12:28:13.872083 (Thread-1): finished collecting timing info
2021-06-25 12:28:13.872234 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:28:13.877073 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
where customer_id is null



2021-06-25 12:28:14.481623 (Thread-613): handling poll request
2021-06-25 12:28:14.481940 (Thread-613): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab37a910>]}
2021-06-25 12:28:14.482605 (Thread-613): sending response (<Response 5465 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:28:15.838180 (Thread-614): handling poll request
2021-06-25 12:28:15.838531 (Thread-614): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2ba2b0>]}
2021-06-25 12:28:15.839249 (Thread-614): sending response (<Response 286 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:28:17.112619 (Thread-615): handling poll request
2021-06-25 12:28:17.112903 (Thread-615): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab4f9b20>]}
2021-06-25 12:28:17.113467 (Thread-615): sending response (<Response 286 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:28:17.658763 (Thread-1): finished collecting timing info
2021-06-25 12:28:17.659188 (Thread-1): 12:28:17 | 3 of 4 PASS not_null_stg_customers_customer_id....................... [PASS in 3.81s]
2021-06-25 12:28:17.659272 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:28:17.659373 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:28:17.659456 (Thread-1): 12:28:17 | 4 of 4 START test unique_stg_customers_customer_id................... [RUN]
2021-06-25 12:28:17.659625 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-06-25 12:28:17.659695 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:28:17.666409 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-06-25 12:28:17.684012 (Thread-1): finished collecting timing info
2021-06-25 12:28:17.684172 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 12:28:17.688604 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-06-25 12:28:18.424867 (Thread-616): handling poll request
2021-06-25 12:28:18.425166 (Thread-616): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab29aaf0>]}
2021-06-25 12:28:18.425857 (Thread-616): sending response (<Response 5540 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:28:19.181647 (Thread-1): finished collecting timing info
2021-06-25 12:28:19.182103 (Thread-1): 12:28:19 | 4 of 4 PASS unique_stg_customers_customer_id......................... [PASS in 1.52s]
2021-06-25 12:28:19.182189 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:28:19.183561 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:28:19.183823 (MainThread): 12:28:19 | 
2021-06-25 12:28:19.183890 (MainThread): 12:28:19 | Finished running 4 tests in 8.41s.
2021-06-25 12:28:19.183940 (MainThread): Connection 'master' was properly closed.
2021-06-25 12:28:19.183981 (MainThread): Connection 'test.jaffle_shop.unique_stg_customers_customer_id' was properly closed.
2021-06-25 12:28:19.245004 (MainThread): 
2021-06-25 12:28:19.245154 (MainThread): Completed successfully
2021-06-25 12:28:19.245223 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-06-25 12:28:19.698653 (Thread-617): handling poll request
2021-06-25 12:28:19.698963 (Thread-617): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6ac670>]}
2021-06-25 12:28:19.700257 (Thread-617): sending response (<Response 14298 bytes [200 OK]>) to 10.0.47.156
2021-06-25 12:28:20.259289 (Thread-618): handling status request
2021-06-25 12:28:20.259597 (Thread-618): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6ac580>]}
2021-06-25 12:28:20.260163 (Thread-618): sending response (<Response 1761 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:28:20.294746 (Thread-619): handling status request
2021-06-25 12:28:20.294996 (Thread-619): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6ac550>]}
2021-06-25 12:28:20.295478 (Thread-619): sending response (<Response 1761 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:28:20.345098 (Thread-620): handling status request
2021-06-25 12:28:20.345314 (Thread-620): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab6ac520>]}
2021-06-25 12:28:20.345788 (Thread-620): sending response (<Response 1761 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:44:24.281202 (Thread-621): Got an acceptable cached parse result
2021-06-25 12:44:24.431818 (Thread-621): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:44:24.437731 (Thread-621): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:44:24.438338 (Thread-621): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2db3d0>]}
2021-06-25 12:44:24.824790 (Thread-622): handling status request
2021-06-25 12:44:24.825076 (Thread-622): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaab52be0>]}
2021-06-25 12:44:24.825618 (Thread-622): sending response (<Response 1761 bytes [200 OK]>) to 10.0.31.198
2021-06-25 12:44:24.878893 (Thread-623): handling status request
2021-06-25 12:44:24.879712 (Thread-624): handling status request
2021-06-25 12:44:24.879871 (Thread-623): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab1d08e0>]}
2021-06-25 12:44:24.880090 (Thread-624): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab0b1640>]}
2021-06-25 12:44:24.882205 (Thread-623): sending response (<Response 1761 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:44:24.882708 (Thread-624): sending response (<Response 1761 bytes [200 OK]>) to 10.0.31.198
2021-06-25 12:44:30.300923 (Thread-625): Got an acceptable cached parse result
2021-06-25 12:44:30.439239 (Thread-625): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:44:30.445446 (Thread-625): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:44:30.446003 (Thread-625): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaab38d90>]}
2021-06-25 12:44:30.739927 (Thread-626): handling status request
2021-06-25 12:44:30.740221 (Thread-626): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaab16f70>]}
2021-06-25 12:44:30.740754 (Thread-626): sending response (<Response 1761 bytes [200 OK]>) to 10.0.45.5
2021-06-25 12:44:30.751192 (Thread-627): handling status request
2021-06-25 12:44:30.751441 (Thread-627): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab272370>]}
2021-06-25 12:44:30.751924 (Thread-627): sending response (<Response 1761 bytes [200 OK]>) to 10.0.42.69
2021-06-25 12:44:30.853730 (Thread-628): handling status request
2021-06-25 12:44:30.854037 (Thread-628): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaab383a0>]}
2021-06-25 12:44:30.854608 (Thread-628): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:46:57.224291 (Thread-629): Got an acceptable cached parse result
2021-06-25 12:46:57.537824 (Thread-629): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:46:57.543623 (Thread-629): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:46:57.544173 (Thread-629): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc49be970>]}
2021-06-25 12:46:57.734213 (Thread-630): handling status request
2021-06-25 12:46:57.734517 (Thread-630): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc49beca0>]}
2021-06-25 12:46:57.735058 (Thread-630): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:46:57.791498 (Thread-631): handling status request
2021-06-25 12:46:57.791896 (Thread-631): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4b1abe0>]}
2021-06-25 12:46:57.792459 (Thread-631): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:46:57.812086 (Thread-632): handling status request
2021-06-25 12:46:57.812339 (Thread-632): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc49be220>]}
2021-06-25 12:46:57.812860 (Thread-632): sending response (<Response 1761 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:50:45.477435 (Thread-633): handling status request
2021-06-25 12:50:45.479659 (Thread-633): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4b1abe0>]}
2021-06-25 12:50:45.480210 (Thread-633): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:50:45.606753 (Thread-634): handling status request
2021-06-25 12:50:45.607046 (Thread-634): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc49d44c0>]}
2021-06-25 12:50:45.607568 (Thread-634): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:50:45.754290 (Thread-635): handling cli_args request
2021-06-25 12:50:45.754580 (Thread-635): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc49d4250>]}
2021-06-25 12:50:45.792223 (Thread-635): sending response (<Response 581 bytes [200 OK]>) to 10.0.42.69
2021-06-25 12:50:50.379138 (Thread-636): handling status request
2021-06-25 12:50:50.379453 (Thread-636): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4abe910>]}
2021-06-25 12:50:50.380006 (Thread-636): sending response (<Response 1761 bytes [200 OK]>) to 10.0.21.135
2021-06-25 12:50:50.381091 (Thread-637): handling status request
2021-06-25 12:50:50.381280 (Thread-637): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4a67e20>]}
2021-06-25 12:50:50.381740 (Thread-637): sending response (<Response 1761 bytes [200 OK]>) to 10.0.47.156
2021-06-25 12:50:50.403322 (Thread-638): handling status request
2021-06-25 12:50:50.403519 (Thread-638): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaad316a0>]}
2021-06-25 12:50:50.403926 (Thread-638): sending response (<Response 1761 bytes [200 OK]>) to 10.0.47.156
2021-06-25 12:51:09.060300 (Thread-639): handling status request
2021-06-25 12:51:09.060587 (Thread-639): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4a67df0>]}
2021-06-25 12:51:09.061189 (Thread-639): sending response (<Response 1761 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:51:09.111182 (Thread-640): handling status request
2021-06-25 12:51:09.111451 (Thread-640): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaafed7c0>]}
2021-06-25 12:51:09.111977 (Thread-640): sending response (<Response 1761 bytes [200 OK]>) to 10.0.47.156
2021-06-25 12:51:09.270591 (Thread-641): handling docs.generate request
2021-06-25 12:51:09.270868 (Thread-641): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a2fb80>]}
2021-06-25 12:51:11.059975 (Thread-641): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.203
2021-06-25 12:51:11.094987 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a318ccbd-8ed7-4e64-a5d9-e3bb876b5fe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6cdde9940>]}
2021-06-25 12:51:11.095558 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:51:11.096662 (MainThread): 
2021-06-25 12:51:11.096796 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:51:11.097796 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 12:51:11.097903 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 12:51:11.310102 (MainThread): 12:51:11 | Concurrency: 1 threads (target='default')
2021-06-25 12:51:11.310230 (MainThread): 12:51:11 | 
2021-06-25 12:51:11.312876 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 12:51:11.313047 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:51:11.313125 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 12:51:11.314710 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 12:51:11.333976 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.334114 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.334228 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 12:51:11.334314 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 12:51:11.334395 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:51:11.334452 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 12:51:11.335630 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 12:51:11.342125 (Thread-642): handling poll request
2021-06-25 12:51:11.342391 (Thread-642): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc49bbfd0>]}
2021-06-25 12:51:11.343475 (Thread-642): sending response (<Response 7425 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:51:11.354965 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.355084 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.355183 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 12:51:11.355263 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 12:51:11.355336 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:51:11.355392 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 12:51:11.356352 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 12:51:11.375833 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.375971 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.376079 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 12:51:11.376161 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:51:11.376243 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 12:51:11.376300 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:51:11.389179 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-25 12:51:11.405647 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.405785 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.405891 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:51:11.405973 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 12:51:11.406051 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:51:11.406108 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 12:51:11.408438 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 12:51:11.425070 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.425235 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.425354 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 12:51:11.425444 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:51:11.425534 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:51:11.425596 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:51:11.439252 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-25 12:51:11.455516 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.455676 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.455794 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:51:11.455880 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:51:11.455968 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-06-25 12:51:11.456029 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:51:11.462640 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-06-25 12:51:11.480021 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.480152 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.480263 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:51:11.480347 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:51:11.480426 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-06-25 12:51:11.480483 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:51:11.486688 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-06-25 12:51:11.504641 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.504776 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.504886 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:51:11.504971 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 12:51:11.505056 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:51:11.505114 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 12:51:11.507595 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 12:51:11.526995 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.527137 (Thread-1): finished collecting timing info
2021-06-25 12:51:11.527252 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 12:51:11.528352 (MainThread): Connection 'master' was properly closed.
2021-06-25 12:51:11.528446 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 12:51:11.596387 (MainThread): 12:51:11 | Done.
2021-06-25 12:51:11.649358 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-06-25 12:51:11.649457 (MainThread): 12:51:11 | Building catalog
2021-06-25 12:51:11.650259 (MainThread): Opening a new connection, currently in state init
2021-06-25 12:51:11.838872 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "neat-episode-288515.information_schema".
2021-06-25 12:51:11.853914 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 12:51:11.858256 (ThreadPoolExecutor-1_0): On neat-episode-288515.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `neat-episode-288515`.`dbt_mskonberg`.__TABLES__
        where (upper(dataset_id) = upper('dbt_mskonberg'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-25 12:51:12.805222 (Thread-643): handling poll request
2021-06-25 12:51:12.805590 (Thread-643): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2f1310>]}
2021-06-25 12:51:12.807050 (Thread-643): sending response (<Response 34370 bytes [200 OK]>) to 10.0.36.19
2021-06-25 12:51:14.121234 (Thread-644): handling poll request
2021-06-25 12:51:14.121533 (Thread-644): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4a2e250>]}
2021-06-25 12:51:14.122124 (Thread-644): sending response (<Response 295 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:51:14.797789 (MainThread): 12:51:14 | Catalog written to /usr/src/develop/user-26678/environment-32465/repository-26421/target/catalog.json
2021-06-25 12:51:15.464353 (Thread-645): handling poll request
2021-06-25 12:51:15.464642 (Thread-645): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab701fd0>]}
2021-06-25 12:51:15.465532 (Thread-645): sending response (<Response 5498 bytes [200 OK]>) to 10.0.26.142
2021-06-25 12:51:16.160880 (Thread-646): handling status request
2021-06-25 12:51:16.161172 (Thread-646): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab701d00>]}
2021-06-25 12:51:16.161756 (Thread-646): sending response (<Response 1761 bytes [200 OK]>) to 10.0.47.156
2021-06-25 12:51:16.248114 (Thread-647): handling status request
2021-06-25 12:51:16.248398 (Thread-647): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab724100>]}
2021-06-25 12:51:16.248918 (Thread-647): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:51:16.401952 (Thread-648): handling status request
2021-06-25 12:51:16.402558 (Thread-648): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab724b80>]}
2021-06-25 12:51:16.403013 (Thread-649): handling status request
2021-06-25 12:51:16.403610 (Thread-648): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.2
2021-06-25 12:51:16.403919 (Thread-649): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab56f940>]}
2021-06-25 12:51:16.404675 (Thread-649): sending response (<Response 1761 bytes [200 OK]>) to 10.0.26.7
2021-06-25 12:53:27.143646 (Thread-650): Got an acceptable cached parse result
2021-06-25 12:53:27.313435 (Thread-650): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 12:53:27.320401 (Thread-650): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 12:53:27.320919 (Thread-650): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaabf3310>]}
2021-06-25 12:53:27.789357 (Thread-651): handling status request
2021-06-25 12:53:27.789717 (Thread-651): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab007c40>]}
2021-06-25 12:53:27.790273 (Thread-651): sending response (<Response 1761 bytes [200 OK]>) to 10.0.10.110
2021-06-25 12:53:27.829455 (Thread-652): handling status request
2021-06-25 12:53:27.829731 (Thread-652): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8b9d670>]}
2021-06-25 12:53:27.830236 (Thread-652): sending response (<Response 1761 bytes [200 OK]>) to 10.0.24.126
2021-06-25 12:53:27.952036 (Thread-653): handling status request
2021-06-25 12:53:27.952324 (Thread-653): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab691b80>]}
2021-06-25 12:53:27.952845 (Thread-653): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:53:33.774645 (Thread-654): handling status request
2021-06-25 12:53:33.774932 (Thread-654): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab691eb0>]}
2021-06-25 12:53:33.775471 (Thread-654): sending response (<Response 1761 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:53:33.850275 (Thread-655): handling status request
2021-06-25 12:53:33.850630 (Thread-655): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab2e9820>]}
2021-06-25 12:53:33.851153 (Thread-655): sending response (<Response 1761 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:53:34.051376 (Thread-656): handling docs.generate request
2021-06-25 12:53:34.051669 (Thread-656): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab67d8e0>]}
2021-06-25 12:53:35.833739 (Thread-656): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:53:35.889388 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f323f99f-2d8d-4ede-ad98-024891432243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8451c6a00>]}
2021-06-25 12:53:35.890253 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 12:53:35.892001 (MainThread): 
2021-06-25 12:53:35.892205 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 12:53:35.893817 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 12:53:35.893958 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 12:53:36.125267 (MainThread): 12:53:36 | Concurrency: 1 threads (target='default')
2021-06-25 12:53:36.125401 (MainThread): 12:53:36 | 
2021-06-25 12:53:36.128172 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 12:53:36.128350 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 12:53:36.128426 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 12:53:36.130018 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 12:53:36.150589 (Thread-657): handling poll request
2021-06-25 12:53:36.148263 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.151160 (Thread-657): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaabe8820>]}
2021-06-25 12:53:36.148450 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.152619 (Thread-657): sending response (<Response 5360 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:53:36.148574 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 12:53:36.148671 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 12:53:36.148761 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 12:53:36.148826 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 12:53:36.150132 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 12:53:36.166849 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.167023 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.167145 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 12:53:36.167234 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 12:53:36.167324 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 12:53:36.167385 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 12:53:36.168631 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 12:53:36.186255 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.186434 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.186554 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 12:53:36.186644 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:53:36.186735 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 12:53:36.186795 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:53:36.199998 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-25 12:53:36.225559 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.225751 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.225876 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 12:53:36.225972 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 12:53:36.226066 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 12:53:36.226137 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 12:53:36.229049 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 12:53:36.244713 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.244946 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.245119 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 12:53:36.245255 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:53:36.245390 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 12:53:36.245485 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:53:36.256772 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-25 12:53:36.275229 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.275389 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.275507 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 12:53:36.275596 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:53:36.275685 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2021-06-25 12:53:36.275745 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:53:36.282384 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2021-06-25 12:53:36.300952 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.301083 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.301193 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2021-06-25 12:53:36.301277 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:53:36.301358 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2021-06-25 12:53:36.301414 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:53:36.307899 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2021-06-25 12:53:36.324548 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.324668 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.324770 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2021-06-25 12:53:36.324853 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 12:53:36.324935 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 12:53:36.324990 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 12:53:36.327333 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 12:53:36.344178 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.344295 (Thread-1): finished collecting timing info
2021-06-25 12:53:36.344394 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 12:53:36.345383 (MainThread): Connection 'master' was properly closed.
2021-06-25 12:53:36.345475 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 12:53:36.419092 (MainThread): 12:53:36 | Done.
2021-06-25 12:53:36.480149 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-06-25 12:53:36.480287 (MainThread): 12:53:36 | Building catalog
2021-06-25 12:53:36.481069 (MainThread): Opening a new connection, currently in state init
2021-06-25 12:53:36.651474 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "neat-episode-288515.information_schema".
2021-06-25 12:53:36.665808 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 12:53:36.670100 (ThreadPoolExecutor-1_0): On neat-episode-288515.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `neat-episode-288515`.`dbt_mskonberg`.__TABLES__
        where (upper(dataset_id) = upper('dbt_mskonberg'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-25 12:53:37.464966 (Thread-658): handling poll request
2021-06-25 12:53:37.465288 (Thread-658): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4a83c10>]}
2021-06-25 12:53:37.466867 (Thread-658): sending response (<Response 36435 bytes [200 OK]>) to 10.0.36.22
2021-06-25 12:53:38.712080 (Thread-659): handling poll request
2021-06-25 12:53:38.712379 (Thread-659): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4a7a220>]}
2021-06-25 12:53:38.713023 (Thread-659): sending response (<Response 295 bytes [200 OK]>) to 10.0.40.45
2021-06-25 12:53:39.312405 (MainThread): 12:53:39 | Catalog written to /usr/src/develop/user-26678/environment-32465/repository-26421/target/catalog.json
2021-06-25 12:53:39.923365 (Thread-660): handling poll request
2021-06-25 12:53:39.923658 (Thread-660): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4aad3a0>]}
2021-06-25 12:53:39.924568 (Thread-660): sending response (<Response 5498 bytes [200 OK]>) to 10.0.6.80
2021-06-25 12:53:40.627609 (Thread-661): handling status request
2021-06-25 12:53:40.627943 (Thread-661): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4aadb50>]}
2021-06-25 12:53:40.628526 (Thread-661): sending response (<Response 1761 bytes [200 OK]>) to 10.0.3.5
2021-06-25 12:53:40.702593 (Thread-662): handling status request
2021-06-25 12:53:40.702876 (Thread-662): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaac95c10>]}
2021-06-25 12:53:40.703408 (Thread-662): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.72
2021-06-25 12:53:40.758159 (Thread-663): handling status request
2021-06-25 12:53:40.758424 (Thread-663): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaac95a60>]}
2021-06-25 12:53:40.758923 (Thread-663): sending response (<Response 1761 bytes [200 OK]>) to 10.0.12.250
2021-06-25 12:53:40.930338 (Thread-664): handling status request
2021-06-25 12:53:40.930623 (Thread-664): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaabe01c0>]}
2021-06-25 12:53:40.931142 (Thread-664): sending response (<Response 1761 bytes [200 OK]>) to 10.0.47.156
2021-06-25 13:00:13.335630 (Thread-665): Got an acceptable cached parse result
2021-06-25 13:00:13.495660 (Thread-665): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 13:00:13.503707 (Thread-665): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 13:00:13.504191 (Thread-665): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa9e1c10>]}
2021-06-25 13:00:13.952494 (Thread-666): handling status request
2021-06-25 13:00:13.952782 (Thread-666): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa992c10>]}
2021-06-25 13:00:13.953304 (Thread-666): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.22
2021-06-25 13:00:14.029213 (Thread-667): handling status request
2021-06-25 13:00:14.029500 (Thread-667): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa992c70>]}
2021-06-25 13:00:14.030095 (Thread-667): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.19
2021-06-25 13:00:14.079758 (Thread-668): handling status request
2021-06-25 13:00:14.080093 (Thread-668): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4ad1e20>]}
2021-06-25 13:00:14.080743 (Thread-668): sending response (<Response 1761 bytes [200 OK]>) to 10.0.26.7
2021-06-25 13:00:21.882408 (Thread-669): handling status request
2021-06-25 13:00:21.882706 (Thread-669): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4aaba30>]}
2021-06-25 13:00:21.883216 (Thread-669): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.2
2021-06-25 13:00:22.069150 (Thread-670): handling status request
2021-06-25 13:00:22.069434 (Thread-670): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa9cbe80>]}
2021-06-25 13:00:22.069975 (Thread-670): sending response (<Response 1761 bytes [200 OK]>) to 10.0.26.7
2021-06-25 13:00:22.213843 (Thread-671): handling cli_args request
2021-06-25 13:00:22.214129 (Thread-671): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaad015b0>]}
2021-06-25 13:00:24.021885 (Thread-671): sending response (<Response 138 bytes [200 OK]>) to 10.0.26.142
2021-06-25 13:00:24.072069 (MainThread): Partial parsing not enabled
2021-06-25 13:00:24.075065 (MainThread): Parsing macros/adapters.sql
2021-06-25 13:00:24.097938 (MainThread): Parsing macros/etc.sql
2021-06-25 13:00:24.100125 (MainThread): Parsing macros/catalog.sql
2021-06-25 13:00:24.106288 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 13:00:24.110811 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 13:00:24.120570 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 13:00:24.133191 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 13:00:24.135934 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 13:00:24.137816 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 13:00:24.141282 (MainThread): Parsing macros/core.sql
2021-06-25 13:00:24.145123 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 13:00:24.154153 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 13:00:24.168048 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 13:00:24.169929 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 13:00:24.187196 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 13:00:24.225305 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 13:00:24.230250 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 13:00:24.236442 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 13:00:24.256818 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 13:00:24.263358 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 13:00:24.265225 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 13:00:24.271268 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 13:00:24.272914 (MainThread): Parsing macros/etc/query.sql
2021-06-25 13:00:24.274129 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 13:00:24.282921 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 13:00:24.283904 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 13:00:24.285622 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 13:00:24.287700 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 13:00:24.289255 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 13:00:24.291973 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 13:00:24.293892 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 13:00:24.295652 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 13:00:24.323805 (Thread-672): handling poll request
2021-06-25 13:00:24.324116 (Thread-672): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa9d4160>]}
2021-06-25 13:00:24.325302 (Thread-672): sending response (<Response 9375 bytes [200 OK]>) to 10.0.40.72
2021-06-25 13:00:24.345124 (MainThread): Partial parsing not enabled
2021-06-25 13:00:24.378946 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 13:00:24.390474 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 13:00:24.395173 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 13:00:24.399866 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 13:00:24.406337 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 13:00:24.423243 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 13:00:24.556346 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 13:00:24.564036 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 13:00:24.564367 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a446298-8bd4-400d-800c-d14bf9a55bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d218c3940>]}
2021-06-25 13:00:24.600577 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a446298-8bd4-400d-800c-d14bf9a55bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d21af2ac0>]}
2021-06-25 13:00:24.600809 (MainThread): Found 5 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 13:00:24.601583 (MainThread): 
2021-06-25 13:00:24.601845 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 13:00:24.602787 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 13:00:24.602907 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 13:00:24.793210 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 13:00:24.793349 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 13:00:24.991665 (MainThread): 13:00:24 | Concurrency: 1 threads (target='default')
2021-06-25 13:00:24.991795 (MainThread): 13:00:24 | 
2021-06-25 13:00:24.993836 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 13:00:24.994099 (Thread-1): 13:00:24 | 1 of 5 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 13:00:24.994321 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 13:00:24.994398 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 13:00:24.995920 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 13:00:25.014180 (Thread-1): finished collecting timing info
2021-06-25 13:00:25.041113 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 13:00:25.060364 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 13:00:25.064781 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 13:00:25.646579 (Thread-673): handling poll request
2021-06-25 13:00:25.646871 (Thread-673): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa3fefd0>]}
2021-06-25 13:00:25.647707 (Thread-673): sending response (<Response 10752 bytes [200 OK]>) to 10.0.40.72
2021-06-25 13:00:26.045071 (Thread-1): finished collecting timing info
2021-06-25 13:00:26.045438 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a446298-8bd4-400d-800c-d14bf9a55bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d219b63d0>]}
2021-06-25 13:00:26.045893 (Thread-1): 13:00:26 | 1 of 5 OK created view model dbt_mskonberg.stg_orders................ [OK in 1.05s]
2021-06-25 13:00:26.045972 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 13:00:26.046072 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 13:00:26.046201 (Thread-1): 13:00:26 | 2 of 5 START view model dbt_mskonberg.stg_payments................... [RUN]
2021-06-25 13:00:26.046378 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 13:00:26.046444 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 13:00:26.047495 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 13:00:26.064549 (Thread-1): finished collecting timing info
2021-06-25 13:00:26.066284 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 13:00:26.084313 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 13:00:26.088585 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
  OPTIONS()
  as with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial.stripe.payment`

)

select * from payments;


2021-06-25 13:00:26.951291 (Thread-674): handling poll request
2021-06-25 13:00:26.951595 (Thread-674): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa9ed820>]}
2021-06-25 13:00:26.952278 (Thread-674): sending response (<Response 6111 bytes [200 OK]>) to 10.0.6.80
2021-06-25 13:00:27.175620 (Thread-1): finished collecting timing info
2021-06-25 13:00:27.175996 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a446298-8bd4-400d-800c-d14bf9a55bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d219b63d0>]}
2021-06-25 13:00:27.176283 (Thread-1): 13:00:27 | 2 of 5 OK created view model dbt_mskonberg.stg_payments.............. [OK in 1.13s]
2021-06-25 13:00:27.176357 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 13:00:27.176450 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 13:00:27.176607 (Thread-1): 13:00:27 | 3 of 5 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 13:00:27.176868 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 13:00:27.176970 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 13:00:27.178119 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 13:00:27.194738 (Thread-1): finished collecting timing info
2021-06-25 13:00:27.196808 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 13:00:27.213849 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 13:00:27.218131 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 13:00:28.155532 (Thread-1): finished collecting timing info
2021-06-25 13:00:28.155915 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a446298-8bd4-400d-800c-d14bf9a55bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2193e0a0>]}
2021-06-25 13:00:28.156345 (Thread-1): 13:00:28 | 3 of 5 OK created view model dbt_mskonberg.stg_customers............. [OK in 0.98s]
2021-06-25 13:00:28.156441 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 13:00:28.156536 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 13:00:28.156669 (Thread-1): 13:00:28 | 4 of 5 START table model dbt_mskonberg.fct_orders.................... [RUN]
2021-06-25 13:00:28.157616 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 13:00:28.157748 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 13:00:28.160532 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 13:00:28.177001 (Thread-1): finished collecting timing info
2021-06-25 13:00:28.190970 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 13:00:28.223602 (Thread-675): handling poll request
2021-06-25 13:00:28.223836 (Thread-675): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa0c610>]}
2021-06-25 13:00:28.224623 (Thread-675): sending response (<Response 10576 bytes [200 OK]>) to 10.0.40.72
2021-06-25 13:00:28.383336 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 13:00:28.399883 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`
  
  
  OPTIONS()
  as (
    --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
    
2021-06-25 13:00:29.546088 (Thread-676): handling poll request
2021-06-25 13:00:29.546378 (Thread-676): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa0cfa0>]}
2021-06-25 13:00:29.546934 (Thread-676): sending response (<Response 1865 bytes [200 OK]>) to 10.0.36.22
2021-06-25 13:00:30.845625 (Thread-677): handling poll request
2021-06-25 13:00:30.845952 (Thread-677): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa0c7f0>]}
2021-06-25 13:00:30.846468 (Thread-677): sending response (<Response 285 bytes [200 OK]>) to 10.0.12.250
2021-06-25 13:00:32.381488 (Thread-678): handling poll request
2021-06-25 13:00:32.381922 (Thread-678): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa0cbe0>]}
2021-06-25 13:00:32.382700 (Thread-678): sending response (<Response 285 bytes [200 OK]>) to 10.0.40.72
2021-06-25 13:00:32.404224 (Thread-1): finished collecting timing info
2021-06-25 13:00:32.404619 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a446298-8bd4-400d-800c-d14bf9a55bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d218c3b50>]}
2021-06-25 13:00:32.404909 (Thread-1): 13:00:32 | 4 of 5 OK created table model dbt_mskonberg.fct_orders............... [CREATE TABLE (99.0 rows, 5.2 KB processed) in 4.25s]
2021-06-25 13:00:32.404982 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 13:00:32.405901 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 13:00:32.406139 (Thread-1): 13:00:32 | 5 of 5 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-25 13:00:32.406368 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 13:00:32.406441 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 13:00:32.409531 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 13:00:32.425608 (Thread-1): finished collecting timing info
2021-06-25 13:00:32.427201 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 13:00:32.604695 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 13:00:32.621367 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders
    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 13:00:33.717526 (Thread-679): handling poll request
2021-06-25 13:00:33.717836 (Thread-679): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4b003d0>]}
2021-06-25 13:00:33.718529 (Thread-679): sending response (<Response 6865 bytes [200 OK]>) to 10.0.6.80
2021-06-25 13:00:35.093706 (Thread-680): handling poll request
2021-06-25 13:00:35.094015 (Thread-680): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4b004c0>]}
2021-06-25 13:00:35.094558 (Thread-680): sending response (<Response 286 bytes [200 OK]>) to 10.0.26.142
2021-06-25 13:00:36.400844 (Thread-681): handling poll request
2021-06-25 13:00:36.401125 (Thread-681): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4b00a00>]}
2021-06-25 13:00:36.401630 (Thread-681): sending response (<Response 286 bytes [200 OK]>) to 10.0.40.45
2021-06-25 13:00:37.090860 (Thread-1): finished collecting timing info
2021-06-25 13:00:37.091284 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a446298-8bd4-400d-800c-d14bf9a55bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d20234790>]}
2021-06-25 13:00:37.091600 (Thread-1): 13:00:37 | 5 of 5 OK created table model dbt_mskonberg.dim_customers............ [CREATE TABLE (100.0 rows, 5.0 KB processed) in 4.68s]
2021-06-25 13:00:37.091676 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 13:00:37.092996 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 13:00:37.093287 (MainThread): 13:00:37 | 
2021-06-25 13:00:37.093353 (MainThread): 13:00:37 | Finished running 3 view models, 2 table models in 12.49s.
2021-06-25 13:00:37.093401 (MainThread): Connection 'master' was properly closed.
2021-06-25 13:00:37.093442 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 13:00:37.154189 (MainThread): 
2021-06-25 13:00:37.154319 (MainThread): Completed successfully
2021-06-25 13:00:37.154387 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-06-25 13:00:37.708806 (Thread-682): handling poll request
2021-06-25 13:00:37.709108 (Thread-682): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa0c910>]}
2021-06-25 13:00:37.710515 (Thread-682): sending response (<Response 20291 bytes [200 OK]>) to 10.0.24.126
2021-06-25 13:00:38.451150 (Thread-683): handling status request
2021-06-25 13:00:38.451438 (Thread-683): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa0c580>]}
2021-06-25 13:00:38.451979 (Thread-683): sending response (<Response 1761 bytes [200 OK]>) to 10.0.6.80
2021-06-25 13:00:38.515251 (Thread-684): handling status request
2021-06-25 13:00:38.515516 (Thread-684): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa0c790>]}
2021-06-25 13:00:38.516011 (Thread-684): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.19
2021-06-25 13:00:38.574289 (Thread-685): handling status request
2021-06-25 13:00:38.574536 (Thread-685): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab67dac0>]}
2021-06-25 13:00:38.575027 (Thread-685): sending response (<Response 1761 bytes [200 OK]>) to 10.0.10.110
2021-06-25 13:00:43.847328 (Thread-686): handling status request
2021-06-25 13:00:43.847717 (Thread-686): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa9e17f0>]}
2021-06-25 13:00:43.848441 (Thread-686): sending response (<Response 1761 bytes [200 OK]>) to 10.0.26.142
2021-06-25 13:00:43.922717 (Thread-687): handling status request
2021-06-25 13:00:43.923000 (Thread-687): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa9d4310>]}
2021-06-25 13:00:43.923512 (Thread-687): sending response (<Response 1761 bytes [200 OK]>) to 10.0.26.7
2021-06-25 13:00:44.073722 (Thread-688): handling docs.generate request
2021-06-25 13:00:44.074038 (Thread-688): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4b11610>]}
2021-06-25 13:00:45.857199 (Thread-688): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.19
2021-06-25 13:00:45.889518 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a975dbba-f3d7-4160-9b3a-b30c5196ee5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7487920670>]}
2021-06-25 13:00:45.890048 (MainThread): Found 5 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 13:00:45.890973 (MainThread): 
2021-06-25 13:00:45.891101 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 13:00:45.892050 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 13:00:45.892160 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 13:00:46.071284 (MainThread): 13:00:46 | Concurrency: 1 threads (target='default')
2021-06-25 13:00:46.071412 (MainThread): 13:00:46 | 
2021-06-25 13:00:46.074170 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 13:00:46.074356 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 13:00:46.074432 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 13:00:46.075977 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 13:00:46.093714 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.093887 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.094009 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 13:00:46.094100 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 13:00:46.094188 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 13:00:46.094250 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 13:00:46.095386 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 13:00:46.111226 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.111377 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.111491 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 13:00:46.111576 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 13:00:46.111661 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 13:00:46.111720 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 13:00:46.112935 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 13:00:46.127018 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.127144 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.127250 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 13:00:46.127333 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 13:00:46.127420 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 13:00:46.127476 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 13:00:46.139944 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-25 13:00:46.157239 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.157375 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.157488 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 13:00:46.157571 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 13:00:46.157655 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 13:00:46.157737 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 13:00:46.160268 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 13:00:46.167670 (Thread-689): handling poll request
2021-06-25 13:00:46.167966 (Thread-689): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa999ca0>]}
2021-06-25 13:00:46.169415 (Thread-689): sending response (<Response 17508 bytes [200 OK]>) to 10.0.6.80
2021-06-25 13:00:46.176615 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.176745 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.176853 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 13:00:46.176937 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 13:00:46.177026 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 13:00:46.177084 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 13:00:46.186951 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-25 13:00:46.213115 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.213268 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.213387 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 13:00:46.213482 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 13:00:46.213571 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 13:00:46.213631 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 13:00:46.216439 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 13:00:46.233062 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.233198 (Thread-1): finished collecting timing info
2021-06-25 13:00:46.233312 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 13:00:46.234373 (MainThread): Connection 'master' was properly closed.
2021-06-25 13:00:46.234468 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 13:00:46.293826 (MainThread): 13:00:46 | Done.
2021-06-25 13:00:46.364942 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-06-25 13:00:46.365064 (MainThread): 13:00:46 | Building catalog
2021-06-25 13:00:46.365760 (MainThread): Opening a new connection, currently in state init
2021-06-25 13:00:46.554391 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "neat-episode-288515.information_schema".
2021-06-25 13:00:46.568046 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 13:00:46.572406 (ThreadPoolExecutor-1_0): On neat-episode-288515.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `neat-episode-288515`.`dbt_mskonberg`.__TABLES__
        where (upper(dataset_id) = upper('dbt_mskonberg'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-25 13:00:47.562129 (Thread-690): handling poll request
2021-06-25 13:00:47.562422 (Thread-690): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa99f880>]}
2021-06-25 13:00:47.563277 (Thread-690): sending response (<Response 17677 bytes [200 OK]>) to 10.0.36.22
2021-06-25 13:00:48.888430 (Thread-691): handling poll request
2021-06-25 13:00:48.888734 (Thread-691): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa99fa00>]}
2021-06-25 13:00:48.889266 (Thread-691): sending response (<Response 295 bytes [200 OK]>) to 10.0.45.5
2021-06-25 13:00:49.716692 (MainThread): 13:00:49 | Catalog written to /usr/src/develop/user-26678/environment-32465/repository-26421/target/catalog.json
2021-06-25 13:00:50.209506 (Thread-692): handling poll request
2021-06-25 13:00:50.209832 (Thread-692): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa95b20>]}
2021-06-25 13:00:50.210717 (Thread-692): sending response (<Response 5498 bytes [200 OK]>) to 10.0.24.126
2021-06-25 13:00:50.911471 (Thread-693): handling status request
2021-06-25 13:00:50.911880 (Thread-693): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa38cd0>]}
2021-06-25 13:00:50.912467 (Thread-693): sending response (<Response 1761 bytes [200 OK]>) to 10.0.21.135
2021-06-25 13:00:50.992473 (Thread-694): handling status request
2021-06-25 13:00:50.992779 (Thread-694): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4af7d90>]}
2021-06-25 13:00:50.993300 (Thread-694): sending response (<Response 1761 bytes [200 OK]>) to 10.0.12.250
2021-06-25 13:00:51.078901 (Thread-695): handling status request
2021-06-25 13:00:51.079186 (Thread-695): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4af71f0>]}
2021-06-25 13:00:51.086308 (Thread-696): handling status request
2021-06-25 13:00:51.086594 (Thread-696): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc4b29400>]}
2021-06-25 13:00:51.131669 (Thread-695): sending response (<Response 1761 bytes [200 OK]>) to 10.0.26.142
2021-06-25 13:00:51.132187 (Thread-696): sending response (<Response 1761 bytes [200 OK]>) to 10.0.6.80
2021-06-25 13:02:41.358223 (Thread-697): Got an acceptable cached parse result
2021-06-25 13:02:41.511490 (Thread-697): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 13:02:41.518622 (Thread-697): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 13:02:41.519199 (Thread-697): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa4231c0>]}
2021-06-25 13:02:41.930961 (Thread-698): handling status request
2021-06-25 13:02:41.931263 (Thread-698): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa423340>]}
2021-06-25 13:02:41.931801 (Thread-698): sending response (<Response 1761 bytes [200 OK]>) to 10.0.31.198
2021-06-25 13:02:41.943105 (Thread-699): handling status request
2021-06-25 13:02:41.943337 (Thread-699): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa423310>]}
2021-06-25 13:02:41.943818 (Thread-699): sending response (<Response 1761 bytes [200 OK]>) to 10.0.21.135
2021-06-25 13:02:42.056026 (Thread-700): handling status request
2021-06-25 13:02:42.056312 (Thread-700): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa40dfd0>]}
2021-06-25 13:02:42.056807 (Thread-700): sending response (<Response 1761 bytes [200 OK]>) to 10.0.31.198
2021-06-25 13:04:17.156800 (Thread-701): Got an acceptable cached parse result
2021-06-25 13:04:17.471891 (Thread-701): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 13:04:17.481587 (Thread-701): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 13:04:17.482141 (Thread-701): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa2b2190>]}
2021-06-25 13:04:17.866027 (Thread-702): handling status request
2021-06-25 13:04:17.866309 (Thread-702): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa2b2370>]}
2021-06-25 13:04:17.866824 (Thread-702): sending response (<Response 1761 bytes [200 OK]>) to 10.0.10.110
2021-06-25 13:04:17.912917 (Thread-703): handling status request
2021-06-25 13:04:17.913220 (Thread-703): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa2b24c0>]}
2021-06-25 13:04:17.913828 (Thread-703): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.22
2021-06-25 13:04:17.922019 (Thread-704): handling status request
2021-06-25 13:04:17.922203 (Thread-704): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab40b940>]}
2021-06-25 13:04:17.922622 (Thread-704): sending response (<Response 1761 bytes [200 OK]>) to 10.0.31.198
2021-06-25 13:04:23.895530 (Thread-705): handling status request
2021-06-25 13:04:23.895816 (Thread-705): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81e0970>]}
2021-06-25 13:04:23.896371 (Thread-705): sending response (<Response 1761 bytes [200 OK]>) to 10.0.47.156
2021-06-25 13:04:24.020243 (Thread-706): handling status request
2021-06-25 13:04:24.020537 (Thread-706): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb81e01f0>]}
2021-06-25 13:04:24.021454 (Thread-706): sending response (<Response 1761 bytes [200 OK]>) to 10.0.3.5
2021-06-25 13:04:24.148756 (Thread-707): handling cli_args request
2021-06-25 13:04:24.149036 (Thread-707): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa2b20d0>]}
2021-06-25 13:04:25.963758 (Thread-707): sending response (<Response 138 bytes [200 OK]>) to 10.0.21.135
2021-06-25 13:04:26.000683 (MainThread): Partial parsing not enabled
2021-06-25 13:04:26.003105 (MainThread): Parsing macros/adapters.sql
2021-06-25 13:04:26.024061 (MainThread): Parsing macros/etc.sql
2021-06-25 13:04:26.026330 (MainThread): Parsing macros/catalog.sql
2021-06-25 13:04:26.033154 (MainThread): Parsing macros/materializations/copy.sql
2021-06-25 13:04:26.037934 (MainThread): Parsing macros/materializations/table.sql
2021-06-25 13:04:26.048003 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-25 13:04:26.060596 (MainThread): Parsing macros/materializations/seed.sql
2021-06-25 13:04:26.063426 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-25 13:04:26.065332 (MainThread): Parsing macros/materializations/view.sql
2021-06-25 13:04:26.068913 (MainThread): Parsing macros/core.sql
2021-06-25 13:04:26.072871 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-25 13:04:26.081965 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-25 13:04:26.095913 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-25 13:04:26.097958 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-25 13:04:26.115554 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-25 13:04:26.147173 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-25 13:04:26.152199 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-25 13:04:26.158403 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-25 13:04:26.179257 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-25 13:04:26.185797 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-25 13:04:26.187662 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-25 13:04:26.193538 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-25 13:04:26.195193 (MainThread): Parsing macros/etc/query.sql
2021-06-25 13:04:26.196277 (MainThread): Parsing macros/etc/datetime.sql
2021-06-25 13:04:26.205002 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-25 13:04:26.206041 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-25 13:04:26.207792 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-25 13:04:26.209902 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-25 13:04:26.211610 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-25 13:04:26.214397 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-25 13:04:26.216370 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-25 13:04:26.218164 (MainThread): Parsing macros/adapters/common.sql
2021-06-25 13:04:26.268609 (MainThread): Partial parsing not enabled
2021-06-25 13:04:26.274937 (Thread-708): handling poll request
2021-06-25 13:04:26.275363 (Thread-708): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a33b20>]}
2021-06-25 13:04:26.276797 (Thread-708): sending response (<Response 9636 bytes [200 OK]>) to 10.0.26.7
2021-06-25 13:04:26.303119 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 13:04:26.314469 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 13:04:26.319303 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 13:04:26.324350 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 13:04:26.330695 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 13:04:26.348238 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 13:04:26.477964 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-25 13:04:26.486028 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-25 13:04:26.486397 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f6a7cd0-048b-47fb-a2ae-5593ddce8689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b59b6670>]}
2021-06-25 13:04:26.521714 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f6a7cd0-048b-47fb-a2ae-5593ddce8689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b5ab51c0>]}
2021-06-25 13:04:26.521980 (MainThread): Found 5 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 13:04:26.522807 (MainThread): 
2021-06-25 13:04:26.523063 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 13:04:26.524059 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515".
2021-06-25 13:04:26.524178 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 13:04:26.726736 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 13:04:26.726874 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-25 13:04:26.930666 (MainThread): 13:04:26 | Concurrency: 1 threads (target='default')
2021-06-25 13:04:26.930810 (MainThread): 13:04:26 | 
2021-06-25 13:04:26.933111 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 13:04:26.933389 (Thread-1): 13:04:26 | 1 of 5 START view model dbt_mskonberg.stg_orders..................... [RUN]
2021-06-25 13:04:26.933884 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 13:04:26.933985 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 13:04:26.935331 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 13:04:26.952884 (Thread-1): finished collecting timing info
2021-06-25 13:04:26.980324 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 13:04:26.997483 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 13:04:27.002115 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`
  OPTIONS()
  as with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial.jaffle_shop.orders`

)

select * from orders;


2021-06-25 13:04:27.589472 (Thread-709): handling poll request
2021-06-25 13:04:27.589804 (Thread-709): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa2b2df0>]}
2021-06-25 13:04:27.590679 (Thread-709): sending response (<Response 10491 bytes [200 OK]>) to 10.0.21.203
2021-06-25 13:04:27.948215 (Thread-1): finished collecting timing info
2021-06-25 13:04:27.948766 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f6a7cd0-048b-47fb-a2ae-5593ddce8689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b5a651c0>]}
2021-06-25 13:04:27.949363 (Thread-1): 13:04:27 | 1 of 5 OK created view model dbt_mskonberg.stg_orders................ [OK in 1.02s]
2021-06-25 13:04:27.949496 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 13:04:27.949656 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 13:04:27.949935 (Thread-1): 13:04:27 | 2 of 5 START view model dbt_mskonberg.stg_payments................... [RUN]
2021-06-25 13:04:27.950215 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 13:04:27.950334 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 13:04:27.952519 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 13:04:27.970535 (Thread-1): finished collecting timing info
2021-06-25 13:04:27.973447 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 13:04:27.991060 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 13:04:27.998944 (Thread-1): On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_payments"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`
  OPTIONS()
  as with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial.stripe.payment`

)

select * from payments;


2021-06-25 13:04:28.947419 (Thread-1): finished collecting timing info
2021-06-25 13:04:28.947782 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f6a7cd0-048b-47fb-a2ae-5593ddce8689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b5a38d60>]}
2021-06-25 13:04:28.948211 (Thread-1): 13:04:28 | 2 of 5 OK created view model dbt_mskonberg.stg_payments.............. [OK in 1.00s]
2021-06-25 13:04:28.948299 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 13:04:28.948404 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 13:04:28.948543 (Thread-1): 13:04:28 | 3 of 5 START view model dbt_mskonberg.stg_customers.................. [RUN]
2021-06-25 13:04:28.948742 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 13:04:28.948811 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 13:04:28.950174 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 13:04:28.967639 (Thread-1): finished collecting timing info
2021-06-25 13:04:28.969354 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 13:04:28.985980 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 13:04:28.990232 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial.jaffle_shop.customers`

)

select * from customers;


2021-06-25 13:04:29.008678 (Thread-710): handling poll request
2021-06-25 13:04:29.008923 (Thread-710): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8af1880>]}
2021-06-25 13:04:29.009858 (Thread-710): sending response (<Response 11814 bytes [200 OK]>) to 10.0.42.69
2021-06-25 13:04:29.893838 (Thread-1): finished collecting timing info
2021-06-25 13:04:29.894217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f6a7cd0-048b-47fb-a2ae-5593ddce8689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b5b25e50>]}
2021-06-25 13:04:29.894504 (Thread-1): 13:04:29 | 3 of 5 OK created view model dbt_mskonberg.stg_customers............. [OK in 0.95s]
2021-06-25 13:04:29.894577 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 13:04:29.894687 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 13:04:29.894828 (Thread-1): 13:04:29 | 4 of 5 START table model dbt_mskonberg.fct_orders.................... [RUN]
2021-06-25 13:04:29.895027 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 13:04:29.895098 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 13:04:29.898534 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 13:04:29.925152 (Thread-1): finished collecting timing info
2021-06-25 13:04:29.939261 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 13:04:30.170775 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 13:04:30.188653 (Thread-1): On model.jaffle_shop.fct_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.fct_orders"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`
  
  
  OPTIONS()
  as (
    --build this as a table



with payments as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_payments`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_orders`

),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders

    left join order_payments using (order_id)

)

select * from final
  );
    
2021-06-25 13:04:30.308155 (Thread-711): handling poll request
2021-06-25 13:04:30.308442 (Thread-711): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab42a5b0>]}
2021-06-25 13:04:30.309151 (Thread-711): sending response (<Response 6454 bytes [200 OK]>) to 10.0.40.2
2021-06-25 13:04:31.607627 (Thread-712): handling poll request
2021-06-25 13:04:31.607946 (Thread-712): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a39850>]}
2021-06-25 13:04:31.608471 (Thread-712): sending response (<Response 285 bytes [200 OK]>) to 10.0.42.69
2021-06-25 13:04:32.937406 (Thread-713): handling poll request
2021-06-25 13:04:32.937738 (Thread-713): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab42a760>]}
2021-06-25 13:04:32.938324 (Thread-713): sending response (<Response 285 bytes [200 OK]>) to 10.0.6.80
2021-06-25 13:04:33.286526 (Thread-1): finished collecting timing info
2021-06-25 13:04:33.286937 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f6a7cd0-048b-47fb-a2ae-5593ddce8689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b5a651c0>]}
2021-06-25 13:04:33.287409 (Thread-1): 13:04:33 | 4 of 5 OK created table model dbt_mskonberg.fct_orders............... [CREATE TABLE (99.0 rows, 5.2 KB processed) in 3.39s]
2021-06-25 13:04:33.287498 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 13:04:33.288293 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 13:04:33.288468 (Thread-1): 13:04:33 | 5 of 5 START table model dbt_mskonberg.dim_customers................. [RUN]
2021-06-25 13:04:33.288672 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 13:04:33.288742 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 13:04:33.291808 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 13:04:33.308947 (Thread-1): finished collecting timing info
2021-06-25 13:04:33.310340 (Thread-1): Opening a new connection, currently in state closed
2021-06-25 13:04:33.489529 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 13:04:33.508233 (Thread-1): On model.jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "model.jaffle_shop.dim_customers"} */


  create or replace table `neat-episode-288515`.`dbt_mskonberg`.`dim_customers`
  
  
  OPTIONS()
  as (
    --build this as a table



with customers as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`stg_customers`

),

orders as (

    select * from `neat-episode-288515`.`dbt_mskonberg`.`fct_orders`

),

customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders
    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        coalesce(customer_orders.lifetime_value, 0) as lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
  );
    
2021-06-25 13:04:34.257106 (Thread-714): handling poll request
2021-06-25 13:04:34.257392 (Thread-714): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9eb9d00>]}
2021-06-25 13:04:34.258134 (Thread-714): sending response (<Response 6865 bytes [200 OK]>) to 10.0.26.142
2021-06-25 13:04:35.472184 (Thread-715): handling poll request
2021-06-25 13:04:35.472480 (Thread-715): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9eb93d0>]}
2021-06-25 13:04:35.473011 (Thread-715): sending response (<Response 286 bytes [200 OK]>) to 10.0.31.198
2021-06-25 13:04:36.155715 (Thread-1): finished collecting timing info
2021-06-25 13:04:36.156131 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f6a7cd0-048b-47fb-a2ae-5593ddce8689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91b5a38be0>]}
2021-06-25 13:04:36.156429 (Thread-1): 13:04:36 | 5 of 5 OK created table model dbt_mskonberg.dim_customers............ [CREATE TABLE (100.0 rows, 5.0 KB processed) in 2.87s]
2021-06-25 13:04:36.156503 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 13:04:36.157901 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 13:04:36.158175 (MainThread): 13:04:36 | 
2021-06-25 13:04:36.158240 (MainThread): 13:04:36 | Finished running 3 view models, 2 table models in 9.64s.
2021-06-25 13:04:36.158288 (MainThread): Connection 'master' was properly closed.
2021-06-25 13:04:36.158327 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 13:04:36.220191 (MainThread): 
2021-06-25 13:04:36.220322 (MainThread): Completed successfully
2021-06-25 13:04:36.220392 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-06-25 13:04:36.782376 (Thread-716): handling poll request
2021-06-25 13:04:36.782662 (Thread-716): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab085250>]}
2021-06-25 13:04:36.784306 (Thread-716): sending response (<Response 20671 bytes [200 OK]>) to 10.0.31.198
2021-06-25 13:04:37.472989 (Thread-717): handling status request
2021-06-25 13:04:37.473320 (Thread-717): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab42a0a0>]}
2021-06-25 13:04:37.474000 (Thread-717): sending response (<Response 1761 bytes [200 OK]>) to 10.0.42.69
2021-06-25 13:04:37.574045 (Thread-718): handling status request
2021-06-25 13:04:37.574331 (Thread-718): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab42ae20>]}
2021-06-25 13:04:37.574902 (Thread-718): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.19
2021-06-25 13:04:37.594948 (Thread-719): handling status request
2021-06-25 13:04:37.595151 (Thread-719): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a39e80>]}
2021-06-25 13:04:37.595596 (Thread-719): sending response (<Response 1761 bytes [200 OK]>) to 10.0.12.250
2021-06-25 13:04:43.742841 (Thread-720): handling status request
2021-06-25 13:04:43.743138 (Thread-720): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaa2b2e20>]}
2021-06-25 13:04:43.743651 (Thread-720): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.19
2021-06-25 13:04:43.854568 (Thread-721): handling status request
2021-06-25 13:04:43.854962 (Thread-721): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8a39e80>]}
2021-06-25 13:04:43.855725 (Thread-721): sending response (<Response 1761 bytes [200 OK]>) to 10.0.36.19
2021-06-25 13:04:43.985801 (Thread-722): handling docs.generate request
2021-06-25 13:04:43.986091 (Thread-722): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab3ab370>]}
2021-06-25 13:04:45.759470 (Thread-722): sending response (<Response 138 bytes [200 OK]>) to 10.0.40.2
2021-06-25 13:04:45.798984 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50f2d121-b75c-4288-bfb1-ef80f9cebc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68dfe38880>]}
2021-06-25 13:04:45.799521 (MainThread): Found 5 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-06-25 13:04:45.800446 (MainThread): 
2021-06-25 13:04:45.800583 (MainThread): Acquiring new bigquery connection "master".
2021-06-25 13:04:45.801706 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-25 13:04:45.801810 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-25 13:04:45.993092 (Thread-723): handling poll request
2021-06-25 13:04:45.993417 (Thread-723): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaace78b0>]}
2021-06-25 13:04:45.994391 (Thread-723): sending response (<Response 2237 bytes [200 OK]>) to 10.0.6.80
2021-06-25 13:04:46.002541 (MainThread): 13:04:45 | Concurrency: 1 threads (target='default')
2021-06-25 13:04:46.002663 (MainThread): 13:04:45 | 
2021-06-25 13:04:46.005313 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-25 13:04:46.005494 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-25 13:04:46.005570 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-25 13:04:46.007175 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-25 13:04:46.026048 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.026212 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.026341 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-25 13:04:46.026433 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-25 13:04:46.026519 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-25 13:04:46.026579 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-25 13:04:46.027819 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-25 13:04:46.046772 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.046940 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.047064 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-25 13:04:46.047155 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-25 13:04:46.047239 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-25 13:04:46.047301 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-25 13:04:46.048476 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-25 13:04:46.067256 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.067410 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.067532 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-25 13:04:46.067634 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 13:04:46.067723 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-25 13:04:46.067785 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 13:04:46.080790 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-25 13:04:46.098108 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.098273 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.098395 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-25 13:04:46.098487 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-25 13:04:46.098577 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-25 13:04:46.098638 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-25 13:04:46.101319 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-25 13:04:46.119379 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.119522 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.119636 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-25 13:04:46.119725 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 13:04:46.119810 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-25 13:04:46.119871 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 13:04:46.129935 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-25 13:04:46.148242 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.148371 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.148481 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-25 13:04:46.148568 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-25 13:04:46.148654 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-25 13:04:46.148711 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-25 13:04:46.151496 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-25 13:04:46.169361 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.169487 (Thread-1): finished collecting timing info
2021-06-25 13:04:46.169596 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-25 13:04:46.170618 (MainThread): Connection 'master' was properly closed.
2021-06-25 13:04:46.170709 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-25 13:04:46.229137 (MainThread): 13:04:46 | Done.
2021-06-25 13:04:46.301691 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-06-25 13:04:46.301830 (MainThread): 13:04:46 | Building catalog
2021-06-25 13:04:46.302755 (MainThread): Opening a new connection, currently in state init
2021-06-25 13:04:46.493757 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "neat-episode-288515.information_schema".
2021-06-25 13:04:46.507507 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-25 13:04:46.511977 (ThreadPoolExecutor-1_0): On neat-episode-288515.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `neat-episode-288515`.`dbt_mskonberg`.__TABLES__
        where (upper(dataset_id) = upper('dbt_mskonberg'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-25 13:04:47.354121 (Thread-724): handling poll request
2021-06-25 13:04:47.354460 (Thread-724): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb8ca7100>]}
2021-06-25 13:04:47.355963 (Thread-724): sending response (<Response 32948 bytes [200 OK]>) to 10.0.26.142
2021-06-25 13:04:48.665947 (Thread-725): handling poll request
2021-06-25 13:04:48.666223 (Thread-725): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbab11aa60>]}
2021-06-25 13:04:48.691778 (Thread-725): sending response (<Response 295 bytes [200 OK]>) to 10.0.21.135
2021-06-25 13:04:49.368771 (MainThread): 13:04:49 | Catalog written to /usr/src/develop/user-26678/environment-32465/repository-26421/target/catalog.json
2021-06-25 13:04:49.930692 (Thread-726): handling poll request
2021-06-25 13:04:49.930971 (Thread-726): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaab9790>]}
2021-06-25 13:04:49.931850 (Thread-726): sending response (<Response 5498 bytes [200 OK]>) to 10.0.3.5
2021-06-25 13:04:50.824077 (Thread-727): handling status request
2021-06-25 13:04:50.824411 (Thread-727): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa5d4f0>]}
2021-06-25 13:04:50.825174 (Thread-727): sending response (<Response 1761 bytes [200 OK]>) to 10.0.21.135
2021-06-25 13:04:50.881156 (Thread-728): handling status request
2021-06-25 13:04:50.881534 (Thread-728): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa5de50>]}
2021-06-25 13:04:50.882118 (Thread-728): sending response (<Response 1761 bytes [200 OK]>) to 10.0.6.80
2021-06-25 13:04:50.976001 (Thread-729): handling status request
2021-06-25 13:04:50.976354 (Thread-729): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbb9eb91f0>]}
2021-06-25 13:04:50.976915 (Thread-729): sending response (<Response 1761 bytes [200 OK]>) to 10.0.3.5
2021-06-25 13:04:51.033212 (Thread-730): handling status request
2021-06-25 13:04:51.033514 (Thread-730): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6ff08b17-8c38-4630-96a3-d186a2b67ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbaaa5ddf0>]}
2021-06-25 13:04:51.034077 (Thread-730): sending response (<Response 1761 bytes [200 OK]>) to 10.0.40.2
2021-06-28 12:12:43.626865 (MainThread): Running with dbt=0.19.1
2021-06-28 12:12:43.778033 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-06-28 12:12:43.786150 (MainThread): Tracking: tracking
2021-06-28 12:12:43.801865 (Thread-1): Parsing macros/adapters.sql
2021-06-28 12:12:43.820000 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b1978c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a9827280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a98272e0>]}
2021-06-28 12:12:43.822652 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=16
2021-06-28 12:12:43.822957 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-06-28 12:12:43.823235 (Thread-1): Parsing macros/etc.sql
2021-06-28 12:12:43.823380 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-06-28 12:12:43.826058 (Thread-1): Parsing macros/catalog.sql
2021-06-28 12:12:43.832546 (Thread-1): Parsing macros/materializations/copy.sql
2021-06-28 12:12:43.838197 (Thread-1): Parsing macros/materializations/table.sql
2021-06-28 12:12:43.848110 (Thread-1): Parsing macros/materializations/incremental.sql
2021-06-28 12:12:43.860742 (Thread-1): Parsing macros/materializations/seed.sql
2021-06-28 12:12:43.863529 (Thread-1): Parsing macros/materializations/snapshot.sql
2021-06-28 12:12:43.865471 (Thread-1): Parsing macros/materializations/view.sql
2021-06-28 12:12:43.869078 (Thread-1): Parsing macros/core.sql
2021-06-28 12:12:43.873021 (Thread-1): Parsing macros/materializations/helpers.sql
2021-06-28 12:12:43.882101 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-06-28 12:12:43.896187 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-28 12:12:43.898023 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-06-28 12:12:43.915678 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-28 12:12:43.946721 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-28 12:12:43.951618 (Thread-1): Parsing macros/materializations/view/view.sql
2021-06-28 12:12:43.957685 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-06-28 12:12:43.977866 (Thread-1): Parsing macros/materializations/table/table.sql
2021-06-28 12:12:43.984334 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-06-28 12:12:43.986131 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-06-28 12:12:43.991995 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-06-28 12:12:43.993626 (Thread-1): Parsing macros/etc/query.sql
2021-06-28 12:12:43.994701 (Thread-1): Parsing macros/etc/datetime.sql
2021-06-28 12:12:44.003455 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-06-28 12:12:44.004407 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-06-28 12:12:44.006046 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-06-28 12:12:44.007992 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-06-28 12:12:44.009500 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-06-28 12:12:44.012142 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-06-28 12:12:44.014011 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-06-28 12:12:44.015754 (Thread-1): Parsing macros/adapters/common.sql
2021-06-28 12:12:44.214149 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-28 12:12:44.232849 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-28 12:12:44.243448 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-28 12:12:44.252817 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-28 12:12:44.264691 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-28 12:12:44.285186 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-28 12:12:44.434211 (Thread-1): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 12:12:44.441888 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 12:12:44.442335 (Thread-1): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a95d5190>]}
2021-06-28 12:13:11.309420 (Thread-2): handling status request
2021-06-28 12:13:11.309743 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a972db50>]}
2021-06-28 12:13:11.310906 (Thread-2): sending response (<Response 11987 bytes [200 OK]>) to 10.0.20.55
2021-06-28 12:13:11.328200 (Thread-3): handling ps request
2021-06-28 12:13:11.328426 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a97098b0>]}
2021-06-28 12:13:11.328831 (Thread-3): sending response (<Response 105 bytes [200 OK]>) to 10.0.41.19
2021-06-28 12:13:11.336148 (Thread-4): handling status request
2021-06-28 12:13:11.336843 (Thread-5): handling status request
2021-06-28 12:13:11.337010 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a95f3250>]}
2021-06-28 12:13:11.337823 (Thread-4): sending response (<Response 11987 bytes [200 OK]>) to 10.0.24.245
2021-06-28 12:13:11.337948 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a95f3ac0>]}
2021-06-28 12:13:11.338895 (Thread-5): sending response (<Response 11987 bytes [200 OK]>) to 10.0.24.245
2021-06-28 12:13:11.354987 (Thread-6): handling status request
2021-06-28 12:13:11.355175 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a95f3820>]}
2021-06-28 12:13:11.355781 (Thread-6): sending response (<Response 11987 bytes [200 OK]>) to 10.0.8.12
2021-06-28 12:22:04.464835 (MainThread): Connection 'test.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-06-28 12:22:04.506138 (Thread-7): Got an acceptable cached parse result
2021-06-28 12:22:04.666688 (Thread-7): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 12:22:04.673860 (Thread-7): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 12:22:04.674375 (Thread-7): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a984ac40>]}
2021-06-28 12:22:04.869146 (Thread-8): handling status request
2021-06-28 12:22:04.869419 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aaaaafa0>]}
2021-06-28 12:22:04.869948 (Thread-8): sending response (<Response 1753 bytes [200 OK]>) to 10.0.45.82
2021-06-28 12:22:04.882226 (Thread-9): handling status request
2021-06-28 12:22:04.882409 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8db7640>]}
2021-06-28 12:22:04.882821 (Thread-9): sending response (<Response 1753 bytes [200 OK]>) to 10.0.46.139
2021-06-28 12:22:04.885360 (Thread-10): handling status request
2021-06-28 12:22:04.885543 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8db7460>]}
2021-06-28 12:22:04.885916 (Thread-10): sending response (<Response 1753 bytes [200 OK]>) to 10.0.47.161
2021-06-28 12:25:24.678462 (Thread-11): Got an acceptable cached parse result
2021-06-28 12:25:24.946147 (Thread-11): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 12:25:24.953166 (Thread-11): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 12:25:24.953643 (Thread-11): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bc98b0>]}
2021-06-28 12:25:24.999073 (Thread-12): handling status request
2021-06-28 12:25:24.999291 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bc9370>]}
2021-06-28 12:25:24.999773 (Thread-12): sending response (<Response 1757 bytes [200 OK]>) to 10.0.1.83
2021-06-28 12:25:25.005549 (Thread-13): handling status request
2021-06-28 12:25:25.005764 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8a59c10>]}
2021-06-28 12:25:25.006144 (Thread-13): sending response (<Response 1757 bytes [200 OK]>) to 10.0.19.174
2021-06-28 12:25:25.037619 (Thread-14): handling status request
2021-06-28 12:25:25.038102 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8a59d30>]}
2021-06-28 12:25:25.038537 (Thread-14): sending response (<Response 1757 bytes [200 OK]>) to 10.0.1.83
2021-06-28 12:25:27.604659 (Thread-15): handling status request
2021-06-28 12:25:27.604942 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8b8f5e0>]}
2021-06-28 12:25:27.605448 (Thread-15): sending response (<Response 1757 bytes [200 OK]>) to 10.0.24.245
2021-06-28 12:25:27.873018 (Thread-16): handling run_sql request
2021-06-28 12:25:27.873279 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8b8f8e0>]}
2021-06-28 12:25:29.642100 (Thread-16): sending response (<Response 138 bytes [200 OK]>) to 10.0.23.185
2021-06-28 12:25:29.653302 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 12:25:29.664325 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/task_handler.py", line 94, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 162, in handle_request
    node = self._get_exec_node()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 123, in _get_exec_node
    add_new_refs(
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 46, in add_new_refs
    process_node(config, manifest, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 842, in process_node
    _process_sources_for_node(
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 803, in _process_sources_for_node
    invalid_source_fail_unless_test(
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/manifest.py", line 506, in invalid_source_fail_unless_test
    source_target_not_found(
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "/usr/local/lib/python3.8/dist-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in rpc request (from remote system)
  Rpc 'rpc.jaffle_shop.request' (from remote system) depends on a source named 'jaffle_shop.customers' which was not found
2021-06-28 12:25:30.378166 (Thread-17): handling poll request
2021-06-28 12:25:30.378517 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bc9370>]}
2021-06-28 12:25:30.379348 (Thread-17): sending response (<Response 2955 bytes [200 OK]>) to 10.0.47.161
2021-06-28 12:26:52.858810 (Thread-18): Got an acceptable cached parse result
2021-06-28 12:26:53.037591 (Thread-18): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 12:26:53.045230 (Thread-18): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 12:26:53.045806 (Thread-18): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8d10f70>]}
2021-06-28 12:26:53.159589 (Thread-19): handling status request
2021-06-28 12:26:53.159870 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aaaec100>]}
2021-06-28 12:26:53.160438 (Thread-19): sending response (<Response 1757 bytes [200 OK]>) to 10.0.46.139
2021-06-28 12:26:53.168876 (Thread-20): handling status request
2021-06-28 12:26:53.169062 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aaaf8910>]}
2021-06-28 12:26:53.169483 (Thread-20): sending response (<Response 1757 bytes [200 OK]>) to 10.0.24.245
2021-06-28 12:26:53.213524 (Thread-21): handling status request
2021-06-28 12:26:53.213719 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8cdb790>]}
2021-06-28 12:26:53.214122 (Thread-21): sending response (<Response 1757 bytes [200 OK]>) to 10.0.39.51
2021-06-28 12:27:06.636654 (Thread-22): handling status request
2021-06-28 12:27:06.636937 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8cdb790>]}
2021-06-28 12:27:06.637443 (Thread-22): sending response (<Response 1757 bytes [200 OK]>) to 10.0.20.55
2021-06-28 12:27:06.849335 (Thread-23): handling run_sql request
2021-06-28 12:27:06.849567 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8d10f70>]}
2021-06-28 12:27:08.643165 (Thread-23): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.19
2021-06-28 12:27:08.654256 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 12:27:08.666117 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '826eb1aa-b54a-4049-ae11-315fdf3f9061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057c8fdbb0>]}
2021-06-28 12:27:08.666375 (MainThread): Found 5 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-28 12:27:08.666793 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 12:27:08.666900 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-28 12:27:08.668922 (Thread-1): finished collecting timing info
2021-06-28 12:27:08.669052 (Thread-1): Opening a new connection, currently in state init
2021-06-28 12:27:08.673582 (Thread-1): On rpc.jaffle_shop.request: with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.`jaffle_shop`.`customers`

)

select * from customers
limit 500
/* limit added automatically by dbt cloud */
2021-06-28 12:27:08.915576 (Thread-24): handling poll request
2021-06-28 12:27:08.915893 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a964a430>]}
2021-06-28 12:27:08.916865 (Thread-24): sending response (<Response 3241 bytes [200 OK]>) to 10.0.8.12
2021-06-28 12:27:09.860663 (Thread-1): finished collecting timing info
2021-06-28 12:27:10.166202 (Thread-25): handling poll request
2021-06-28 12:27:10.166488 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aaaf8dc0>]}
2021-06-28 12:27:10.167530 (Thread-25): sending response (<Response 5846 bytes [200 OK]>) to 10.0.23.185
2021-06-28 12:27:25.731582 (Thread-26): handling status request
2021-06-28 12:27:25.731865 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aaaf8910>]}
2021-06-28 12:27:25.732412 (Thread-26): sending response (<Response 1757 bytes [200 OK]>) to 10.0.1.83
2021-06-28 12:27:26.002401 (Thread-27): handling run_sql request
2021-06-28 12:27:26.002679 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aaaf3190>]}
2021-06-28 12:27:27.845058 (Thread-27): sending response (<Response 138 bytes [200 OK]>) to 10.0.39.51
2021-06-28 12:27:27.855881 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 12:27:27.867219 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2f15f0d-7941-444a-91ef-7f766589b63f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1222f5fbb0>]}
2021-06-28 12:27:27.867445 (MainThread): Found 5 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-28 12:27:27.867832 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 12:27:27.867937 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-28 12:27:27.869937 (Thread-1): finished collecting timing info
2021-06-28 12:27:27.870060 (Thread-1): Opening a new connection, currently in state init
2021-06-28 12:27:27.874528 (Thread-1): On rpc.jaffle_shop.request: with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.`jaffle_shop`.`orders`

)

select * from orders
limit 500
/* limit added automatically by dbt cloud */
2021-06-28 12:27:28.059715 (Thread-28): handling poll request
2021-06-28 12:27:28.060038 (Thread-28): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a9637fd0>]}
2021-06-28 12:27:28.061028 (Thread-28): sending response (<Response 3256 bytes [200 OK]>) to 10.0.19.174
2021-06-28 12:27:29.030476 (Thread-1): finished collecting timing info
2021-06-28 12:27:29.304702 (Thread-29): handling poll request
2021-06-28 12:27:29.305042 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a96377f0>]}
2021-06-28 12:27:29.335226 (Thread-29): sending response (<Response 7524 bytes [200 OK]>) to 10.0.3.5
2021-06-28 12:33:37.702527 (Thread-30): Got an acceptable cached parse result
2021-06-28 12:33:37.877979 (Thread-30): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 12:33:37.885050 (Thread-30): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 12:33:37.885649 (Thread-30): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8cb3850>]}
2021-06-28 12:33:38.114212 (Thread-31): handling status request
2021-06-28 12:33:38.114909 (Thread-32): handling status request
2021-06-28 12:33:38.115182 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8d4bb20>]}
2021-06-28 12:33:38.115426 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8d48610>]}
2021-06-28 12:33:38.116014 (Thread-31): sending response (<Response 1757 bytes [200 OK]>) to 10.0.1.83
2021-06-28 12:33:38.116571 (Thread-32): sending response (<Response 1757 bytes [200 OK]>) to 10.0.3.5
2021-06-28 12:33:38.149763 (Thread-33): handling status request
2021-06-28 12:33:38.149948 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bf6130>]}
2021-06-28 12:33:38.150406 (Thread-33): sending response (<Response 1757 bytes [200 OK]>) to 10.0.39.51
2021-06-28 12:33:44.972308 (Thread-34): Got an acceptable cached parse result
2021-06-28 12:33:45.001902 (Thread-34): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-28 12:33:45.262306 (Thread-35): handling status request
2021-06-28 12:33:45.262923 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8a21280>]}
2021-06-28 12:33:45.263367 (Thread-36): handling status request
2021-06-28 12:33:45.263922 (Thread-35): sending response (<Response 185 bytes [200 OK]>) to 10.0.24.245
2021-06-28 12:33:45.264211 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8a31940>]}
2021-06-28 12:33:45.265165 (Thread-36): sending response (<Response 185 bytes [200 OK]>) to 10.0.22.247
2021-06-28 12:33:45.265604 (Thread-37): handling status request
2021-06-28 12:33:45.266304 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8a21430>]}
2021-06-28 12:33:45.266691 (Thread-37): sending response (<Response 185 bytes [200 OK]>) to 10.0.20.55
2021-06-28 12:33:45.295921 (Thread-34): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 12:33:45.302868 (Thread-34): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 12:33:45.303451 (Thread-34): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8d66970>]}
2021-06-28 12:33:46.468122 (Thread-38): handling status request
2021-06-28 12:33:46.468412 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8b91070>]}
2021-06-28 12:33:46.468959 (Thread-38): sending response (<Response 2058 bytes [200 OK]>) to 10.0.23.185
2021-06-28 12:33:46.482900 (Thread-39): handling status request
2021-06-28 12:33:46.483113 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8b91af0>]}
2021-06-28 12:33:46.483562 (Thread-39): sending response (<Response 2058 bytes [200 OK]>) to 10.0.46.139
2021-06-28 12:33:46.484437 (Thread-40): handling status request
2021-06-28 12:33:46.484683 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aaa5fbb0>]}
2021-06-28 12:33:46.485089 (Thread-40): sending response (<Response 2058 bytes [200 OK]>) to 10.0.14.70
2021-06-28 12:33:46.886667 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2021-06-28 12:33:46.926919 (Thread-41): Got an acceptable cached parse result
2021-06-28 12:33:46.953878 (Thread-41): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-28 12:33:47.087379 (Thread-41): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 12:33:47.094341 (Thread-41): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 12:33:47.094919 (Thread-41): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a9711640>]}
2021-06-28 12:33:47.246083 (Thread-42): handling status request
2021-06-28 12:33:47.246389 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ae80a0>]}
2021-06-28 12:33:47.246916 (Thread-42): sending response (<Response 2055 bytes [200 OK]>) to 10.0.3.5
2021-06-28 12:33:47.257748 (Thread-43): handling status request
2021-06-28 12:33:47.257948 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ad1970>]}
2021-06-28 12:33:47.258438 (Thread-43): sending response (<Response 2055 bytes [200 OK]>) to 10.0.46.139
2021-06-28 12:33:47.261232 (Thread-44): handling status request
2021-06-28 12:33:47.261499 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8d66c70>]}
2021-06-28 12:33:47.261984 (Thread-44): sending response (<Response 2055 bytes [200 OK]>) to 10.0.5.10
2021-06-28 12:34:01.417523 (Thread-45): handling status request
2021-06-28 12:34:01.417812 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ba0370>]}
2021-06-28 12:34:01.418357 (Thread-45): sending response (<Response 2055 bytes [200 OK]>) to 10.0.32.249
2021-06-28 12:34:01.458700 (Thread-46): handling status request
2021-06-28 12:34:01.458895 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ba03a0>]}
2021-06-28 12:34:01.459311 (Thread-46): sending response (<Response 2055 bytes [200 OK]>) to 10.0.1.83
2021-06-28 12:34:01.621712 (Thread-47): handling docs.generate request
2021-06-28 12:34:01.621982 (Thread-47): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ba0190>]}
2021-06-28 12:34:01.624468 (Thread-47): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2021-06-28 12:34:03.384012 (Thread-47): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.195
2021-06-28 12:34:03.420548 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cb89f6e-5ef4-4804-97a9-186c18ea68f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77450eb760>]}
2021-06-28 12:34:03.421047 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-28 12:34:03.422197 (MainThread): 
2021-06-28 12:34:03.422320 (MainThread): Acquiring new bigquery connection "master".
2021-06-28 12:34:03.423376 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-28 12:34:03.423487 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-28 12:34:03.570665 (Thread-48): handling poll request
2021-06-28 12:34:03.571036 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a9711820>]}
2021-06-28 12:34:03.572024 (Thread-48): sending response (<Response 2231 bytes [200 OK]>) to 10.0.18.158
2021-06-28 12:34:03.652105 (MainThread): 12:34:03 | Concurrency: 1 threads (target='default')
2021-06-28 12:34:03.652234 (MainThread): 12:34:03 | 
2021-06-28 12:34:03.654553 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-28 12:34:03.654723 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-28 12:34:03.654805 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-28 12:34:03.659544 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-28 12:34:03.676927 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.677062 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.677171 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-28 12:34:03.677261 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-28 12:34:03.677341 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-28 12:34:03.677400 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-28 12:34:03.678583 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-28 12:34:03.696863 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.696973 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.697071 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-28 12:34:03.697150 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-28 12:34:03.697225 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-28 12:34:03.697281 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-28 12:34:03.699342 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-28 12:34:03.717646 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.717757 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.717855 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-28 12:34:03.717935 (Thread-1): Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id
2021-06-28 12:34:03.718012 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id".
2021-06-28 12:34:03.718066 (Thread-1): Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id
2021-06-28 12:34:03.724870 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id"
2021-06-28 12:34:03.751308 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.751421 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.751520 (Thread-1): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id
2021-06-28 12:34:03.751602 (Thread-1): Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id
2021-06-28 12:34:03.751678 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id".
2021-06-28 12:34:03.751732 (Thread-1): Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id
2021-06-28 12:34:03.754508 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id"
2021-06-28 12:34:03.766787 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.766896 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.766991 (Thread-1): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id
2021-06-28 12:34:03.767070 (Thread-1): Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id
2021-06-28 12:34:03.767144 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id".
2021-06-28 12:34:03.767197 (Thread-1): Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id
2021-06-28 12:34:03.773305 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id"
2021-06-28 12:34:03.785284 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.785395 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.785493 (Thread-1): Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id
2021-06-28 12:34:03.785573 (Thread-1): Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id
2021-06-28 12:34:03.785647 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id".
2021-06-28 12:34:03.785701 (Thread-1): Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id
2021-06-28 12:34:03.788411 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id"
2021-06-28 12:34:03.800381 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.800489 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.800585 (Thread-1): Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id
2021-06-28 12:34:03.800664 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-28 12:34:03.800738 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-28 12:34:03.800792 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-28 12:34:03.810423 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-28 12:34:03.828357 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.828471 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.828567 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-28 12:34:03.828648 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-28 12:34:03.828725 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-28 12:34:03.828779 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-28 12:34:03.830970 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-28 12:34:03.848553 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.848669 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.848767 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-28 12:34:03.848848 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-28 12:34:03.848926 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-28 12:34:03.848981 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-28 12:34:03.858713 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-28 12:34:03.876394 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.876507 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.876604 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-28 12:34:03.876686 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-28 12:34:03.876763 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-28 12:34:03.876817 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-28 12:34:03.879951 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-28 12:34:03.897495 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.897606 (Thread-1): finished collecting timing info
2021-06-28 12:34:03.897701 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-28 12:34:03.898761 (MainThread): Connection 'master' was properly closed.
2021-06-28 12:34:03.898852 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-28 12:34:03.992183 (MainThread): 12:34:03 | Done.
2021-06-28 12:34:04.082711 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-06-28 12:34:04.082820 (MainThread): 12:34:04 | Building catalog
2021-06-28 12:34:04.083857 (MainThread): Opening a new connection, currently in state init
2021-06-28 12:34:04.403965 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "neat-episode-288515.information_schema".
2021-06-28 12:34:04.417861 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-28 12:34:04.422178 (ThreadPoolExecutor-1_0): On neat-episode-288515.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `neat-episode-288515`.`dbt_mskonberg`.__TABLES__
        where (upper(dataset_id) = upper('dbt_mskonberg'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-28 12:34:04.841492 (Thread-49): handling poll request
2021-06-28 12:34:04.841786 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bbcc70>]}
2021-06-28 12:34:04.843388 (Thread-49): sending response (<Response 46446 bytes [200 OK]>) to 10.0.1.83
2021-06-28 12:34:06.107694 (Thread-50): handling poll request
2021-06-28 12:34:06.107975 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bbcd30>]}
2021-06-28 12:34:06.108492 (Thread-50): sending response (<Response 295 bytes [200 OK]>) to 10.0.5.10
2021-06-28 12:34:06.704990 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "dbt-tutorial.information_schema".
2021-06-28 12:34:06.706417 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-28 12:34:06.711025 (ThreadPoolExecutor-1_0): On dbt-tutorial.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-tutorial`.`jaffle_shop`.__TABLES__
        where (upper(dataset_id) = upper('jaffle_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-tutorial`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-tutorial`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-28 12:34:07.434758 (Thread-51): handling poll request
2021-06-28 12:34:07.435034 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a9692160>]}
2021-06-28 12:34:07.435601 (Thread-51): sending response (<Response 8195 bytes [200 OK]>) to 10.0.19.174
2021-06-28 12:34:08.661297 (Thread-52): handling poll request
2021-06-28 12:34:08.661589 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a9692310>]}
2021-06-28 12:34:08.662132 (Thread-52): sending response (<Response 295 bytes [200 OK]>) to 10.0.46.139
2021-06-28 12:34:09.924943 (Thread-53): handling poll request
2021-06-28 12:34:09.925217 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a96924c0>]}
2021-06-28 12:34:09.925718 (Thread-53): sending response (<Response 295 bytes [200 OK]>) to 10.0.45.82
2021-06-28 12:34:10.259281 (MainThread): 12:34:10 | Catalog written to /usr/src/develop/user-26678/environment-32465/repository-26421/target/catalog.json
2021-06-28 12:34:11.190233 (Thread-54): handling poll request
2021-06-28 12:34:11.190544 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a96b14c0>]}
2021-06-28 12:34:11.191455 (Thread-54): sending response (<Response 6975 bytes [200 OK]>) to 10.0.32.249
2021-06-28 12:34:11.508523 (Thread-55): handling status request
2021-06-28 12:34:11.508803 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a96b1d90>]}
2021-06-28 12:34:11.509339 (Thread-55): sending response (<Response 2055 bytes [200 OK]>) to 10.0.19.174
2021-06-28 12:34:11.594723 (Thread-56): handling status request
2021-06-28 12:34:11.594990 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a96aa490>]}
2021-06-28 12:34:11.595497 (Thread-56): sending response (<Response 2055 bytes [200 OK]>) to 10.0.24.245
2021-06-28 12:34:11.633424 (Thread-57): handling status request
2021-06-28 12:34:11.633654 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a97b73d0>]}
2021-06-28 12:34:11.634134 (Thread-57): sending response (<Response 2055 bytes [200 OK]>) to 10.0.47.161
2021-06-28 12:34:11.659797 (Thread-58): handling status request
2021-06-28 12:34:11.660002 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a97b74c0>]}
2021-06-28 12:34:11.660452 (Thread-58): sending response (<Response 2055 bytes [200 OK]>) to 10.0.41.19
2021-06-28 13:09:37.071149 (Thread-59): Got an acceptable cached parse result
2021-06-28 13:09:37.560201 (Thread-60): handling status request
2021-06-28 13:09:37.560499 (Thread-60): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8d666a0>]}
2021-06-28 13:09:37.586653 (Thread-60): sending response (<Response 1385 bytes [200 OK]>) to 10.0.20.55
2021-06-28 13:09:37.682804 (Thread-61): handling status request
2021-06-28 13:09:37.683060 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ade340>]}
2021-06-28 13:09:37.683515 (Thread-61): sending response (<Response 1385 bytes [200 OK]>) to 10.0.14.70
2021-06-28 13:09:37.733637 (Thread-62): handling status request
2021-06-28 13:09:37.733977 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ade1f0>]}
2021-06-28 13:09:37.734569 (Thread-62): sending response (<Response 1385 bytes [200 OK]>) to 10.0.14.70
2021-06-28 13:09:59.501468 (Thread-63): handling status request
2021-06-28 13:09:59.501754 (Thread-63): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ade670>]}
2021-06-28 13:09:59.502293 (Thread-63): sending response (<Response 1385 bytes [200 OK]>) to 10.0.22.247
2021-06-28 13:09:59.534722 (Thread-64): handling status request
2021-06-28 13:09:59.534931 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ade4f0>]}
2021-06-28 13:09:59.535388 (Thread-64): sending response (<Response 1385 bytes [200 OK]>) to 10.0.8.12
2021-06-28 13:09:59.887398 (Thread-65): handling cli_args request
2021-06-28 13:09:59.887674 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8adeca0>]}
2021-06-28 13:09:59.888062 (Thread-65): sending response (<Response 2197 bytes [200 OK]>) to 10.0.1.83
2021-06-28 13:10:03.297657 (Thread-66): handling status request
2021-06-28 13:10:03.297940 (Thread-66): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ade760>]}
2021-06-28 13:10:03.298465 (Thread-66): sending response (<Response 1385 bytes [200 OK]>) to 10.0.23.185
2021-06-28 13:10:03.320151 (Thread-67): handling status request
2021-06-28 13:10:03.320360 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8abb040>]}
2021-06-28 13:10:03.320782 (Thread-67): sending response (<Response 1385 bytes [200 OK]>) to 10.0.47.161
2021-06-28 13:10:03.337440 (Thread-68): handling status request
2021-06-28 13:10:03.337676 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ae89a0>]}
2021-06-28 13:10:03.338267 (Thread-68): sending response (<Response 1385 bytes [200 OK]>) to 10.0.3.5
2021-06-28 13:10:43.191206 (Thread-69): handling status request
2021-06-28 13:10:43.191490 (Thread-69): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8abb400>]}
2021-06-28 13:10:43.191962 (Thread-69): sending response (<Response 1385 bytes [200 OK]>) to 10.0.3.5
2021-06-28 13:10:43.311893 (Thread-70): handling status request
2021-06-28 13:10:43.312213 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8abb460>]}
2021-06-28 13:10:43.312678 (Thread-70): sending response (<Response 1385 bytes [200 OK]>) to 10.0.32.249
2021-06-28 13:10:43.441536 (Thread-71): handling cli_args request
2021-06-28 13:10:43.441828 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8abb610>]}
2021-06-28 13:10:43.442201 (Thread-71): sending response (<Response 2197 bytes [200 OK]>) to 10.0.45.82
2021-06-28 13:10:51.774196 (Thread-72): handling status request
2021-06-28 13:10:51.774523 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8aded30>]}
2021-06-28 13:10:51.775024 (Thread-72): sending response (<Response 1385 bytes [200 OK]>) to 10.0.1.83
2021-06-28 13:10:51.855750 (Thread-73): handling status request
2021-06-28 13:10:51.856034 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8abbd30>]}
2021-06-28 13:10:51.856523 (Thread-73): sending response (<Response 1385 bytes [200 OK]>) to 10.0.24.245
2021-06-28 13:10:51.873165 (Thread-74): handling status request
2021-06-28 13:10:51.873348 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8abbcd0>]}
2021-06-28 13:10:51.873765 (Thread-74): sending response (<Response 1385 bytes [200 OK]>) to 10.0.22.247
2021-06-28 13:10:54.533246 (Thread-75): handling status request
2021-06-28 13:10:54.533526 (Thread-75): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ab2040>]}
2021-06-28 13:10:54.534020 (Thread-75): sending response (<Response 1385 bytes [200 OK]>) to 10.0.14.70
2021-06-28 13:10:54.661927 (Thread-76): handling status request
2021-06-28 13:10:54.662199 (Thread-76): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ab20a0>]}
2021-06-28 13:10:54.662680 (Thread-76): sending response (<Response 1385 bytes [200 OK]>) to 10.0.22.247
2021-06-28 13:10:54.773815 (Thread-77): handling cli_args request
2021-06-28 13:10:54.774064 (Thread-77): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ab22b0>]}
2021-06-28 13:10:54.774434 (Thread-77): sending response (<Response 2197 bytes [200 OK]>) to 10.0.5.10
2021-06-28 13:11:19.388998 (Thread-78): handling status request
2021-06-28 13:11:19.389321 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8aded30>]}
2021-06-28 13:11:19.390491 (Thread-78): sending response (<Response 1385 bytes [200 OK]>) to 10.0.19.174
2021-06-28 13:11:19.428938 (Thread-79): handling status request
2021-06-28 13:11:19.429217 (Thread-79): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8abb2b0>]}
2021-06-28 13:11:19.429690 (Thread-79): sending response (<Response 1385 bytes [200 OK]>) to 10.0.46.139
2021-06-28 13:11:19.439445 (Thread-80): handling status request
2021-06-28 13:11:19.439670 (Thread-80): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8abb4f0>]}
2021-06-28 13:11:19.440056 (Thread-80): sending response (<Response 1385 bytes [200 OK]>) to 10.0.20.55
2021-06-28 13:12:30.686820 (Thread-81): handling status request
2021-06-28 13:12:30.688736 (Thread-81): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8abba60>]}
2021-06-28 13:12:30.689229 (Thread-81): sending response (<Response 1385 bytes [200 OK]>) to 10.0.24.245
2021-06-28 13:12:30.690114 (Thread-82): handling status request
2021-06-28 13:12:30.690470 (Thread-82): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a98318e0>]}
2021-06-28 13:12:30.690914 (Thread-82): sending response (<Response 1385 bytes [200 OK]>) to 10.0.23.185
2021-06-28 13:12:31.009684 (Thread-83): handling cli_args request
2021-06-28 13:12:31.010011 (Thread-83): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8d66f10>]}
2021-06-28 13:12:31.010395 (Thread-83): sending response (<Response 2197 bytes [200 OK]>) to 10.0.24.195
2021-06-28 13:12:33.698400 (Thread-84): handling status request
2021-06-28 13:12:33.698679 (Thread-84): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8c3be80>]}
2021-06-28 13:12:33.699182 (Thread-84): sending response (<Response 1385 bytes [200 OK]>) to 10.0.18.158
2021-06-28 13:12:33.738527 (Thread-85): handling status request
2021-06-28 13:12:33.738737 (Thread-85): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8923550>]}
2021-06-28 13:12:33.739166 (Thread-85): sending response (<Response 1385 bytes [200 OK]>) to 10.0.46.139
2021-06-28 13:12:33.757111 (Thread-86): handling status request
2021-06-28 13:12:33.757299 (Thread-86): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bca790>]}
2021-06-28 13:12:33.757669 (Thread-86): sending response (<Response 1385 bytes [200 OK]>) to 10.0.24.195
2021-06-28 13:13:37.396963 (Thread-87): handling status request
2021-06-28 13:13:37.397248 (Thread-87): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bca760>]}
2021-06-28 13:13:37.397724 (Thread-87): sending response (<Response 1385 bytes [200 OK]>) to 10.0.14.70
2021-06-28 13:13:37.736126 (Thread-88): handling run_sql request
2021-06-28 13:13:37.736404 (Thread-88): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8a26340>]}
2021-06-28 13:13:37.736757 (Thread-88): sending response (<Response 2197 bytes [200 OK]>) to 10.0.39.51
2021-06-28 13:14:37.018266 (Thread-89): Got an acceptable cached parse result
2021-06-28 13:14:37.321009 (Thread-89): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 13:14:37.327932 (Thread-89): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 13:14:37.328480 (Thread-89): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bcbac0>]}
2021-06-28 13:14:37.450704 (Thread-90): handling status request
2021-06-28 13:14:37.450967 (Thread-90): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ab2e80>]}
2021-06-28 13:14:37.462376 (Thread-91): handling status request
2021-06-28 13:14:37.462692 (Thread-91): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a96cd940>]}
2021-06-28 13:14:37.477311 (Thread-90): sending response (<Response 1757 bytes [200 OK]>) to 10.0.45.82
2021-06-28 13:14:37.477760 (Thread-91): sending response (<Response 1757 bytes [200 OK]>) to 10.0.41.19
2021-06-28 13:14:37.525410 (Thread-92): handling status request
2021-06-28 13:14:37.525647 (Thread-92): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ab2d00>]}
2021-06-28 13:14:37.526094 (Thread-92): sending response (<Response 1757 bytes [200 OK]>) to 10.0.5.10
2021-06-28 13:14:39.807292 (Thread-93): handling status request
2021-06-28 13:14:39.807571 (Thread-93): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8aa9310>]}
2021-06-28 13:14:39.808069 (Thread-93): sending response (<Response 1757 bytes [200 OK]>) to 10.0.24.245
2021-06-28 13:14:40.065258 (Thread-94): handling run_sql request
2021-06-28 13:14:40.065533 (Thread-94): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8ac9640>]}
2021-06-28 13:14:41.802093 (Thread-94): sending response (<Response 138 bytes [200 OK]>) to 10.0.24.245
2021-06-28 13:14:41.812907 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 13:14:41.823838 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b78c988a-a4f8-43b4-abea-2558e0c7c795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0896f09e20>]}
2021-06-28 13:14:41.824072 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-28 13:14:41.824430 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 13:14:41.824529 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-28 13:14:41.826509 (Thread-1): finished collecting timing info
2021-06-28 13:14:41.826627 (Thread-1): Opening a new connection, currently in state init
2021-06-28 13:14:41.831074 (Thread-1): On rpc.jaffle_shop.request: with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.`jaffle_shop`.`orders`

)

select * from orders
limit 500
/* limit added automatically by dbt cloud */
2021-06-28 13:14:42.053064 (Thread-95): handling poll request
2021-06-28 13:14:42.053392 (Thread-95): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bcb040>]}
2021-06-28 13:14:42.054419 (Thread-95): sending response (<Response 3256 bytes [200 OK]>) to 10.0.39.51
2021-06-28 13:14:43.046635 (Thread-1): finished collecting timing info
2021-06-28 13:14:43.305447 (Thread-96): handling poll request
2021-06-28 13:14:43.305764 (Thread-96): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a96cd640>]}
2021-06-28 13:14:43.307352 (Thread-96): sending response (<Response 7524 bytes [200 OK]>) to 10.0.24.195
2021-06-28 13:16:01.776378 (Thread-97): handling status request
2021-06-28 13:16:01.778273 (Thread-97): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bcba90>]}
2021-06-28 13:16:01.778836 (Thread-97): sending response (<Response 1757 bytes [200 OK]>) to 10.0.18.158
2021-06-28 13:16:02.143534 (Thread-98): handling run_sql request
2021-06-28 13:16:02.143811 (Thread-98): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bcbf40>]}
2021-06-28 13:16:03.917348 (Thread-98): sending response (<Response 138 bytes [200 OK]>) to 10.0.23.185
2021-06-28 13:16:03.928820 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 13:16:03.942902 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c2f6972-09b1-4dc3-aef6-3e3d11103ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d34b02f40>]}
2021-06-28 13:16:03.943158 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-28 13:16:03.943547 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 13:16:03.943650 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-28 13:16:03.945613 (Thread-1): finished collecting timing info
2021-06-28 13:16:03.945733 (Thread-1): Opening a new connection, currently in state init
2021-06-28 13:16:03.950186 (Thread-1): On rpc.jaffle_shop.request: select * from `dbt-tutorial`.`jaffle_shop`.`orders`
limit 500
/* limit added automatically by dbt cloud */
2021-06-28 13:16:04.101588 (Thread-99): handling poll request
2021-06-28 13:16:04.101899 (Thread-99): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bb6fa0>]}
2021-06-28 13:16:04.102911 (Thread-99): sending response (<Response 3101 bytes [200 OK]>) to 10.0.19.174
2021-06-28 13:16:05.213639 (Thread-1): finished collecting timing info
2021-06-28 13:16:05.383153 (Thread-100): handling poll request
2021-06-28 13:16:05.383437 (Thread-100): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8bb66d0>]}
2021-06-28 13:16:05.384997 (Thread-100): sending response (<Response 9840 bytes [200 OK]>) to 10.0.24.245
2021-06-28 13:20:14.156961 (Thread-101): Got an acceptable cached parse result
2021-06-28 13:20:14.535835 (Thread-102): handling status request
2021-06-28 13:20:14.536140 (Thread-102): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f179b7e8730>]}
2021-06-28 13:20:14.536669 (Thread-102): sending response (<Response 1217 bytes [200 OK]>) to 10.0.24.195
2021-06-28 13:20:14.542909 (Thread-103): handling status request
2021-06-28 13:20:14.543101 (Thread-103): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aab13e50>]}
2021-06-28 13:20:14.543513 (Thread-103): sending response (<Response 1217 bytes [200 OK]>) to 10.0.19.174
2021-06-28 13:20:14.605732 (Thread-104): handling status request
2021-06-28 13:20:14.606017 (Thread-104): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ad760735-3be4-4ac6-9bf2-b8051bd4fb51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a9666f10>]}
2021-06-28 13:20:14.606585 (Thread-104): sending response (<Response 1217 bytes [200 OK]>) to 10.0.19.174
2021-06-28 13:20:55.158638 (MainThread): Running with dbt=0.19.1
2021-06-28 13:20:55.311630 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-06-28 13:20:55.319452 (MainThread): Tracking: tracking
2021-06-28 13:20:55.335337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f8b29c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1c78fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1c787c0>]}
2021-06-28 13:20:55.335831 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=16
2021-06-28 13:20:55.336104 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-06-28 13:20:55.336348 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-06-28 13:20:55.337202 (Thread-1): Parsing macros/adapters.sql
2021-06-28 13:20:55.357256 (Thread-1): Parsing macros/etc.sql
2021-06-28 13:20:55.359305 (Thread-1): Parsing macros/catalog.sql
2021-06-28 13:20:55.365239 (Thread-1): Parsing macros/materializations/copy.sql
2021-06-28 13:20:55.370400 (Thread-1): Parsing macros/materializations/table.sql
2021-06-28 13:20:55.380134 (Thread-1): Parsing macros/materializations/incremental.sql
2021-06-28 13:20:55.392054 (Thread-1): Parsing macros/materializations/seed.sql
2021-06-28 13:20:55.394701 (Thread-1): Parsing macros/materializations/snapshot.sql
2021-06-28 13:20:55.396496 (Thread-1): Parsing macros/materializations/view.sql
2021-06-28 13:20:55.399993 (Thread-1): Parsing macros/core.sql
2021-06-28 13:20:55.404073 (Thread-1): Parsing macros/materializations/helpers.sql
2021-06-28 13:20:55.413219 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-06-28 13:20:55.427938 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-28 13:20:55.429771 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-06-28 13:20:55.447498 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-28 13:20:55.478497 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-28 13:20:55.483389 (Thread-1): Parsing macros/materializations/view/view.sql
2021-06-28 13:20:55.489660 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-06-28 13:20:55.510899 (Thread-1): Parsing macros/materializations/table/table.sql
2021-06-28 13:20:55.519977 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-06-28 13:20:55.521852 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-06-28 13:20:55.527768 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-06-28 13:20:55.529395 (Thread-1): Parsing macros/etc/query.sql
2021-06-28 13:20:55.530446 (Thread-1): Parsing macros/etc/datetime.sql
2021-06-28 13:20:55.539044 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-06-28 13:20:55.539990 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-06-28 13:20:55.541632 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-06-28 13:20:55.543564 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-06-28 13:20:55.545101 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-06-28 13:20:55.547779 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-06-28 13:20:55.549672 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-06-28 13:20:55.551412 (Thread-1): Parsing macros/adapters/common.sql
2021-06-28 13:20:55.744272 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-28 13:20:55.760791 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-28 13:20:55.769428 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-28 13:20:55.776037 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-28 13:20:55.784690 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-28 13:20:55.802107 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-28 13:20:57.370622 (Thread-2): handling status request
2021-06-28 13:20:57.370927 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1c678e0>]}
2021-06-28 13:20:57.371823 (Thread-2): sending response (<Response 11470 bytes [200 OK]>) to 10.0.22.247
2021-06-28 13:20:57.373211 (Thread-3): handling status request
2021-06-28 13:20:57.373741 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1c78910>]}
2021-06-28 13:20:57.374156 (Thread-4): handling status request
2021-06-28 13:20:57.374963 (Thread-3): sending response (<Response 11470 bytes [200 OK]>) to 10.0.24.195
2021-06-28 13:20:57.375220 (Thread-4): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f0887130>]}
2021-06-28 13:20:57.376016 (Thread-4): sending response (<Response 11470 bytes [200 OK]>) to 10.0.23.185
2021-06-28 13:20:57.379218 (Thread-5): handling status request
2021-06-28 13:20:57.379394 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f09f0820>]}
2021-06-28 13:20:57.379980 (Thread-5): sending response (<Response 11470 bytes [200 OK]>) to 10.0.39.51
2021-06-28 13:20:57.396338 (Thread-6): handling ps request
2021-06-28 13:20:57.396572 (Thread-6): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f08e6970>]}
2021-06-28 13:20:57.396977 (Thread-6): sending response (<Response 105 bytes [200 OK]>) to 10.0.20.55
2021-06-28 13:21:33.009037 (MainThread): Connection 'test.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-06-28 13:21:33.030724 (Thread-7): Parsing macros/adapters.sql
2021-06-28 13:21:33.049821 (Thread-7): Parsing macros/etc.sql
2021-06-28 13:21:33.051892 (Thread-7): Parsing macros/catalog.sql
2021-06-28 13:21:33.057976 (Thread-7): Parsing macros/materializations/copy.sql
2021-06-28 13:21:33.063671 (Thread-7): Parsing macros/materializations/table.sql
2021-06-28 13:21:33.073408 (Thread-7): Parsing macros/materializations/incremental.sql
2021-06-28 13:21:33.085401 (Thread-7): Parsing macros/materializations/seed.sql
2021-06-28 13:21:33.088026 (Thread-7): Parsing macros/materializations/snapshot.sql
2021-06-28 13:21:33.089859 (Thread-7): Parsing macros/materializations/view.sql
2021-06-28 13:21:33.093405 (Thread-7): Parsing macros/core.sql
2021-06-28 13:21:33.097228 (Thread-7): Parsing macros/materializations/helpers.sql
2021-06-28 13:21:33.106076 (Thread-7): Parsing macros/materializations/common/merge.sql
2021-06-28 13:21:33.121892 (Thread-7): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-28 13:21:33.123650 (Thread-7): Parsing macros/materializations/snapshot/strategies.sql
2021-06-28 13:21:33.143094 (Thread-7): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-28 13:21:33.174197 (Thread-7): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-28 13:21:33.179101 (Thread-7): Parsing macros/materializations/view/view.sql
2021-06-28 13:21:33.185259 (Thread-7): Parsing macros/materializations/seed/seed.sql
2021-06-28 13:21:33.205729 (Thread-7): Parsing macros/materializations/table/table.sql
2021-06-28 13:21:33.212194 (Thread-7): Parsing macros/materializations/incremental/helpers.sql
2021-06-28 13:21:33.214043 (Thread-7): Parsing macros/materializations/incremental/incremental.sql
2021-06-28 13:21:33.219953 (Thread-7): Parsing macros/etc/is_incremental.sql
2021-06-28 13:21:33.221572 (Thread-7): Parsing macros/etc/query.sql
2021-06-28 13:21:33.222625 (Thread-7): Parsing macros/etc/datetime.sql
2021-06-28 13:21:33.231379 (Thread-7): Parsing macros/etc/get_custom_alias.sql
2021-06-28 13:21:33.232376 (Thread-7): Parsing macros/etc/get_custom_database.sql
2021-06-28 13:21:33.234078 (Thread-7): Parsing macros/etc/get_custom_schema.sql
2021-06-28 13:21:33.236098 (Thread-7): Parsing macros/schema_tests/not_null.sql
2021-06-28 13:21:33.237760 (Thread-7): Parsing macros/schema_tests/accepted_values.sql
2021-06-28 13:21:33.240468 (Thread-7): Parsing macros/schema_tests/relationships.sql
2021-06-28 13:21:33.249723 (Thread-7): Parsing macros/schema_tests/unique.sql
2021-06-28 13:21:33.260369 (Thread-7): Parsing macros/adapters/common.sql
2021-06-28 13:21:33.335925 (Thread-7): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-28 13:21:33.343139 (Thread-7): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-28 13:21:33.350271 (Thread-7): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-28 13:21:33.355453 (Thread-7): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-28 13:21:33.362779 (Thread-7): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-28 13:21:33.372892 (Thread-7): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-28 13:21:33.533946 (Thread-7): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 13:21:33.542478 (Thread-7): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 13:21:33.543045 (Thread-7): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3580670>]}
2021-06-28 13:21:33.592672 (Thread-8): handling status request
2021-06-28 13:21:33.592944 (Thread-8): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f08fd6a0>]}
2021-06-28 13:21:33.593746 (Thread-8): sending response (<Response 12008 bytes [200 OK]>) to 10.0.8.12
2021-06-28 13:21:33.663539 (Thread-9): handling status request
2021-06-28 13:21:33.664316 (Thread-10): handling status request
2021-06-28 13:21:33.664497 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35806d0>]}
2021-06-28 13:21:33.664729 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35f52e0>]}
2021-06-28 13:21:33.665571 (Thread-9): sending response (<Response 12008 bytes [200 OK]>) to 10.0.14.70
2021-06-28 13:21:33.666350 (Thread-10): sending response (<Response 12008 bytes [200 OK]>) to 10.0.3.5
2021-06-28 13:21:47.312556 (Thread-11): handling status request
2021-06-28 13:21:47.314708 (Thread-11): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e36eb8e0>]}
2021-06-28 13:21:47.315555 (Thread-11): sending response (<Response 12008 bytes [200 OK]>) to 10.0.8.12
2021-06-28 13:21:47.393847 (Thread-12): handling status request
2021-06-28 13:21:47.394126 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e36ebac0>]}
2021-06-28 13:21:47.394900 (Thread-12): sending response (<Response 12008 bytes [200 OK]>) to 10.0.46.139
2021-06-28 13:21:47.612766 (Thread-13): handling cli_args request
2021-06-28 13:21:47.613065 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e36ebb20>]}
2021-06-28 13:21:47.623408 (Thread-13): Connection 'test.jaffle_shop.assert_total_payments_amount_is_positive' was properly closed.
2021-06-28 13:21:49.427795 (Thread-13): sending response (<Response 138 bytes [200 OK]>) to 10.0.32.249
2021-06-28 13:21:49.464391 (MainThread): Partial parsing not enabled
2021-06-28 13:21:49.466979 (MainThread): Parsing macros/adapters.sql
2021-06-28 13:21:49.486603 (MainThread): Parsing macros/etc.sql
2021-06-28 13:21:49.488819 (MainThread): Parsing macros/catalog.sql
2021-06-28 13:21:49.494811 (MainThread): Parsing macros/materializations/copy.sql
2021-06-28 13:21:49.499268 (MainThread): Parsing macros/materializations/table.sql
2021-06-28 13:21:49.509125 (MainThread): Parsing macros/materializations/incremental.sql
2021-06-28 13:21:49.521343 (MainThread): Parsing macros/materializations/seed.sql
2021-06-28 13:21:49.524048 (MainThread): Parsing macros/materializations/snapshot.sql
2021-06-28 13:21:49.525955 (MainThread): Parsing macros/materializations/view.sql
2021-06-28 13:21:49.529417 (MainThread): Parsing macros/core.sql
2021-06-28 13:21:49.533275 (MainThread): Parsing macros/materializations/helpers.sql
2021-06-28 13:21:49.542218 (MainThread): Parsing macros/materializations/common/merge.sql
2021-06-28 13:21:49.556115 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-06-28 13:21:49.557994 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-06-28 13:21:49.575548 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-06-28 13:21:49.607361 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-06-28 13:21:49.612326 (MainThread): Parsing macros/materializations/view/view.sql
2021-06-28 13:21:49.618591 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-06-28 13:21:49.639030 (MainThread): Parsing macros/materializations/table/table.sql
2021-06-28 13:21:49.645629 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-06-28 13:21:49.647462 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-06-28 13:21:49.653381 (MainThread): Parsing macros/etc/is_incremental.sql
2021-06-28 13:21:49.655001 (MainThread): Parsing macros/etc/query.sql
2021-06-28 13:21:49.656103 (MainThread): Parsing macros/etc/datetime.sql
2021-06-28 13:21:49.664813 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-06-28 13:21:49.665809 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-06-28 13:21:49.667470 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-06-28 13:21:49.669519 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-06-28 13:21:49.671061 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-06-28 13:21:49.673794 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-06-28 13:21:49.675709 (MainThread): Parsing macros/schema_tests/unique.sql
2021-06-28 13:21:49.677560 (MainThread): Parsing macros/adapters/common.sql
2021-06-28 13:21:49.732859 (Thread-14): handling poll request
2021-06-28 13:21:49.733162 (Thread-14): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35d75e0>]}
2021-06-28 13:21:49.734301 (Thread-14): sending response (<Response 9364 bytes [200 OK]>) to 10.0.3.5
2021-06-28 13:21:49.728285 (MainThread): Partial parsing not enabled
2021-06-28 13:21:49.763542 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-28 13:21:49.776136 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-28 13:21:49.781936 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-28 13:21:49.787261 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-28 13:21:49.793877 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-28 13:21:49.812916 (MainThread): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-28 13:21:49.998643 (MainThread): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 13:21:50.005219 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 13:21:50.005812 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4db8600-a73f-4085-81be-e0cc5ce8b673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8a00bbd00>]}
2021-06-28 13:21:50.041743 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4db8600-a73f-4085-81be-e0cc5ce8b673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8a0215f70>]}
2021-06-28 13:21:50.042000 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-28 13:21:50.042728 (MainThread): 
2021-06-28 13:21:50.042963 (MainThread): Acquiring new bigquery connection "master".
2021-06-28 13:21:50.044265 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-28 13:21:50.044367 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-28 13:21:50.234873 (MainThread): 13:21:50 | Concurrency: 1 threads (target='default')
2021-06-28 13:21:50.235005 (MainThread): 13:21:50 | 
2021-06-28 13:21:50.236969 (Thread-1): Began running node source.jaffle_shop.jaffle_shop.orders
2021-06-28 13:21:50.237147 (Thread-1): 13:21:50 | 1 of 1 START freshness of jaffle_shop.orders......................... [RUN]
2021-06-28 13:21:50.237370 (Thread-1): Acquiring new bigquery connection "source.jaffle_shop.jaffle_shop.orders".
2021-06-28 13:21:50.237456 (Thread-1): finished collecting timing info
2021-06-28 13:21:50.238031 (Thread-1): Acquiring new bigquery connection "source.jaffle_shop.jaffle_shop.orders".
2021-06-28 13:21:50.251109 (Thread-1): Opening a new connection, currently in state closed
2021-06-28 13:21:50.255431 (Thread-1): On source.jaffle_shop.jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "user", "target_name": "default", "node_id": "source.jaffle_shop.jaffle_shop.orders"} */
select
      max(_etl_loaded_at) as max_loaded_at,
      CURRENT_TIMESTAMP() as snapshotted_at
    from `dbt-tutorial`.`jaffle_shop`.`orders`
    
  
2021-06-28 13:21:51.061902 (Thread-15): handling poll request
2021-06-28 13:21:51.062186 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3620e50>]}
2021-06-28 13:21:51.062930 (Thread-15): sending response (<Response 9363 bytes [200 OK]>) to 10.0.18.158
2021-06-28 13:21:51.436114 (Thread-1): finished collecting timing info
2021-06-28 13:21:51.436449 (Thread-1): 13:21:51 | 1 of 1 WARN freshness of jaffle_shop.orders.......................... [WARN in 1.20s]
2021-06-28 13:21:51.436535 (Thread-1): Finished running node source.jaffle_shop.jaffle_shop.orders
2021-06-28 13:21:51.437746 (MainThread): Connection 'master' was properly closed.
2021-06-28 13:21:51.437885 (MainThread): Connection 'source.jaffle_shop.jaffle_shop.orders' was properly closed.
2021-06-28 13:21:51.507833 (MainThread): 13:21:51 | Done.
2021-06-28 13:21:52.388361 (Thread-16): handling poll request
2021-06-28 13:21:52.388663 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35e0790>]}
2021-06-28 13:21:52.389569 (Thread-16): sending response (<Response 4381 bytes [200 OK]>) to 10.0.3.5
2021-06-28 13:21:52.891623 (Thread-17): handling status request
2021-06-28 13:21:52.891911 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35e0fa0>]}
2021-06-28 13:21:52.893118 (Thread-17): sending response (<Response 12008 bytes [200 OK]>) to 10.0.45.82
2021-06-28 13:21:52.952245 (Thread-18): handling status request
2021-06-28 13:21:52.952535 (Thread-18): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35dc8e0>]}
2021-06-28 13:21:52.953405 (Thread-18): sending response (<Response 12008 bytes [200 OK]>) to 10.0.41.19
2021-06-28 13:21:52.959766 (Thread-19): handling status request
2021-06-28 13:21:52.959962 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35dc550>]}
2021-06-28 13:21:52.960684 (Thread-19): sending response (<Response 12008 bytes [200 OK]>) to 10.0.45.82
2021-06-28 13:24:28.077369 (Thread-20): Got an acceptable cached parse result
2021-06-28 13:24:28.258443 (Thread-20): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 13:24:28.268105 (Thread-20): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 13:24:28.269815 (Thread-20): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3540cd0>]}
2021-06-28 13:24:28.604489 (Thread-21): handling status request
2021-06-28 13:24:28.604832 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3540c40>]}
2021-06-28 13:24:28.605397 (Thread-21): sending response (<Response 1757 bytes [200 OK]>) to 10.0.23.185
2021-06-28 13:24:28.678415 (Thread-22): handling status request
2021-06-28 13:24:28.678687 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3540c10>]}
2021-06-28 13:24:28.679186 (Thread-22): sending response (<Response 1757 bytes [200 OK]>) to 10.0.18.158
2021-06-28 13:24:28.690980 (Thread-23): handling status request
2021-06-28 13:24:28.691203 (Thread-23): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3540580>]}
2021-06-28 13:24:28.691677 (Thread-23): sending response (<Response 1757 bytes [200 OK]>) to 10.0.32.249
2021-06-28 13:26:01.662111 (Thread-24): handling status request
2021-06-28 13:26:01.663922 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e343cf40>]}
2021-06-28 13:26:01.664440 (Thread-24): sending response (<Response 1757 bytes [200 OK]>) to 10.0.23.185
2021-06-28 13:26:02.017276 (Thread-25): handling run_sql request
2021-06-28 13:26:02.017570 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3540280>]}
2021-06-28 13:26:03.828329 (Thread-25): sending response (<Response 138 bytes [200 OK]>) to 10.0.41.19
2021-06-28 13:26:03.839966 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 13:26:03.853919 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfb81782-ea98-473e-ab7e-f4ada44d9161', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39a85f3eb0>]}
2021-06-28 13:26:03.854163 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-06-28 13:26:03.854573 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 13:26:03.854687 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-28 13:26:03.855781 (Thread-1): finished collecting timing info
2021-06-28 13:26:03.855907 (Thread-1): Opening a new connection, currently in state init
2021-06-28 13:26:03.860429 (Thread-1): On rpc.jaffle_shop.request: select * from `dbt-tutorial.stripe.payment`
limit 500
/* limit added automatically by dbt cloud */
2021-06-28 13:26:04.122699 (Thread-26): handling poll request
2021-06-28 13:26:04.123049 (Thread-26): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e359c5e0>]}
2021-06-28 13:26:04.124043 (Thread-26): sending response (<Response 3093 bytes [200 OK]>) to 10.0.24.195
2021-06-28 13:26:05.132519 (Thread-1): finished collecting timing info
2021-06-28 13:26:05.469342 (Thread-27): handling poll request
2021-06-28 13:26:05.469634 (Thread-27): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e359c160>]}
2021-06-28 13:26:05.471696 (Thread-27): sending response (<Response 13767 bytes [200 OK]>) to 10.0.8.12
2021-06-28 13:26:58.031330 (Thread-28): Got an acceptable cached parse result
2021-06-28 13:26:58.342195 (Thread-28): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 13:26:58.351572 (Thread-28): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 13:26:58.352251 (Thread-28): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e338f0d0>]}
2021-06-28 13:26:58.470753 (Thread-29): handling status request
2021-06-28 13:26:58.471038 (Thread-29): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1e60370>]}
2021-06-28 13:26:58.471599 (Thread-29): sending response (<Response 1757 bytes [200 OK]>) to 10.0.46.139
2021-06-28 13:26:58.520700 (Thread-30): handling status request
2021-06-28 13:26:58.520991 (Thread-30): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e33d8790>]}
2021-06-28 13:26:58.547341 (Thread-30): sending response (<Response 1757 bytes [200 OK]>) to 10.0.47.161
2021-06-28 13:26:58.624939 (Thread-31): handling status request
2021-06-28 13:26:58.625227 (Thread-31): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e343c490>]}
2021-06-28 13:26:58.625758 (Thread-31): sending response (<Response 1757 bytes [200 OK]>) to 10.0.14.70
2021-06-28 13:27:17.370244 (Thread-32): handling status request
2021-06-28 13:27:17.370543 (Thread-32): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3477880>]}
2021-06-28 13:27:17.371068 (Thread-32): sending response (<Response 1757 bytes [200 OK]>) to 10.0.1.83
2021-06-28 13:27:17.415936 (Thread-33): handling status request
2021-06-28 13:27:17.416209 (Thread-33): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3432460>]}
2021-06-28 13:27:17.416747 (Thread-33): sending response (<Response 1757 bytes [200 OK]>) to 10.0.14.70
2021-06-28 13:27:17.637142 (Thread-34): handling docs.generate request
2021-06-28 13:27:17.637426 (Thread-34): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3432c70>]}
2021-06-28 13:27:19.395558 (Thread-34): sending response (<Response 138 bytes [200 OK]>) to 10.0.46.139
2021-06-28 13:27:19.427607 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb2e77f1-d5e2-4616-9e36-64d0fa0faffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b5fc11a00>]}
2021-06-28 13:27:19.428170 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-06-28 13:27:19.429393 (MainThread): 
2021-06-28 13:27:19.429524 (MainThread): Acquiring new bigquery connection "master".
2021-06-28 13:27:19.430615 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-28 13:27:19.430739 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-28 13:27:19.669053 (MainThread): 13:27:19 | Concurrency: 1 threads (target='default')
2021-06-28 13:27:19.669192 (MainThread): 13:27:19 | 
2021-06-28 13:27:19.671493 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-28 13:27:19.671674 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-28 13:27:19.671751 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-28 13:27:19.676590 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-28 13:27:19.687230 (Thread-35): handling poll request
2021-06-28 13:27:19.687489 (Thread-35): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e346f640>]}
2021-06-28 13:27:19.688411 (Thread-35): sending response (<Response 4478 bytes [200 OK]>) to 10.0.19.174
2021-06-28 13:27:19.694240 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.694395 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.694516 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-28 13:27:19.694607 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-28 13:27:19.694695 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-28 13:27:19.694755 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-28 13:27:19.696000 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-28 13:27:19.715031 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.715170 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.715279 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-28 13:27:19.715370 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-28 13:27:19.715451 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-28 13:27:19.715507 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-28 13:27:19.717773 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-28 13:27:19.735221 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.735355 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.735465 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-28 13:27:19.735559 (Thread-1): Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id
2021-06-28 13:27:19.735646 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id".
2021-06-28 13:27:19.735702 (Thread-1): Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id
2021-06-28 13:27:19.742635 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id"
2021-06-28 13:27:19.759688 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.759813 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.759917 (Thread-1): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id
2021-06-28 13:27:19.759999 (Thread-1): Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id
2021-06-28 13:27:19.760079 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id".
2021-06-28 13:27:19.760135 (Thread-1): Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id
2021-06-28 13:27:19.763033 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id"
2021-06-28 13:27:19.783104 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.783233 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.783342 (Thread-1): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id
2021-06-28 13:27:19.783426 (Thread-1): Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id
2021-06-28 13:27:19.783507 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id".
2021-06-28 13:27:19.783564 (Thread-1): Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id
2021-06-28 13:27:19.790011 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id"
2021-06-28 13:27:19.806285 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.806436 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.806552 (Thread-1): Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id
2021-06-28 13:27:19.806641 (Thread-1): Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id
2021-06-28 13:27:19.806727 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id".
2021-06-28 13:27:19.806786 (Thread-1): Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id
2021-06-28 13:27:19.809942 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id"
2021-06-28 13:27:19.826194 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.826352 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.826471 (Thread-1): Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id
2021-06-28 13:27:19.826562 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-28 13:27:19.826647 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-28 13:27:19.826706 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-28 13:27:19.837402 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-28 13:27:19.855201 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.855388 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.855513 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-28 13:27:19.855607 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-28 13:27:19.855697 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-28 13:27:19.855760 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-28 13:27:19.858427 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-28 13:27:19.873894 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.874052 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.874172 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-28 13:27:19.874262 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-28 13:27:19.874348 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-28 13:27:19.874408 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-28 13:27:19.884646 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-28 13:27:19.900254 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.900408 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.900528 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-28 13:27:19.900646 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-28 13:27:19.900742 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-28 13:27:19.900805 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-28 13:27:19.904405 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-28 13:27:19.923250 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.923425 (Thread-1): finished collecting timing info
2021-06-28 13:27:19.923542 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-28 13:27:19.924555 (MainThread): Connection 'master' was properly closed.
2021-06-28 13:27:19.924680 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-28 13:27:20.008007 (MainThread): 13:27:20 | Done.
2021-06-28 13:27:20.092848 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-06-28 13:27:20.092984 (MainThread): 13:27:20 | Building catalog
2021-06-28 13:27:20.094129 (MainThread): Opening a new connection, currently in state init
2021-06-28 13:27:20.479771 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "neat-episode-288515.information_schema".
2021-06-28 13:27:20.493575 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-28 13:27:20.497892 (ThreadPoolExecutor-1_0): On neat-episode-288515.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `neat-episode-288515`.`dbt_mskonberg`.__TABLES__
        where (upper(dataset_id) = upper('dbt_mskonberg'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-28 13:27:20.987700 (Thread-36): handling poll request
2021-06-28 13:27:20.987994 (Thread-36): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e339a6d0>]}
2021-06-28 13:27:20.989589 (Thread-36): sending response (<Response 44199 bytes [200 OK]>) to 10.0.1.83
2021-06-28 13:27:22.335785 (Thread-37): handling poll request
2021-06-28 13:27:22.336077 (Thread-37): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e339a790>]}
2021-06-28 13:27:22.336641 (Thread-37): sending response (<Response 295 bytes [200 OK]>) to 10.0.3.5
2021-06-28 13:27:22.695456 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "dbt-tutorial.information_schema".
2021-06-28 13:27:22.697018 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-28 13:27:22.701937 (ThreadPoolExecutor-1_0): On dbt-tutorial.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-tutorial`.`jaffle_shop`.__TABLES__
        where (upper(dataset_id) = upper('jaffle_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-tutorial`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-tutorial`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-28 13:27:23.684954 (Thread-38): handling poll request
2021-06-28 13:27:23.685239 (Thread-38): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e339ab80>]}
2021-06-28 13:27:23.685828 (Thread-38): sending response (<Response 8193 bytes [200 OK]>) to 10.0.39.51
2021-06-28 13:27:24.957518 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "dbt-tutorial.information_schema".
2021-06-28 13:27:24.958965 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-28 13:27:24.963533 (ThreadPoolExecutor-1_0): On dbt-tutorial.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-tutorial`.`stripe`.__TABLES__
        where (upper(dataset_id) = upper('stripe'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-tutorial`.`stripe`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-tutorial`.`stripe`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-28 13:27:25.009558 (Thread-39): handling poll request
2021-06-28 13:27:25.009857 (Thread-39): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e339ae50>]}
2021-06-28 13:27:25.010488 (Thread-39): sending response (<Response 8175 bytes [200 OK]>) to 10.0.41.19
2021-06-28 13:27:26.309946 (Thread-40): handling poll request
2021-06-28 13:27:26.310272 (Thread-40): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e339a700>]}
2021-06-28 13:27:26.310805 (Thread-40): sending response (<Response 295 bytes [200 OK]>) to 10.0.14.70
2021-06-28 13:27:27.418177 (MainThread): 13:27:27 | Catalog written to /usr/src/develop/user-26678/environment-32465/repository-26421/target/catalog.json
2021-06-28 13:27:27.557230 (Thread-41): handling poll request
2021-06-28 13:27:27.557523 (Thread-41): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e339cb50>]}
2021-06-28 13:27:27.558080 (Thread-41): sending response (<Response 638 bytes [200 OK]>) to 10.0.1.83
2021-06-28 13:27:28.892877 (Thread-42): handling poll request
2021-06-28 13:27:28.893170 (Thread-42): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e339c550>]}
2021-06-28 13:27:28.894073 (Thread-42): sending response (<Response 6632 bytes [200 OK]>) to 10.0.24.245
2021-06-28 13:27:29.627094 (Thread-43): handling status request
2021-06-28 13:27:29.627441 (Thread-43): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e33a2cd0>]}
2021-06-28 13:27:29.628002 (Thread-43): sending response (<Response 1757 bytes [200 OK]>) to 10.0.32.249
2021-06-28 13:27:29.669353 (Thread-44): handling status request
2021-06-28 13:27:29.669875 (Thread-44): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e33d6190>]}
2021-06-28 13:27:29.670335 (Thread-45): handling status request
2021-06-28 13:27:29.670955 (Thread-44): sending response (<Response 1757 bytes [200 OK]>) to 10.0.47.161
2021-06-28 13:27:29.671277 (Thread-45): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e33d6970>]}
2021-06-28 13:27:29.671991 (Thread-45): sending response (<Response 1757 bytes [200 OK]>) to 10.0.3.5
2021-06-28 13:27:29.768511 (Thread-46): handling status request
2021-06-28 13:27:29.768847 (Thread-46): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e33d64f0>]}
2021-06-28 13:27:29.769393 (Thread-46): sending response (<Response 1757 bytes [200 OK]>) to 10.0.32.249
2021-06-28 13:29:44.665087 (Thread-47): Got an acceptable cached parse result
2021-06-28 13:29:44.845911 (Thread-47): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 13:29:44.853198 (Thread-47): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 13:29:44.853800 (Thread-47): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e36ffd30>]}
2021-06-28 13:29:45.194423 (Thread-48): handling status request
2021-06-28 13:29:45.195239 (Thread-49): handling status request
2021-06-28 13:29:45.195436 (Thread-48): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35275e0>]}
2021-06-28 13:29:45.196103 (Thread-48): sending response (<Response 1757 bytes [200 OK]>) to 10.0.19.174
2021-06-28 13:29:45.196252 (Thread-49): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1c20c40>]}
2021-06-28 13:29:45.196851 (Thread-49): sending response (<Response 1757 bytes [200 OK]>) to 10.0.45.82
2021-06-28 13:29:45.280128 (Thread-50): handling status request
2021-06-28 13:29:45.280426 (Thread-50): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1c207c0>]}
2021-06-28 13:29:45.280993 (Thread-50): sending response (<Response 1757 bytes [200 OK]>) to 10.0.1.83
2021-06-28 13:29:49.261557 (Thread-51): handling status request
2021-06-28 13:29:49.261859 (Thread-51): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e33da8e0>]}
2021-06-28 13:29:49.262390 (Thread-51): sending response (<Response 1757 bytes [200 OK]>) to 10.0.24.245
2021-06-28 13:29:49.478833 (Thread-52): handling run_sql request
2021-06-28 13:29:49.479122 (Thread-52): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e33d64f0>]}
2021-06-28 13:29:51.242674 (Thread-52): sending response (<Response 138 bytes [200 OK]>) to 10.0.18.158
2021-06-28 13:29:51.257822 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 13:29:51.270118 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d7208be-544c-43a4-91cc-de9496516e1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947b5bdf10>]}
2021-06-28 13:29:51.270381 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-06-28 13:29:51.270814 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 13:29:51.270930 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-28 13:29:51.273234 (Thread-1): finished collecting timing info
2021-06-28 13:29:51.273377 (Thread-1): Opening a new connection, currently in state init
2021-06-28 13:29:51.278018 (Thread-1): On rpc.jaffle_shop.request: with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial.stripe.payment`
    `dbt-tutorial`.`stripe`.`payment`

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-06-28 13:29:51.489430 (Thread-53): handling poll request
2021-06-28 13:29:51.489749 (Thread-53): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1ca45b0>]}
2021-06-28 13:29:51.490697 (Thread-53): sending response (<Response 3420 bytes [200 OK]>) to 10.0.20.55
2021-06-28 13:29:51.692399 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/cb332a7f-af56-4fcc-85a7-324ab5a13496?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got "." at [13:19]')
2021-06-28 13:29:52.043927 (Thread-1): finished collecting timing info
2021-06-28 13:29:52.044130 (Thread-1): Got an exception: Database Error
  Syntax error: Expected ")" but got "." at [13:19]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 149, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1022, in done
    self._query_results = self._client._get_query_results(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 1557, in _get_query_results
    resource = self._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 636, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 281, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 184, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/neat-episode-288515/queries/383eabfe-0f9f-4178-b117-5ce9eef9d1b6?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected ")" but got "." at [13:19]

(job ID: 383eabfe-0f9f-4178-b117-5ce9eef9d1b6)

          -----Query Job SQL Follows-----          

    |    .    |    .    |    .    |    .    |
   1:with payments as (
   2:
   3:    select
   4:        id as payment_id,
   5:        orderid as order_id,
   6:        paymentmethod as payment_method,
   7:        status,
   8:        --convert amount from cents to dollars
   9:        amount / 100 as amount,
  10:        created as created_at
  11:
  12:    from `dbt-tutorial.stripe.payment`
  13:    `dbt-tutorial`.`stripe`.`payment`
  14:
  15:)
  16:
  17:select * from payments
  18:limit 500
  19:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 534, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Expected ")" but got "." at [13:19]
2021-06-28 13:29:52.046614 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Syntax error: Expected ")" but got "." at [13:19]', 'raw_sql': "with payments as (\r\n\r\n    select\r\n        id as payment_id,\r\n        orderid as order_id,\r\n        paymentmethod as payment_method,\r\n        status,\r\n        --convert amount from cents to dollars\r\n        amount / 100 as amount,\r\n        created as created_at\r\n\r\n    from `dbt-tutorial.stripe.payment`\r\n    {{ source('stripe','payment')}}\r\n\r\n)\r\n\r\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with payments as (\n\n    select\n        id as payment_id,\n        orderid as order_id,\n        paymentmethod as payment_method,\n        status,\n        --convert amount from cents to dollars\n        amount / 100 as amount,\n        created as created_at\n\n    from `dbt-tutorial.stripe.payment`\n    `dbt-tutorial`.`stripe`.`payment`\n\n)\n\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/rpc/sql_commands.py", line 145, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 360, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt/rpc/node_runners.py", line 56, in error_result
    raise error
dbt.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system)\n  Syntax error: Expected ")" but got "." at [13:19]', 'raw_sql': "with payments as (\r\n\r\n    select\r\n        id as payment_id,\r\n        orderid as order_id,\r\n        paymentmethod as payment_method,\r\n        status,\r\n        --convert amount from cents to dollars\r\n        amount / 100 as amount,\r\n        created as created_at\r\n\r\n    from `dbt-tutorial.stripe.payment`\r\n    {{ source('stripe','payment')}}\r\n\r\n)\r\n\r\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': 'with payments as (\n\n    select\n        id as payment_id,\n        orderid as order_id,\n        paymentmethod as payment_method,\n        status,\n        --convert amount from cents to dollars\n        amount / 100 as amount,\n        created as created_at\n\n    from `dbt-tutorial.stripe.payment`\n    `dbt-tutorial`.`stripe`.`payment`\n\n)\n\nselect * from payments\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2021-06-28 13:29:52.853055 (Thread-54): handling poll request
2021-06-28 13:29:52.853369 (Thread-54): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35c0d60>]}
2021-06-28 13:29:52.854019 (Thread-54): sending response (<Response 14356 bytes [200 OK]>) to 10.0.23.185
2021-06-28 13:29:58.338888 (Thread-55): handling status request
2021-06-28 13:29:58.339222 (Thread-55): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e370e760>]}
2021-06-28 13:29:58.339868 (Thread-55): sending response (<Response 1757 bytes [200 OK]>) to 10.0.19.174
2021-06-28 13:29:58.585441 (Thread-56): handling run_sql request
2021-06-28 13:29:58.585744 (Thread-56): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e370e700>]}
2021-06-28 13:30:00.370726 (Thread-56): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.247
2021-06-28 13:30:00.382475 (MainThread): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 13:30:00.394027 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65f56709-f08f-436a-9146-700b9405d4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd263425fa0>]}
2021-06-28 13:30:00.394288 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-06-28 13:30:00.394678 (Thread-1): Acquiring new bigquery connection "rpc.jaffle_shop.request".
2021-06-28 13:30:00.394784 (Thread-1): Compiling rpc.jaffle_shop.request
2021-06-28 13:30:00.396903 (Thread-1): finished collecting timing info
2021-06-28 13:30:00.397035 (Thread-1): Opening a new connection, currently in state init
2021-06-28 13:30:00.401561 (Thread-1): On rpc.jaffle_shop.request: with payments as (

    select
        id as payment_id,
        orderid as order_id,
        paymentmethod as payment_method,
        status,
        --convert amount from cents to dollars
        amount / 100 as amount,
        created as created_at

    from `dbt-tutorial`.`stripe`.`payment`

)

select * from payments
limit 500
/* limit added automatically by dbt cloud */
2021-06-28 13:30:00.625181 (Thread-57): handling poll request
2021-06-28 13:30:00.625520 (Thread-57): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e36ff130>]}
2021-06-28 13:30:00.626489 (Thread-57): sending response (<Response 3386 bytes [200 OK]>) to 10.0.24.245
2021-06-28 13:30:01.657145 (Thread-1): finished collecting timing info
2021-06-28 13:30:01.864324 (Thread-58): handling poll request
2021-06-28 13:30:01.864637 (Thread-58): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e37a01f0>]}
2021-06-28 13:30:01.866208 (Thread-58): sending response (<Response 11218 bytes [200 OK]>) to 10.0.24.245
2021-06-28 13:30:08.389394 (Thread-59): handling status request
2021-06-28 13:30:08.389787 (Thread-59): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e37a0280>]}
2021-06-28 13:30:08.390527 (Thread-59): sending response (<Response 1757 bytes [200 OK]>) to 10.0.45.82
2021-06-28 13:30:08.495973 (Thread-60): handling status request
2021-06-28 13:30:08.496375 (Thread-60): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3797fd0>]}
2021-06-28 13:30:08.522710 (Thread-60): sending response (<Response 1757 bytes [200 OK]>) to 10.0.24.195
2021-06-28 13:30:08.645549 (Thread-61): handling docs.generate request
2021-06-28 13:30:08.645840 (Thread-61): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3797fa0>]}
2021-06-28 13:30:10.432870 (Thread-61): sending response (<Response 138 bytes [200 OK]>) to 10.0.20.55
2021-06-28 13:30:10.465198 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c6e5bf3-5b58-44ec-a4f5-e2aa3a19198a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25474eb9d0>]}
2021-06-28 13:30:10.465762 (MainThread): Found 5 models, 6 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-06-28 13:30:10.466971 (MainThread): 
2021-06-28 13:30:10.467103 (MainThread): Acquiring new bigquery connection "master".
2021-06-28 13:30:10.468176 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_neat-episode-288515_dbt_mskonberg".
2021-06-28 13:30:10.468285 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-06-28 13:30:10.661725 (Thread-62): handling poll request
2021-06-28 13:30:10.662051 (Thread-62): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e37af370>]}
2021-06-28 13:30:10.662973 (Thread-62): sending response (<Response 2231 bytes [200 OK]>) to 10.0.18.158
2021-06-28 13:30:10.677061 (MainThread): 13:30:10 | Concurrency: 1 threads (target='default')
2021-06-28 13:30:10.677185 (MainThread): 13:30:10 | 
2021-06-28 13:30:10.679317 (Thread-1): Began running node model.jaffle_shop.stg_orders
2021-06-28 13:30:10.679488 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2021-06-28 13:30:10.679566 (Thread-1): Compiling model.jaffle_shop.stg_orders
2021-06-28 13:30:10.684260 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2021-06-28 13:30:10.700934 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.701075 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.701186 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2021-06-28 13:30:10.701283 (Thread-1): Began running node model.jaffle_shop.stg_payments
2021-06-28 13:30:10.701380 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-28 13:30:10.701440 (Thread-1): Compiling model.jaffle_shop.stg_payments
2021-06-28 13:30:10.702616 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_payments"
2021-06-28 13:30:10.720994 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.721121 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.721227 (Thread-1): Finished running node model.jaffle_shop.stg_payments
2021-06-28 13:30:10.721309 (Thread-1): Began running node model.jaffle_shop.stg_customers
2021-06-28 13:30:10.721389 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2021-06-28 13:30:10.721446 (Thread-1): Compiling model.jaffle_shop.stg_customers
2021-06-28 13:30:10.723660 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2021-06-28 13:30:10.741836 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.741975 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.742088 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2021-06-28 13:30:10.742176 (Thread-1): Began running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id
2021-06-28 13:30:10.742259 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_customers_id".
2021-06-28 13:30:10.742318 (Thread-1): Compiling test.jaffle_shop.source_not_null_jaffle_shop_customers_id
2021-06-28 13:30:10.749297 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_customers_id"
2021-06-28 13:30:10.767403 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.767530 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.767637 (Thread-1): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_customers_id
2021-06-28 13:30:10.767725 (Thread-1): Began running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id
2021-06-28 13:30:10.767804 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_not_null_jaffle_shop_orders_id".
2021-06-28 13:30:10.767863 (Thread-1): Compiling test.jaffle_shop.source_not_null_jaffle_shop_orders_id
2021-06-28 13:30:10.770956 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_not_null_jaffle_shop_orders_id"
2021-06-28 13:30:10.789935 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.790082 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.790199 (Thread-1): Finished running node test.jaffle_shop.source_not_null_jaffle_shop_orders_id
2021-06-28 13:30:10.790289 (Thread-1): Began running node test.jaffle_shop.source_unique_jaffle_shop_customers_id
2021-06-28 13:30:10.790373 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_customers_id".
2021-06-28 13:30:10.790433 (Thread-1): Compiling test.jaffle_shop.source_unique_jaffle_shop_customers_id
2021-06-28 13:30:10.797014 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_customers_id"
2021-06-28 13:30:10.813069 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.813265 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.813413 (Thread-1): Finished running node test.jaffle_shop.source_unique_jaffle_shop_customers_id
2021-06-28 13:30:10.813512 (Thread-1): Began running node test.jaffle_shop.source_unique_jaffle_shop_orders_id
2021-06-28 13:30:10.813612 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.source_unique_jaffle_shop_orders_id".
2021-06-28 13:30:10.813691 (Thread-1): Compiling test.jaffle_shop.source_unique_jaffle_shop_orders_id
2021-06-28 13:30:10.817177 (Thread-1): Writing injected SQL for node "test.jaffle_shop.source_unique_jaffle_shop_orders_id"
2021-06-28 13:30:10.835552 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.835696 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.835812 (Thread-1): Finished running node test.jaffle_shop.source_unique_jaffle_shop_orders_id
2021-06-28 13:30:10.835902 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-28 13:30:10.835986 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending".
2021-06-28 13:30:10.836048 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-28 13:30:10.846173 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending"
2021-06-28 13:30:10.865775 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.865916 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.866031 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__returned__completed__shipped__placed__return_pending
2021-06-28 13:30:10.866122 (Thread-1): Began running node model.jaffle_shop.fct_orders
2021-06-28 13:30:10.866207 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.fct_orders".
2021-06-28 13:30:10.866266 (Thread-1): Compiling model.jaffle_shop.fct_orders
2021-06-28 13:30:10.868688 (Thread-1): Writing injected SQL for node "model.jaffle_shop.fct_orders"
2021-06-28 13:30:10.885551 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.885676 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.885786 (Thread-1): Finished running node model.jaffle_shop.fct_orders
2021-06-28 13:30:10.885873 (Thread-1): Began running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-28 13:30:10.885953 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.assert_total_payments_amount_is_positive".
2021-06-28 13:30:10.886011 (Thread-1): Compiling test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-28 13:30:10.895771 (Thread-1): Writing injected SQL for node "test.jaffle_shop.assert_total_payments_amount_is_positive"
2021-06-28 13:30:10.914604 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.914753 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.914876 (Thread-1): Finished running node test.jaffle_shop.assert_total_payments_amount_is_positive
2021-06-28 13:30:10.914964 (Thread-1): Began running node model.jaffle_shop.dim_customers
2021-06-28 13:30:10.915053 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.dim_customers".
2021-06-28 13:30:10.915114 (Thread-1): Compiling model.jaffle_shop.dim_customers
2021-06-28 13:30:10.918677 (Thread-1): Writing injected SQL for node "model.jaffle_shop.dim_customers"
2021-06-28 13:30:10.937419 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.937577 (Thread-1): finished collecting timing info
2021-06-28 13:30:10.937697 (Thread-1): Finished running node model.jaffle_shop.dim_customers
2021-06-28 13:30:10.938703 (MainThread): Connection 'master' was properly closed.
2021-06-28 13:30:10.938796 (MainThread): Connection 'model.jaffle_shop.dim_customers' was properly closed.
2021-06-28 13:30:11.023541 (MainThread): 13:30:11 | Done.
2021-06-28 13:30:11.089752 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-06-28 13:30:11.089884 (MainThread): 13:30:11 | Building catalog
2021-06-28 13:30:11.091072 (MainThread): Opening a new connection, currently in state init
2021-06-28 13:30:11.376364 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "neat-episode-288515.information_schema".
2021-06-28 13:30:11.390248 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-06-28 13:30:11.394607 (ThreadPoolExecutor-1_0): On neat-episode-288515.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `neat-episode-288515`.`dbt_mskonberg`.__TABLES__
        where (upper(dataset_id) = upper('dbt_mskonberg'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `neat-episode-288515`.`dbt_mskonberg`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-28 13:30:11.857805 (Thread-63): handling poll request
2021-06-28 13:30:11.858117 (Thread-63): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e34442b0>]}
2021-06-28 13:30:11.860022 (Thread-63): sending response (<Response 46445 bytes [200 OK]>) to 10.0.20.55
2021-06-28 13:30:13.161040 (Thread-64): handling poll request
2021-06-28 13:30:13.161348 (Thread-64): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e37bb8e0>]}
2021-06-28 13:30:13.161894 (Thread-64): sending response (<Response 295 bytes [200 OK]>) to 10.0.19.174
2021-06-28 13:30:14.252702 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "dbt-tutorial.information_schema".
2021-06-28 13:30:14.254127 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-28 13:30:14.258985 (ThreadPoolExecutor-1_0): On dbt-tutorial.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-tutorial`.`jaffle_shop`.__TABLES__
        where (upper(dataset_id) = upper('jaffle_shop'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-tutorial`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-tutorial`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-28 13:30:14.474113 (Thread-65): handling poll request
2021-06-28 13:30:14.474398 (Thread-65): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3792520>]}
2021-06-28 13:30:14.474989 (Thread-65): sending response (<Response 8195 bytes [200 OK]>) to 10.0.23.185
2021-06-28 13:30:15.865840 (Thread-66): handling poll request
2021-06-28 13:30:15.866120 (Thread-66): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3792610>]}
2021-06-28 13:30:15.866621 (Thread-66): sending response (<Response 295 bytes [200 OK]>) to 10.0.23.185
2021-06-28 13:30:17.147950 (Thread-67): handling poll request
2021-06-28 13:30:17.148236 (Thread-67): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e37927c0>]}
2021-06-28 13:30:17.148786 (Thread-67): sending response (<Response 295 bytes [200 OK]>) to 10.0.45.82
2021-06-28 13:30:17.686895 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "dbt-tutorial.information_schema".
2021-06-28 13:30:17.688341 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-06-28 13:30:17.692746 (ThreadPoolExecutor-1_0): On dbt-tutorial.information_schema: 
    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-tutorial`.`stripe`.__TABLES__
        where (upper(dataset_id) = upper('stripe'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-tutorial`.`stripe`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-tutorial`.`stripe`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-06-28 13:30:18.450257 (Thread-68): handling poll request
2021-06-28 13:30:18.450538 (Thread-68): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3792a90>]}
2021-06-28 13:30:18.451118 (Thread-68): sending response (<Response 8175 bytes [200 OK]>) to 10.0.5.10
2021-06-28 13:30:19.782264 (Thread-69): handling poll request
2021-06-28 13:30:19.782568 (Thread-69): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3792c40>]}
2021-06-28 13:30:19.783109 (Thread-69): sending response (<Response 296 bytes [200 OK]>) to 10.0.3.5
2021-06-28 13:30:20.321441 (MainThread): 13:30:20 | Catalog written to /usr/src/develop/user-26678/environment-32465/repository-26421/target/catalog.json
2021-06-28 13:30:21.108023 (Thread-70): handling poll request
2021-06-28 13:30:21.108341 (Thread-70): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e377ca00>]}
2021-06-28 13:30:21.109266 (Thread-70): sending response (<Response 7937 bytes [200 OK]>) to 10.0.22.247
2021-06-28 13:30:21.646542 (Thread-71): handling status request
2021-06-28 13:30:21.646894 (Thread-71): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e377c3a0>]}
2021-06-28 13:30:21.647562 (Thread-71): sending response (<Response 1757 bytes [200 OK]>) to 10.0.24.245
2021-06-28 13:30:21.677410 (Thread-72): handling status request
2021-06-28 13:30:21.677651 (Thread-72): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e37683a0>]}
2021-06-28 13:30:21.678148 (Thread-72): sending response (<Response 1757 bytes [200 OK]>) to 10.0.22.247
2021-06-28 13:30:21.741552 (Thread-73): handling status request
2021-06-28 13:30:21.742500 (Thread-74): handling status request
2021-06-28 13:30:21.742676 (Thread-73): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3768b50>]}
2021-06-28 13:30:21.742920 (Thread-74): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3756310>]}
2021-06-28 13:30:21.743487 (Thread-73): sending response (<Response 1757 bytes [200 OK]>) to 10.0.47.161
2021-06-28 13:30:21.744001 (Thread-74): sending response (<Response 1757 bytes [200 OK]>) to 10.0.45.82
2021-06-28 13:38:51.687562 (Thread-75): Got an acceptable cached parse result
2021-06-28 13:38:51.724469 (Thread-75): Acquiring new bigquery connection "model.jaffle_shop.stg_payments".
2021-06-28 13:38:52.028051 (Thread-75): [WARNING]: Test 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_customers_' (models/staging/jaffle_shop/stg_jaffle_shop.yml) depends on a node named 'customers' which was not found
2021-06-28 13:38:52.035480 (Thread-75): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging

2021-06-28 13:38:52.036151 (Thread-75): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1c289d0>]}
2021-06-28 13:38:52.208451 (Thread-76): handling status request
2021-06-28 13:38:52.208776 (Thread-76): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e31a41f0>]}
2021-06-28 13:38:52.209365 (Thread-76): sending response (<Response 2057 bytes [200 OK]>) to 10.0.14.70
2021-06-28 13:38:52.284769 (Thread-77): handling status request
2021-06-28 13:38:52.285063 (Thread-77): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3545f10>]}
2021-06-28 13:38:52.285576 (Thread-77): sending response (<Response 2057 bytes [200 OK]>) to 10.0.24.195
2021-06-28 13:38:52.303739 (Thread-78): handling status request
2021-06-28 13:38:52.303971 (Thread-78): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35452e0>]}
2021-06-28 13:38:52.304476 (Thread-78): sending response (<Response 2057 bytes [200 OK]>) to 10.0.24.195
2021-06-28 13:41:08.296880 (Thread-79): handling status request
2021-06-28 13:41:08.298790 (Thread-79): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '812f5e79-8c72-49aa-9b17-d8f0b4c12de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e35278b0>]}
2021-06-28 13:41:08.299314 (Thread-79): sending response (<Response 2057 bytes [200 OK]>) to 10.0.23.185
2021-06-28 13:41:13.944563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f8b29c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1c78fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0f1c78be0>]}
2021-06-28 13:41:13.944963 (MainThread): Flushing usage events
2021-06-28 13:41:13.970511 (MainThread): Connection 'model.jaffle_shop.stg_payments' was properly closed.
2021-06-28 13:41:13.973510 (MainThread): Runtime Error
  Syntax error near line 5
  ------------------------------
  2  | # and underscores. A good package name should reflect your organization's
  3  | # name or the intended use of these models
  4  | <<<<<<< HEAD
  5  | name: 'jaffle_shop'
  6  | version: '1.0.0'
  7  | config-version: 2
  8  | =======
  
  Raw Error:
  ------------------------------
  mapping values are not allowed here
    in "<unicode string>", line 5, column 5:
      name: 'jaffle_shop'
          ^
